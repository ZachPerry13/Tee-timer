"use strict";(self.webpackChunkmaterial=self.webpackChunkmaterial||[]).push([[339],{20339:(Ws,He,g)=>{g.r(He),g.d(He,{MyReservationModule:()=>Xs});var L=g(60509),_=g(65185),d=g(47009),x=(()=>{return(n=x||(x={})).CancelBookingSuccess="[MyReservationApi] CancelBookingSuccess",n.CancelBookingSuccessNavigateUrl="[MyReservationApi] CancelBookingSuccessNavigateUrl",n.CancelBookingFailure="[MyReservationApi] CancelBookingFailure",n.GetUpcomingReservationsSuccess="[MyReservationApi] GetUpcomingReservationsSuccess",n.GetUpcomingReservationsFailure="[MyReservationApi] GetUpcomingReservationsFailure",n.GetPastReservationsSuccess="[MyReservationApi] GetPastReservationsSuccess",n.GetPastReservationsFailure="[MyReservationApi] GetPastReservationsFailure",n.GetAvailablePastReservationYearsSuccess="[MyReservationApi] GetAvailablePastReservationYearsSuccess",n.GetAvailablePastReservationYearsFailure="[MyReservationApi] GetAvailablePastReservationYearsFailure",n.RecalDepositSuccess="[MyReservationApi] RecalDepositSuccess",n.RecalDepositFailure="[MyReservationApi] RecalDepositFailure",n.GetCancelDepositSuccess="[MyReservationApi] GetCancelDepositSuccess",n.GetCancelDepositFailure="[MyReservationApi] GetCancelDepositFailure",n.UnlockTeetimeReservationSuccess="[MyReservationApi] UnlockTeetimeReservationSuccess",n.UnlockTeetimeReservationFailure="[MyReservationApi] UnlockTeetimeReservationFailure",x;var n})();class Et{constructor(s){this.payload=s,this.type=x.CancelBookingSuccess}}class Nt{constructor(s){this.payload=s,this.type=x.CancelBookingSuccessNavigateUrl}}class $t{constructor(s){this.payload=s,this.type=x.CancelBookingFailure}}class St{constructor(s){this.payload=s,this.type=x.GetAvailablePastReservationYearsSuccess}}class Dt{constructor(s){this.payload=s,this.type=x.GetAvailablePastReservationYearsFailure}}class wt{constructor(s){this.payload=s,this.type=x.GetUpcomingReservationsSuccess}}class jt{constructor(s){this.payload=s,this.type=x.GetUpcomingReservationsFailure}}class Gt{constructor(s){this.payload=s,this.type=x.GetPastReservationsSuccess}}class Bt{constructor(s){this.payload=s,this.type=x.GetPastReservationsFailure}}class At{constructor(s){this.payload=s,this.type=x.RecalDepositSuccess}}class Je{constructor(s){this.payload=s,this.type=x.RecalDepositFailure}}class Lt{constructor(s){this.payload=s,this.type=x.GetCancelDepositSuccess}}class Yt{constructor(s){this.payload=s,this.type=x.GetCancelDepositFailure}}class Ut{constructor(s){this.payload=s,this.type=x.UnlockTeetimeReservationSuccess}}class Vt{constructor(s){this.payload=s,this.type=x.UnlockTeetimeReservationFailure}}var Q=(()=>{return(n=Q||(Q={})).ProcessCreditCard="[MyReservation] ProcessCreditCard",n.CancelProcessCreditCard="[MyReservation] CancelProcessCreditCard",n.CancelProcessCreditCardConfirmation="[MyReservation] CancelProcessCreditCardConfirmation",n.CancelProcessCreditCardDismiss="[MyReservation] CancelProcessCreditCardDismiss",n.ProcessCreditCardNavigateUrl="[MyReservation] ProcessCreditCardNavigateUrl",Q;var n})();class Xt{constructor(s){this.payload=s,this.type=Q.CancelProcessCreditCard}}class Ht{constructor(s){this.payload=s,this.type=Q.CancelProcessCreditCardConfirmation}}class Jt{constructor(){this.type=Q.CancelProcessCreditCardDismiss}}class ze{constructor(s){this.payload=s,this.type=Q.ProcessCreditCardNavigateUrl}}var I=g(52870),T=g(95845),ee=g(64431),te=g(83769),Ce=g(62630),ne=g(61360),H=g(83841),We=g(58794),Qe=g(72958),Ie=g(46396),Ke=g(54927),Ze=g(51004),qe=g(27660);let zt=(()=>{class n extends Ze.r{static create(t,i=null){if(i&&!t)return Object.assign({},i);const a=Object.assign(Object.assign({},t),{reservationDetail:t.reservationDetail?t.reservationDetail.map(r=>qe.m.create(r)):[]});return new n(a,null!=i?i:this.defaultValue).value}}return n.defaultValue={reservationTypeId:0,holes:0,numberOfPlayer:0,reservationId:0,terminalId:0,pskUserId:0,reservationConfirmKey:"",teeSheetId:0,courseId:0,courseName:"",crossoverCourseName:"",onlineCourseName:"",startTime:"",startingTee:0,courseGUID:"",ownerFirstName:"",ownerLastName:"",courseNameIncludeCrossOver:"",reservationDetail:[]},n})();var Wt=g(92348),Pe=g(43754),Qt=g(63002),Kt=g(47945);let Zt=(()=>{class n extends Ze.r{static create(t,i=null){if(i&&!t)return Object.assign({},i);const a=Object.assign(Object.assign({},t),{summaryDetail:Kt._.create(null==t?void 0:t.summaryDetail),reservationDetail:(null==t?void 0:t.reservationDetails)?t.reservationDetails.map(r=>qe.m.create(r)):[]});return new n(a,null!=i?i:this.defaultValue).value}}return n.defaultValue={reservationId:0,teeSheetId:0,depositIds:[],oldDeposit:0,currentDeposit:0,newDeposit:0,depositPlayerAmounts:[],summaryDetail:null,errorMessage:"",isForfeitDeposit:!1,reservationDetails:[]},n})();var qt=g(63007),en=g(6475),pe=g(88627),Oe=g(68173);let tn=(()=>{class n{}return n.SessionId="X-SessionId",n})();var e=g(63815),et=g(1048);let nn=(()=>{class n{constructor(t,i,a){this.http=t,this.baseConfigService=i,this.sessionService=a,this.baseUrl=Wt.c.onlineApi,this.baseConfigService.isReady?this.baseUrl=this.baseConfigService.serverSettings.onlineApi:this.baseConfigService.settingsLoaded$.subscribe(()=>this.baseUrl=this.baseConfigService.serverSettings.onlineApi)}getUpcomingReservations(t){let i=new Ie.Nl({encoder:new en.dc});return i=i.append("golferId",t.golferId.toString()),i=i.append("pageSize","14"),i=i.append("currentPage",t.currentPage.toString()),this.http.get(`${this.baseUrl}/UpcomingReservation`,{params:i}).pipe((0,I.T)(a=>{var o;let r=[];return(null===(o=a.items)||void 0===o?void 0:o.length)>0&&(r=a.items.map(c=>{const h=Array.from(new Set(c.reservationDetail.map(C=>C.saleId))),b=1===h.length?h.pop():0;return c.totalCheckInCells=c.reservationDetail.reduce((C,R)=>C+(R.isPaid?1:0),0),Ke.U.create(Object.assign(Object.assign({},c),{saleId:b}))})),Object.assign(Object.assign({},a),{items:r})}))}getAvailablePastReservationYears(t){return this.http.get(`${this.baseUrl}/AvailablePastReservationYears`).pipe(i=>i)}getPastReservations(t){let i=new Ie.Nl;return t.date&&(t.date.setHours(0,0,0,0),i=i.append("date",t.date.toISOString())),t.year&&(i=i.append("year",t.year.toString())),this.http.get(`${this.baseUrl}/PastReservation`,{params:i}).pipe((0,I.T)(a=>a.map(o=>zt.create(o))))}cancelBooking(t){return this.http.post(`${this.baseUrl}/CancelReservation`,t).pipe((0,I.T)(i=>Qt.a.create(i)))}getCancelDeposit(t){let i=new Ie.Nl;return i=i.append("teeSheetId",t.teeSheetId.toString()),i=i.append("reservationId",t.reservationId.toString()),this.http.get(`${this.baseUrl}/CancelDepositReservation`,{params:i,headers:new Ie.Lr({[tn.SessionId]:this.sessionService.getItemValue(Oe.L.SessionId,null)})}).pipe((0,I.T)(a=>qt.j.create(a)))}createWriteInPlayer(t){return this.http.post(`${this.baseUrl}/Register`,t).pipe((0,I.T)(i=>{if(!i.isSuccess)return Object.assign(Object.assign({},i),{content:null});const{content:a}=i,o={acct:a.acct||null,firstName:a.first||null,lastName:a.last||null,classCode:a.classCode||null,golferId:a.golferId||0,playerId:a.playerId||0,dependentId:a.dependentId||0,email:a.email||null,storeId:a.storeId||pe.B.DEFAULT_STORE_ID,fullName:a.fullName||null};return Object.assign(Object.assign({},i),{content:o})}))}updateBooking(t){return this.http.post(`${this.baseUrl}/UpdateReservation`,t).pipe((0,I.T)(i=>Ke.U.create(i)))}recalDeposit(t){return this.http.post(`${this.baseUrl}/RecalDepositReservation`,t).pipe((0,I.T)(i=>Zt.create(i)))}}return n.\u0275fac=function(t){return new(t||n)(e.KVO(Ie.Qq),e.KVO(Pe.t),e.KVO(et.Q))},n.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var p=g(75403);const an={upcomingReservations:[],currentPage:1,totalPages:0,pastReservations:[],availablePastReservationsYears:[],isLoadingUpcomingReservations:!1,isLoadingPastReservations:!1,filter:null,pastReservationsFilter:null,bookingLimitResponseMessages:null,isCheckedBookingLimit:!1},tt={editReservation:[],activeReservationId:0,activeTeeSheetId:0};var le=(()=>{return(n=le||(le={}))[n.None=0]="None",n[n.Edit=1]="Edit",n[n.Cancel=2]="Cancel",le;var n})();const In={reservations:function sn(n=an,s){switch(s.type){case d.QO.GetUpcomingReservations:return Object.assign(Object.assign({},n),{isLoadingUpcomingReservations:!0});case d.QO.ChangeFilter:case d.QO.GetPastReservations:return Object.assign(Object.assign({},n),{isLoadingPastReservations:!0,filter:s.payload.year?s.payload.year.toString():s.payload.date.toISOString(),pastReservationsFilter:Object.assign({},s.payload)});case x.GetUpcomingReservationsSuccess:{const t=1===s.payload.currentPage?[]:[...n.upcomingReservations];return Object.assign(Object.assign({},n),{upcomingReservations:[...t,...s.payload.items],currentPage:s.payload.currentPage,totalPages:s.payload.totalPages,isLoadingUpcomingReservations:!1})}case x.GetPastReservationsSuccess:return Object.assign(Object.assign({},n),{pastReservations:s.payload,isLoadingPastReservations:!1});case x.GetAvailablePastReservationYearsSuccess:return Object.assign(Object.assign({},n),{availablePastReservationsYears:s.payload});case x.GetUpcomingReservationsFailure:return Object.assign(Object.assign({},n),{isLoadingUpcomingReservations:!1});case x.GetPastReservationsFailure:return Object.assign(Object.assign({},n),{isLoadingPastReservations:!1});case x.CancelBookingSuccess:return Object.assign(Object.assign({},n),{upcomingReservations:n.upcomingReservations.filter(t=>t.reservationId!==s.payload.cancelDetail.reservationId)});case d.QO.UpdateBookingSuccess:{let t;return t=s.payload.isRemoveMyself?n.upcomingReservations.filter(i=>i.reservationId!==s.payload.reservationId&&i.teeSheetId!==s.payload.teeSheetId):n.upcomingReservations.map((i,a)=>i.reservationId===s.payload.reservationId&&i.teeSheetId===s.payload.teeSheetId?Object.assign(Object.assign({},i),{numberOfPlayer:s.payload.numberOfPlayer,maxNumberOfPlayer:s.payload.maxNumberOfPlayer,availableParticipantNo:s.payload.availableParticipantNo,reservationDetail:[...s.payload.reservationDetail]}):i),Object.assign(Object.assign({},n),{upcomingReservations:t})}case d.QO.ClearMyReservations:return Object.assign(Object.assign({},n),{upcomingReservations:[],pastReservations:[],isLoadingUpcomingReservations:!1,isLoadingPastReservations:!1});case d.QO.CheckBookingLitmitFailure:case d.QO.CheckBookingLitmitSuccess:return Object.assign(Object.assign({},n),{bookingLimitResponseMessages:s.payload,isCheckedBookingLimit:!0});default:return n}},editReservation:function _n(n=tt,s){switch(s.type){case d.QO.EditReservation:{const t={upcomingReservation:s.payload,activeParticipantNo:0,isGetPlayerDone:!1,isUpdateBookingSuccess:!1,isCancelBookingSuccess:!1,isRecalDepositSuccess:!1,bookingDeposit:null,isGetCancelDepositSuccess:!1,cancelDeposit:null};return Object.assign(Object.assign({},n),{activeReservationId:0,activeTeeSheetId:0,editReservation:[...n.editReservation,t]})}case d.QO.DiscardChangeReservation:return Object.assign(Object.assign({},n),{activeReservationId:0,activeTeeSheetId:0,editReservation:n.editReservation.filter(t=>t.upcomingReservation.reservationId!==s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teesheetId)});case d.QO.CancelBookingDismiss:return Object.assign(Object.assign({},n),{activeReservationId:0,activeTeeSheetId:0,editReservation:n.editReservation.map((t,i)=>t.upcomingReservation.reservationId===n.activeReservationId&&t.upcomingReservation.teeSheetId===n.activeTeeSheetId?Object.assign(Object.assign({},t),{isCancelBookingSuccess:!1}):t)});case d.QO.CancelBookingConfirmation:{const t={upcomingReservation:s.payload,activeParticipantNo:0,isGetPlayerDone:!1,isUpdateBookingSuccess:!1,isCancelBookingSuccess:!1,isRecalDepositSuccess:!1,bookingDeposit:null,isGetCancelDepositSuccess:!1,cancelDeposit:null};return Object.assign(Object.assign({},n),{activeReservationId:s.payload.reservationId,activeTeeSheetId:s.payload.teeSheetId,editReservation:[t]})}case x.CancelBookingSuccess:return Object.assign(Object.assign({},n),{activeReservationId:0,activeTeeSheetId:0,editReservation:n.editReservation.map((t,i)=>t.upcomingReservation.reservationId===s.payload.cancelDetail.reservationId&&t.upcomingReservation.teeSheetId===s.payload.cancelDetail.teeSheetId?Object.assign(Object.assign({},t),{isCancelBookingSuccess:!0,upcomingReservation:Object.assign(Object.assign({},t.upcomingReservation),{onlineFinalizeSaleResult:s.payload.onlineFinalizeSaleResult})}):t)});case d.QO.AddPlayer:{const i=[...n.editReservation].filter(o=>o.upcomingReservation.reservationId===s.payload.reservationId&&o.upcomingReservation.teeSheetId===s.payload.teesheetId)[0],a={bookingId:0,golferId:i.upcomingReservation.reservationDetail[0].golferId,acct:i.upcomingReservation.reservationDetail[0].acct,playerId:i.upcomingReservation.reservationDetail[0].playerId,caddieAmount:i.upcomingReservation.reservationDetail[0].caddieAmount,rentalType:i.upcomingReservation.reservationDetail[0].rentalType,cartType:i.upcomingReservation.reservationDetail[0].cartType,firstName:i.upcomingReservation.reservationDetail[0].firstName,lastName:i.upcomingReservation.reservationDetail[0].lastName,fullName:i.upcomingReservation.reservationDetail[0].fullName,email:i.upcomingReservation.reservationDetail[0].email,memberClassCode:i.upcomingReservation.reservationDetail[0].memberClassCode,teeSheetId:i.upcomingReservation.reservationDetail[0].teeSheetId,startTime:i.upcomingReservation.reservationDetail[0].startTime,isPaid:!1,participantNo:Math.min(...i.upcomingReservation.availableParticipantNo),saleId:0,storeId:i.upcomingReservation.reservationDetail[0].storeId,isNewlyAddedPlayer:!0,isUseCapacityPricing:!1,capacityPricingId:0,advancedBookingFee:null};return Object.assign(Object.assign({},n),{activeReservationId:s.payload.reservationId,activeTeeSheetId:s.payload.teesheetId,editReservation:n.editReservation.map((o,r)=>o.upcomingReservation.reservationId===s.payload.reservationId&&o.upcomingReservation.teeSheetId===s.payload.teesheetId?Object.assign(Object.assign({},o),{upcomingReservation:Object.assign(Object.assign({},o.upcomingReservation),{numberOfPlayer:o.upcomingReservation.numberOfPlayer+1,availableParticipantNo:o.upcomingReservation.availableParticipantNo.filter(c=>c!==Math.min(...o.upcomingReservation.availableParticipantNo))||[],reservationDetail:[...o.upcomingReservation.reservationDetail,a]})}):o)})}case d.QO.RemovePlayer:return Object.assign(Object.assign({},n),{activeReservationId:s.payload.reservationId,activeTeeSheetId:s.payload.teesheetId,editReservation:n.editReservation.map((t,i)=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teesheetId?Object.assign(Object.assign({},t),{upcomingReservation:Object.assign(Object.assign({},t.upcomingReservation),{numberOfPlayer:t.upcomingReservation.numberOfPlayer-1,availableParticipantNo:[...t.upcomingReservation.availableParticipantNo,s.payload.participantNo],reservationDetail:t.upcomingReservation.reservationDetail.filter(a=>a.participantNo!==s.payload.participantNo)})}):t)});case d.QO.AddCartPlayer:return Object.assign(Object.assign({},n),{activeReservationId:s.payload.reservationId,activeTeeSheetId:s.payload.teesheetId,editReservation:n.editReservation.map((t,i)=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teesheetId?Object.assign(Object.assign({},t),{upcomingReservation:Object.assign(Object.assign({},t.upcomingReservation),{reservationDetail:t.upcomingReservation.reservationDetail.map((a,o)=>a.participantNo===s.payload.participantNo?Object.assign(Object.assign({},a),{cartType:s.payload.cartType}):a)})}):t)});case d.QO.AddPlayerEmail:return Object.assign(Object.assign({},n),{activeReservationId:s.payload.reservationId,activeTeeSheetId:s.payload.teesheetId,editReservation:n.editReservation.map((t,i)=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teesheetId?Object.assign(Object.assign({},t),{upcomingReservation:Object.assign(Object.assign({},t.upcomingReservation),{reservationDetail:t.upcomingReservation.reservationDetail.map((a,o)=>a.participantNo===s.payload.participantNo?Object.assign(Object.assign({},a),{email:s.payload.email}):a)})}):t)});case d.QO.AddBuddyPlayer:return Object.assign(Object.assign({},n),{activeReservationId:s.payload.reservationId,activeTeeSheetId:s.payload.teesheetId,editReservation:n.editReservation.map((t,i)=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teesheetId?Object.assign(Object.assign({},t),{upcomingReservation:Object.assign(Object.assign({},t.upcomingReservation),{reservationDetail:t.upcomingReservation.reservationDetail.map((a,o)=>a.participantNo===s.payload.participantNo?Object.assign(Object.assign({},a),{golferId:null==s.payload.buddy.golferId?0:s.payload.buddy.golferId,playerId:null==s.payload.buddy.playerId?0:s.payload.buddy.playerId,acct:null==s.payload.buddy.acct?"":s.payload.buddy.acct,firstName:s.payload.buddy.firstName,lastName:s.payload.buddy.lastName,fullName:`${s.payload.buddy.firstName} ${s.payload.buddy.lastName}`,email:s.payload.buddy.email,memberClassCode:s.payload.buddy.classCode,storeId:1}):a)})}):t)});case d.QO.AddWriteInPlayer:return Object.assign(Object.assign({},n),{activeReservationId:s.payload.reservationId,activeTeeSheetId:s.payload.teesheetId,editReservation:n.editReservation.map((t,i)=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teesheetId?Object.assign(Object.assign({},t),{activeParticipantNo:s.payload.participantNo,isGetPlayerDone:!1}):t)});case d.QO.ResetWriteInPlayer:case d.QO.AddWriteInPlayerSuccess:return Object.assign(Object.assign({},n),{editReservation:n.editReservation.map(t=>t.upcomingReservation.reservationId===n.activeReservationId&&t.upcomingReservation.teeSheetId===n.activeTeeSheetId?Object.assign(Object.assign({},t),{isGetPlayerDone:!0,upcomingReservation:Object.assign(Object.assign({},t.upcomingReservation),{reservationDetail:t.upcomingReservation.reservationDetail.map(i=>i.participantNo===s.payload.participantNo?Object.assign(Object.assign({},i),{golferId:null==s.payload.player.golferId?0:s.payload.player.golferId,playerId:null==s.payload.player.playerId?0:s.payload.player.playerId,acct:null==s.payload.player.acct?"":s.payload.player.acct,firstName:s.payload.player.firstName,lastName:s.payload.player.lastName,fullName:`${s.payload.player.firstName} ${s.payload.player.lastName}`,email:s.payload.player.email,memberClassCode:s.payload.player.classCode,storeId:null==s.payload.player.storeId?0:s.payload.player.storeId}):i)})}):t)});case d.QO.SubmitPlayer:case d.QO.DiscardPlayer:return Object.assign(Object.assign({},n),{editReservation:n.editReservation.map((t,i)=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teesheetId?Object.assign(Object.assign({},t),{activeParticipantNo:0}):t)});case d.QO.UpdateBooking:case d.QO.UpdateBookingFailure:return Object.assign(Object.assign({},n),{activeReservationId:s.payload.reservationId,activeTeeSheetId:s.payload.teesheetId,editReservation:n.editReservation.map((t,i)=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teesheetId?Object.assign(Object.assign({},t),{activeParticipantNo:0}):t)});case d.QO.UpdateBookingSuccess:return Object.assign(Object.assign({},n),{editReservation:n.editReservation.map((t,i)=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teeSheetId?Object.assign(Object.assign({},t),{isUpdateBookingSuccess:!0,upcomingReservation:Object.assign(Object.assign({},t.upcomingReservation),{onlineFinalizeSaleResult:s.payload.onlineFinalizeSaleResult})}):t)});case d.QO.RecalDeposit:return Object.assign(Object.assign({},n),{activeReservationId:s.payload.reservationId,activeTeeSheetId:s.payload.teesheetId,editReservation:n.editReservation.map(t=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teesheetId?Object.assign(Object.assign({},t),{activeParticipantNo:0,bookingDeposit:null,cancelDeposit:null}):t)});case x.RecalDepositSuccess:return Object.assign(Object.assign({},n),{editReservation:n.editReservation.map(t=>{if(t.upcomingReservation.reservationId!==s.payload.reservationId||t.upcomingReservation.teeSheetId!==s.payload.teeSheetId)return t;const a=t.upcomingReservation.reservationDetail.map(o=>{const r=s.payload.reservationDetails.find(c=>c.participantNo===o.participantNo);return r?Object.assign(Object.assign({},o),{advancedBookingFee:r.advancedBookingFee}):o});return Object.assign(Object.assign({},t),{upcomingReservation:Object.assign(Object.assign({},t.upcomingReservation),{reservationDetail:a}),isRecalDepositSuccess:!s.payload.errorMessage,bookingDeposit:s.payload})})});case d.QO.GetCancelDeposit:return Object.assign(Object.assign({},n),{activeReservationId:s.payload.reservationId,activeTeeSheetId:s.payload.teeSheetId,editReservation:n.editReservation.map(t=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teeSheetId?Object.assign(Object.assign({},t),{activeParticipantNo:0,bookingDeposit:null,cancelDeposit:null}):t)});case x.GetCancelDepositSuccess:return Object.assign(Object.assign({},n),{editReservation:n.editReservation.map(t=>t.upcomingReservation.reservationId===s.payload.reservationId&&t.upcomingReservation.teeSheetId===s.payload.teeSheetId?Object.assign(Object.assign({},t),{isGetCancelDepositSuccess:!s.payload.errorMessage,cancelDeposit:s.payload}):t)});case x.GetUpcomingReservationsSuccess:return tt;default:return n}}},nt=(0,p.UX)("myReservation"),ie=(0,p.Mz)(nt,n=>n.reservations),it=(0,p.Mz)(ie,n=>n.upcomingReservations),at=(0,p.Mz)(ie,n=>n.currentPage),st=(0,p.Mz)(ie,n=>n.totalPages),bn=(0,p.Mz)(ie,n=>n.pastReservations),Rn=(0,p.Mz)(ie,n=>n.availablePastReservationsYears),Cn=(0,p.Mz)(ie,n=>n.isLoadingUpcomingReservations),Pn=(0,p.Mz)(ie,n=>n.isLoadingPastReservations),kn=(0,p.Mz)(ie,n=>n.filter),xn=(0,p.Mz)(ie,n=>n.pastReservationsFilter),Ee=(0,p.Mz)(nt,n=>n.editReservation),me=(0,p.Mz)(Ee,n=>n.editReservation),Mn=(0,p.Mz)(it,me,(n,s)=>n.length<=0||s.length<=0?null:n.find(t=>t.reservationId===s[0].upcomingReservation.reservationId)),Fn=(0,p.Mz)(Ee,n=>n.activeReservationId),ot=(0,p.Mz)(Ee,n=>n.activeTeeSheetId),ae=(0,p.Mz)(me,Fn,ot,(n,s,t)=>{if(s>0&&t>0){const i=n.filter(a=>a.upcomingReservation.reservationId===s&&a.upcomingReservation.teeSheetId===t);if(i)return i[0]}return null}),rt=(0,p.Mz)(me,n=>{const s=n.reduce((i,a)=>i.concat(a.upcomingReservation.reservationDetail.map(o=>`${o.acct||""}${o.playerId}${o.golferId}`)),[]),t=new Set(s);return s.length===t.size}),ke=(0,p.Mz)(ae,n=>n?n.upcomingReservation:null),Ne=(0,p.Mz)(ae,n=>null!==n&&n.isGetPlayerDone),$e=(0,p.Mz)(ae,Ne,(n,s)=>{if(null!==n&&s){const t=n.upcomingReservation.reservationDetail.findIndex(i=>i.participantNo===n.activeParticipantNo);if(t>-1){const i=n.upcomingReservation.reservationDetail[t];return{isGetPlayerDone:n.isGetPlayerDone,reservationId:n.upcomingReservation.reservationId,teesheetId:n.upcomingReservation.teeSheetId,participantNo:n.activeParticipantNo,firstName:i.firstName,lastName:i.lastName,email:i.email}}return null}return null}),Se=(0,p.Mz)(Ne,ae,(n,s)=>{if(n&&s&&s.activeParticipantNo>0){const t=s.upcomingReservation.reservationDetail.filter(i=>i.participantNo===s.activeParticipantNo)[0];if(t)return t}return null}),lt={isSuccess:!1,reservationId:0,teesheetId:0},De=(0,p.Mz)(ae,n=>n?{isSuccess:n.isUpdateBookingSuccess,reservationId:n.upcomingReservation.reservationId,teesheetId:n.upcomingReservation.teeSheetId}:lt),we=(0,p.Mz)(ae,n=>n?{isSuccess:n.isCancelBookingSuccess,reservationId:n.upcomingReservation.reservationId,teesheetId:n.upcomingReservation.teeSheetId}:lt),xe=(0,p.Mz)(ae,n=>n?n.bookingDeposit:null),ct=(0,p.Mz)(xe,n=>n?n.newDeposit:0),Tn=(0,p.Mz)(xe,n=>n&&0!==n.currentDeposit?n.newDeposit/n.currentDeposit*100:0),dt=(0,p.Mz)(ae,n=>n?n.cancelDeposit:null),On=(0,p.Mz)(dt,n=>n?n.refundDeposit:0),En=(0,p.Mz)(ae,n=>n&&n.isRecalDepositSuccess?le.Edit:le.Cancel),Nn=(0,p.Mz)(ct,On,(n,s)=>n||s),pt=(0,p.Mz)(ie,n=>n.bookingLimitResponseMessages);var se=g(8634),mt=g(23164),je=g(91348),oe=g(29182),F=g(75137),ue=g(8086),J=g(22850),K=g(87739),$n=g(57527),Sn=g(91263),ut=g(6657),Ge=g(21796),Dn=g(74938),U=g(12896),Be=g(72102),G=g(75764);const wn=[d.QO.CancelBooking,d.QO.AddWriteInPlayer,d.QO.UpdateBooking,d.QO.RecalDeposit,d.QO.CheckBookingLitmit],jn=[x.CancelBookingSuccess,x.CancelBookingSuccessNavigateUrl,x.CancelBookingFailure,d.QO.AddWriteInPlayerSuccess,d.QO.AddWriteInPlayerFailure,d.QO.UpdateBookingSuccess,d.QO.UpdateBookingFailure,x.RecalDepositSuccess,x.RecalDepositFailure,d.QO.CheckBookingLitmitSuccess,d.QO.CheckBookingLitmitFailure];let Gn=(()=>{class n{constructor(t,i,a,o,r,c,h,b,C,R,M){this.actions$=t,this.store$=i,this.storeReservation$=a,this.storeConfiguration=o,this.myReservationService=r,this.dialog=c,this.router=h,this.translate=b,this.teetimeService=C,this.sessionService=R,this.commonService=M,this.showSpinner=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(...wn),(0,I.T)(()=>new mt.f9))),this.hideSpinner=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(...jn),(0,I.T)(()=>new mt.wg))),this.getUpcomingReservations$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.GetUpcomingReservations,d.QO.LoadMoreReservations),(0,T.E)(this.store$.pipe((0,p.Lt)(F.ub))),(0,ee.Z)(([l,u])=>this.myReservationService.getUpcomingReservations({golferId:u,currentPage:l.payload.currentPage}).pipe((0,I.T)(v=>new wt(v)),(0,te.W)(v=>(0,L.of)(new jt(v))))))),this.getPastReservations$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.GetPastReservations,d.QO.ChangeFilter),(0,I.T)(l=>l.payload),(0,T.E)(this.store$.pipe((0,p.Lt)(F.ub))),(0,ee.Z)(([l,u])=>this.myReservationService.getPastReservations({golferId:u,year:l.year,date:l.date}).pipe((0,I.T)(v=>new Gt(v)),(0,te.W)(v=>(0,L.of)(new Bt(v))))))),this.getAvailablePastReservationYears$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.GetAvailablePastReservationYears),(0,T.E)(this.store$.pipe((0,p.Lt)(F.ub))),(0,ee.Z)(([l,u])=>this.myReservationService.getAvailablePastReservationYears(u).pipe((0,I.T)(v=>new St(v)),(0,te.W)(v=>(0,L.of)(new Dt(v))))))),this.cancelCheckoutConfirmation$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.CancelBookingConfirmation),(0,I.T)(l=>l.payload),(0,Ce.p)(l=>{const u=this.translate.instant(l.depositId>0?"reservation.requestForfeitCancelReservation":"reservation.requestCancelReservation");return this.dialog.open(se.B,{data:{header:this.translate.instant("form.confirmation"),body:u,result:l},hasBackdrop:!0}).afterClosed()}),(0,I.T)(l=>l?{teeSheetId:l.teeSheetId,reservationId:l.reservationId,saleId:l.saleId,sessionId:this.sessionService.getItemValue(Oe.L.SessionId,null)}:null),(0,I.T)(l=>l?new d.b$(l):new d.Ie))),this.getCancelDeposit$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.GetCancelDeposit),(0,I.T)(l=>l.payload),(0,ee.Z)(l=>this.myReservationService.getCancelDeposit(l).pipe((0,I.T)(u=>new Lt(u)),(0,te.W)(u=>(0,L.of)(new Yt(u))))))),this.getCancelDepositSuccess$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(x.GetCancelDepositSuccess),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(me)),this.store$.pipe((0,p.Lt)(F.ub))),(0,I.T)(([l,u,v])=>{const f=u.find(k=>k.upcomingReservation.teeSheetId===l.payload.teeSheetId&&k.upcomingReservation.reservationId===l.payload.reservationId),y=f&&f.upcomingReservation,P=y?{bookingIds:y.reservationDetail.map(k=>k.bookingId),courseId:y.courseId,golferId:v,reasonId:0,cancellationIds:[],cancelDetail:{teeTime:y.startTime,holes:y.holes,reservationId:y.reservationId,teeSheetId:y.teeSheetId,saleId:y.saleId,numberOfPlayer:y.numberOfPlayer,playerNameList:y.reservationDetail.map(k=>k.fullName)}}:null;return{depositResult:l.payload,cancelBooking:P}}),(0,T.E)(this.storeConfiguration.pipe((0,p.Lt)(oe.N3))),(0,Ce.p)(([l,u])=>0!==l.depositResult.refundDeposit&&u.allowRefundDepositToCreditCard?(0,L.of)(new ze({navaigateUrl:"my-reservation/process-credit-card"})):l.cancelBooking?(0,L.of)(new d.oW({request:l.cancelBooking,navigateUrl:null})):void 0))),this.getCancelDepositFailure$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(x.GetCancelDepositFailure),(0,I.T)(l=>l.payload),(0,ne.p)(l=>l&&l.message&&l.message.length>0),(0,H.M)(l=>{this.showAttentionDialog(l.message)})),{dispatch:!1}),this.cancelBooking$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.CancelBooking),(0,I.T)(l=>l.payload),(0,ee.Z)(l=>this.myReservationService.cancelBooking(l.request).pipe((0,I.T)(u=>l.navigateUrl&&l.navigateUrl.length>0?new Nt({result:u,navigateUrl:"my-reservation"}):new Et(u)),(0,te.W)(u=>(0,L.of)(new $t(u))))))),this.cancelBookingFailure$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(x.CancelBookingFailure),(0,I.T)(l=>l.payload),(0,I.T)(l=>(l&&l.messages&&l.messages.length>0?l.messages[0]:null)||Ge.I.getValidationErrorMessage(l).join(", ")),(0,H.M)(l=>{this.showAttentionDialog(l)})),{dispatch:!1}),this.addCartPlayer$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.AddCardPlayer),(0,T.E)(this.storeConfiguration.pipe((0,p.Lt)(oe.ei))),(0,I.T)(([l,u])=>{const v=u.find(y=>y.courseId===l.payload.courseId);let f=K.T.FullCart;return l.payload.isAddCart?null==v?f=K.T.FullCart:v.fullCartSelectionType===J.M.DoNotOfferCarts?f=K.T.None:(v.fullCartSelectionType===J.M.AllowCartSelection||v.fullCartSelectionType===J.M.ForceCartSelection||v.fullCartSelectionType===J.M.SelectByDefault)&&(f=1===v.cartTypeOffered?K.T.HalfCart:K.T.FullCart):f=K.T.None,new d.z(Object.assign(Object.assign({},l.payload),{cartType:f}))}))),this.addWriteInPlayer$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.AddWriteInPlayer),(0,T.E)(this.storeConfiguration.pipe((0,p.Lt)(oe.N3))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(ke))),(0,I.T)(([[l,u],v])=>{const f=Object.assign({},l.payload.player);return f&&(f.pullExisting=!!f.email,f.isWriteIn=!0,f.courseId=v&&v.courseId||null,f.storeId=u.enableAssignNewAccountToStore?u.assignNewAccountToStore:pe.B.DEFAULT_STORE_ID),{tempPlayer:l.payload.tempPlayer,player:f,participantNo:l.payload.participantNo}}),(0,We.n)(l=>this.myReservationService.createWriteInPlayer(l.player).pipe((0,Qe.H)(u=>(null==u?void 0:u.content)&&(null==u?void 0:u.isSuccess)?[new d.oB({player:u.content,participantNo:l.participantNo})]:[]),(0,te.W)(u=>l.tempPlayer?(0,L.of)(new d.Be({error:u}),new d.nf({player:l.tempPlayer,participantNo:l.participantNo})):(0,L.of)(new d.Be({error:u}))))))),this.addWriteInPlayerFailure$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.AddWriteInPlayerFailure),(0,I.T)(l=>l.payload),(0,H.M)(l=>{const u=Ge.I.getErrorMessage((null==l?void 0:l.error)||"An unexpected error occurred.");this.showInformationDialog(u)})),{dispatch:!1}),this.updateBooking$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.UpdateBooking),(0,I.T)(l=>l.payload),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(me))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(xe))),(0,T.E)(this.store$.pipe((0,p.Lt)(F.wz))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(F.GJ))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(F.Mj)),this.storeReservation$.pipe((0,p.Lt)(F.VM)),this.storeReservation$.pipe((0,p.Lt)(F.vc)),this.storeConfiguration.pipe((0,p.Lt)(oe.N3)),this.storeReservation$.pipe((0,p.Lt)(Mn))),(0,ee.Z)(([[[[[l,u],v],f],y],P,k,O,S,N])=>{var W,$;const q=u.filter(j=>j.upcomingReservation.reservationId===l.reservationId&&j.upcomingReservation.teeSheetId===l.teesheetId);if(q&&q.length>0){const j=q[0].upcomingReservation;let Tt,B=0,Fe=0,Re=[];v&&(B=v.newDeposit,Fe=0!==v.currentDeposit?v.newDeposit/v.currentDeposit*100:0,Re=v.depositIds,Tt=Re&&Re.length>0?Re[0]:null);const Hs=Math.max(...j.reservationDetail.map(Y=>Y.participantNo),0),Te=j.reservationDetail.map(v&&v.depositPlayerAmounts&&v.depositPlayerAmounts.length>Hs?Y=>Object.assign(Object.assign({},Y),{depositPlayerAmount:v.depositPlayerAmounts[Y.participantNo]}):Y=>Object.assign({},Y)),Js=Array.from({length:j.maxNumberOfPlayer},(Y,de)=>de+1).filter(Y=>Te.every(de=>de.participantNo!==Y||!de.bookingId));let Ve=null;S.isUseHostedTokenizationPermanent&&(Ve={amount:B,acct:f.player_id>0?String(f.player_id):f.sub,token:y||(O?O.ccToken:null)}),S.isUseHostedVault&&(Ve={amount:B,acct:f.player_id>0?String(f.player_id):f.sub,storeCardKey:O?O.ccToken:null,storeCardNum:O?O.ccMaskedNumber:null,cardExpire:O?O.cardExpire:null});const Ot=0!==B,Xe={holes:j.holes,numberOfPlayer:j.numberOfPlayer,reservationId:j.reservationId,terminalId:j.terminalId,pskUserId:j.pskUserId,teeSheetId:j.teeSheetId,courseId:j.courseId,courseGUID:j.courseGUID,startTime:j.startTime,siteId:j.siteId,reservationDetail:[...Te],isDeposit:Ot,cancelReservationLink:$n.A.getBaseUri()+"auth/verify-email?returnUrl=cancel-booking",summaryDetail:v?v.summaryDetail:null,participants:Js,finalizeSaleModel:{advancedBookingFees:[],acct:f.player_id>0?String(f.player_id):f.sub,playerId:f.player_id>0?f.player_id:0,isGuest:!1,total:B,totalAdvancedBookingFee:null!==($=null===(W=null==v?void 0:v.summaryDetail)||void 0===W?void 0:W.totalAdvancedBookingFee)&&void 0!==$?$:0,totalSurcharge:0,surchargePercent:S.ibxRewardPaySurchargePercent,qty:Ot?Math.abs(N.numberOfPlayer-Te.length):Te.length,depositPercent:Fe,depositIds:Re,parentDepositId:Tt,creditCardInfo:{cardNumber:P?P.cardNumber:null,cardHolder:P?P.cardHolder:null,expireMM:P?P.expireMM:null,expireYY:P?P.expireYY:null,cvv:P?P.cvv:null,email:f.email,cardToken:y},monerisCC:Ve,ibxCC:S.isUseIBXTokenization?{acct:f.player_id>0?String(f.player_id):f.sub,ccToken:k||y,total:B,cardType:P?P.cardType:O?O.cardType:null,ccMaskedNumber:P?P.cardMasked:null,refNo:""}:null},isForfeitDeposit:l.isForfeitDeposit};return this.myReservationService.updateBooking(Xe).pipe((0,I.T)(Y=>{const de=!Xe.reservationDetail.map(zs=>zs.acct).includes(Xe.finalizeSaleModel.acct);return new d.aT(Object.assign(Object.assign({},Y),{reservationId:de?l.reservationId:Y.reservationId,teeSheetId:de?l.teesheetId:Y.teeSheetId,isRemoveMyself:de}))}),(0,te.W)(Y=>(0,L.of)(new d.PU({reservationId:l.reservationId,teesheetId:l.teesheetId,error:Y}))))}}))),this.recalDeposit$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.RecalDeposit),(0,I.T)(l=>l.payload),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(me))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(ct))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(Tn))),(0,T.E)(this.store$.pipe((0,p.Lt)(F.wz))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(F.GJ))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(F.Mj)),this.storeReservation$.pipe((0,p.Lt)(F.VM)),this.storeReservation$.pipe((0,p.Lt)(F.vc)),this.storeConfiguration.pipe((0,p.Lt)(oe.N3))),(0,ee.Z)(([[[[[[l,u],v],f],y],P],k,O,S,N])=>{const W=u.filter($=>$.upcomingReservation.reservationId===l.reservationId&&$.upcomingReservation.teeSheetId===l.teesheetId);if(W&&W.length>0){const $=W[0].upcomingReservation;let q=null;N.isUseHostedTokenizationPermanent&&(q={amount:v,acct:y.player_id>0?String(y.player_id):y.sub,token:S?S.ccToken:P}),N.isUseHostedVault&&(q={amount:v,acct:y.player_id>0?String(y.player_id):y.sub,storeCardKey:S?S.ccToken:null,storeCardNum:S?S.ccMaskedNumber:null,cardExpire:S?S.cardExpire:null});const j={holes:$.holes,numberOfPlayer:$.numberOfPlayer,reservationId:$.reservationId,terminalId:$.terminalId,pskUserId:$.pskUserId,teeSheetId:$.teeSheetId,courseId:$.courseId,courseGUID:$.courseGUID,startTime:$.startTime,siteId:$.siteId,reservationDetail:[...$.reservationDetail],isDeposit:0!==v,finalizeSaleModel:{advancedBookingFees:[],acct:y.player_id>0?String(y.player_id):y.sub,playerId:y.player_id>0?y.player_id:0,isGuest:!1,total:v,totalSurcharge:0,surchargePercent:N.ibxRewardPaySurchargePercent,qty:$.reservationDetail.length,depositPercent:f,creditCardInfo:{cardNumber:k?k.cardNumber:null,cardHolder:k?k.cardHolder:null,expireMM:k?k.expireMM:null,expireYY:k?k.expireYY:null,cvv:k?k.cvv:null,email:y.email,cardToken:P},monerisCC:q,ibxCC:N.isUseIBXTokenization?{acct:y.player_id>0?String(y.player_id):y.sub,ccToken:O||P,total:v,cardType:k?k.cardType:S?S.cardType:null,ccMaskedNumber:k?k.cardMasked:null,refNo:""}:null},isForfeitDeposit:!1};return this.myReservationService.recalDeposit(j).pipe((0,I.T)(B=>B.errorMessage?new Je({messages:[B.errorMessage]}):new At(B)),(0,te.W)(B=>(0,L.of)(new Je(B))))}}))),this.recalDepositSuccess$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(x.RecalDepositSuccess),(0,I.T)(l=>0===l.payload.newDeposit||l.payload.isForfeitDeposit?new d.Rp({reservationId:l.payload.reservationId,teesheetId:l.payload.teeSheetId,isForfeitDeposit:l.payload.isForfeitDeposit}):new ze({navaigateUrl:"my-reservation/process-credit-card"})))),this.recalDepositFailure$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(x.RecalDepositFailure),(0,I.T)(l=>l.payload),(0,ne.p)(l=>l&&l.messages&&l.messages.length>0),(0,H.M)(l=>{this.showAttentionDialog(l.messages[0])})),{dispatch:!1}),this.cancelProcessCreditCard$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(Q.CancelProcessCreditCard),(0,I.T)(l=>l.payload.navaigateUrl),(0,Ce.p)(l=>this.dialog.open(se.B,{data:{header:this.translate.instant("form.confirmation"),body:this.translate.instant("form.confirmCancellation"),result:l}}).afterClosed()),(0,I.T)(l=>l?new Ht({navaigateUrl:l}):new Jt))),this.cancelProcessCreditCardConfirmation$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(Q.CancelProcessCreditCardConfirmation),(0,T.E)(this.store$.pipe((0,p.Lt)(ot))),(0,I.T)(([l,u])=>new d.IU({teeSheetIds:[u],sessionId:this.sessionService.getItemValue(Oe.L.SessionId,null),email:"",golferId:0,redirectUrl:l.payload.navaigateUrl})))),this.unlockTeetimeReservation$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.UnlockTeetimeReservation),(0,We.n)(l=>this.commonService.unLockTeetime(l.payload).pipe((0,ee.Z)(u=>[new Ut(u),new je.C5(l.payload.redirectUrl)]),(0,te.W)(u=>(0,L.of)(new Vt(u))))))),this.processCreditCardNavigateUrl$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(Q.ProcessCreditCardNavigateUrl),(0,I.T)(l=>l.payload.navaigateUrl),(0,H.M)(l=>this.router.navigate([l]))),{dispatch:!1}),this.updateBookingWithCreditCard$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.UpdateBookingWithCreditCard),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(xe)),this.store$.pipe((0,p.Lt)(F.vc))),(0,I.T)(([l,u,v])=>v&&v.isExpired?new d.PU({reservationId:u.reservationId,teesheetId:u.teeSheetId,error:{messages:[`${this.translate.instant("payment.cardSelectedExpired")}. ${this.translate.instant("payment.selectValidPaymentMethod")}.`]}}):u?new d.Rp({reservationId:u.reservationId,teesheetId:u.teeSheetId,isForfeitDeposit:!1}):void 0))),this.cancelBookingWithCreditCard$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.CancelBookingWithCreditCard),(0,I.T)(l=>l.payload),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(dt))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(me))),(0,T.E)(this.store$.pipe((0,p.Lt)(F.wz))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(F.GJ))),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(F.Mj)),this.storeReservation$.pipe((0,p.Lt)(F.vc)),this.storeConfiguration.pipe((0,p.Lt)(oe.N3))),(0,I.T)(([[[[[l,u],v],f],y],P,k,O])=>{const S=v.find(B=>B.upcomingReservation.teeSheetId===u.teeSheetId&&B.upcomingReservation.reservationId===u.reservationId),N=S&&S.upcomingReservation;let $,W=[];u&&(W=u.depositIds,$=u.depositIds&&u.depositIds.length>0&&u.depositIds[0]);let q=null;return O.isUseHostedTokenizationPermanent&&(q={amount:l,acct:f.player_id>0?String(f.player_id):f.sub,token:y||k.ccToken}),O.isUseHostedVault&&(q={amount:l,acct:f.player_id>0?String(f.player_id):f.sub,storeCardKey:k?k.ccToken:null,storeCardNum:k?k.ccMaskedNumber:null,cardExpire:k?k.cardExpire:null}),{cancelBooking:N?{bookingIds:[],courseId:N.courseId,golferId:f.golferId,reasonId:0,cancellationIds:[],cancelDetail:{teeTime:N.startTime,holes:N.holes,reservationId:N.reservationId,teeSheetId:N.teeSheetId,saleId:N.saleId,numberOfPlayer:N.numberOfPlayer,playerNameList:N.reservationDetail.map(B=>B.fullName)},isDeposit:0!==l,finalizeSaleModel:{acct:f.player_id>0?String(f.player_id):f.sub,playerId:f.player_id>0?f.player_id:0,isGuest:!1,total:l,totalSurcharge:0,surchargePercent:O.ibxRewardPaySurchargePercent,qty:N&&N.reservationDetail.length||0,depositPercent:u.depositPercent,depositIds:W,parentDepositId:$,creditCardInfo:{cardNumber:P?P.cardNumber:null,cardHolder:P?P.cardHolder:null,expireMM:P?P.expireMM:null,expireYY:P?P.expireYY:null,cvv:P?P.cvv:null,email:f.email,cardToken:y},advancedBookingFees:[],monerisCC:q,ibxCC:O.isUseIBXTokenization?{acct:f.player_id>0?String(f.player_id):f.sub,ccToken:P?P.token:y,total:l,cardType:P?P.cardType:k?k.cardType:null,ccMaskedNumber:P.cardMasked,refNo:""}:null}}:null,isCOFExpired:!!k&&k.isExpired}}),(0,Ce.p)(({cancelBooking:l,isCOFExpired:u})=>(0,L.of)(u?new d.o$({error:{messages:[`${this.translate.instant("payment.cardSelectedExpired")}. ${this.translate.instant("payment.selectValidPaymentMethod")}.`]}}):new d.oW({request:l,navigateUrl:"my-reservation"}))))),this.cancelBookingWithCreditCardFailure$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.CancelBookingFailure),(0,I.T)(l=>l.payload.error),(0,ne.p)(l=>l&&l.messages&&l.messages.length>0),(0,H.M)(l=>{this.showAttentionDialog(l.messages[0])})),{dispatch:!1}),this.updateBookingSuccess$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.UpdateBookingSuccess),(0,I.T)(l=>{if(!(l.payload&&l.payload.onlineFinalizeSaleResult&&l.payload.onlineFinalizeSaleResult.saleId>0))return new d.E2({currentPage:1});this.router.navigate(["my-reservation"])}))),this.updateBookingFailure$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.UpdateBookingFailure),(0,I.T)(l=>l.payload.error),(0,I.T)(l=>(l&&l.messages&&l.messages.length>0?l.messages[0]:null)||Ge.I.getValidationErrorMessage(l).join(", ")),(0,H.M)(l=>{this.showAttentionDialog(l)})),{dispatch:!1}),this.cancelBookingSuccess$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(x.CancelBookingSuccess),(0,T.E)(this.storeReservation$.pipe((0,p.Lt)(xn))),(0,Qe.H)(([l,u])=>[new d.xh,new d.MB(u),new d.E2({currentPage:1})]))),this.cancelBookingSuccessNavigateUrl$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(x.CancelBookingSuccessNavigateUrl),(0,I.T)(l=>l.payload.navigateUrl),(0,H.M)(l=>this.router.navigate([l]))),{dispatch:!1}),this.checkBookingLitmitFailure$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.CheckBookingLitmitFailure),(0,I.T)(l=>l),(0,ne.p)(l=>l&&l.payload&&""!=l.payload.error),(0,H.M)(l=>{this.showAttentionDialog(l.payload.error)})),{dispatch:!1}),this.checkBookingLitmit$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.CheckBookingLitmit),(0,I.T)(l=>l.payload),(0,ee.Z)(l=>this.teetimeService.checkBookingLimit(l.acct,l.golferId,l.teesheetId,l.classCode,l.isBuddy).pipe((0,I.T)(u=>u&&u.error&&""!=u.error?new d.PA(u):new d.c2(u)))))),this.getPlayingPartner$=(0,_.EH)(()=>this.actions$.pipe((0,_.gp)(d.QO.FetchPartnerPlayers),(0,I.T)(l=>l.payload),(0,ee.Z)(l=>this.teetimeService.getLastPlayingPartners(l,12,1).pipe((0,I.T)(u=>new ut.w(u)),(0,te.W)(u=>(0,L.of)(new ut.FH(u)))))))}showInformationDialog(t){this.dialog.open(ue.z,{data:{header:this.translate.instant("dialog.information"),details:t}})}showAttentionDialog(t){this.dialog.open(ue.z,{data:{header:this.translate.instant("dialog.attention"),details:t}})}}return n.\u0275fac=function(t){return new(t||n)(e.KVO(_.En),e.KVO(p.il),e.KVO(p.il),e.KVO(p.il),e.KVO(nn),e.KVO(U.bZ),e.KVO(Be.Ix),e.KVO(G.c$),e.KVO(Sn.H),e.KVO(et.Q),e.KVO(Dn.h))},n.\u0275prov=e.jDH({token:n,factory:n.\u0275fac}),n})();var E=g(20811),ve=g(62444),Bn=g(18583),re=g(84573),m=g(30519),V=g(59981),ge=g(43964),fe=g(11389),he=g(86369),Ae=g(30372),An=g(86537),gt=g(12874),Ln=g(79251),ht=g(28865),z=g(50513),be=g(5696),_t=g(37419),vt=g(79699),A=g(17391),D=g(3126),ce=g(29608),w=g(1148),_e=g(93723);function Yn(n,s){if(1&n&&(e.j41(0,"div")(1,"small"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(2),e.Lme("",e.bMT(3,2,"buddy.store"),": ",t.storeName,"")}}function Un(n,s){1&n&&(e.j41(0,"mat-icon",9),e.EFF(1," add "),e.k0s())}function Vn(n,s){if(1&n){const t=e.RV6();e.qex(0,4),e.j41(1,"button",5),e.bIt("click",function(){const o=e.eBV(t).$implicit;return e.XpG().addPartnerPlayer.emit(o)}),e.j41(2,"div",6)(3,"div")(4,"b"),e.EFF(5),e.k0s()(),e.DNE(6,Yn,4,4,"div",7),e.k0s(),e.DNE(7,Un,2,0,"mat-icon",8),e.k0s(),e.bVm()}if(2&n){const t=s.$implicit,i=e.XpG();e.R7$(1),e.Y8G("disabled",i.isDisable),e.R7$(4),e.Lme("",t.firstName," ",t.lastName,""),e.R7$(1),e.Y8G("ngIf",i.isDisplayStore),e.R7$(1),e.Y8G("ngIf",!i.isDisable)}}function Xn(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",10),e.bIt("click",function(){return e.eBV(t),e.XpG().loadMorePartners.emit()}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"form.loadMore")," "))}let Hn=(()=>{class n{constructor(){this.loadMorePartners=new e.bkB,this.addPartnerPlayer=new e.bkB}trackByFn(t,i){return i.golferId}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.VBU({type:n,selectors:[["app-card-partner-reservation"]],inputs:{partnerPage:"partnerPage",isDisplayStore:"isDisplayStore",isDisable:"isDisable"},outputs:{loadMorePartners:"loadMorePartners",addPartnerPlayer:"addPartnerPlayer"},decls:5,vars:3,consts:[[1,"card-partner"],[1,"partner-list-display"],["style","align-items: center;",4,"ngFor","ngForOf","ngForTrackBy"],["mat-stroked-button","","class","button-partner",3,"click",4,"ngIf"],[2,"align-items","center"],["mat-stroked-button","",1,"add-partner-button",3,"disabled","click"],["fxFlex","auto"],[4,"ngIf"],["fxFlex","10","matSuffix","","inline","true","class","add-partner-icon",4,"ngIf"],["fxFlex","10","matSuffix","","inline","true",1,"add-partner-icon"],["mat-stroked-button","",1,"button-partner",3,"click"]],template:function(t,i){1&t&&(e.j41(0,"mat-card",0)(1,"mat-card-content")(2,"div",1),e.DNE(3,Vn,8,5,"ng-container",2),e.DNE(4,Xn,3,3,"button",3),e.k0s()()()),2&t&&(e.R7$(3),e.Y8G("ngForOf",null==i.partnerPage?null:i.partnerPage.items)("ngForTrackBy",i.trackByFn),e.R7$(1),e.Y8G("ngIf",(null==i.partnerPage?null:i.partnerPage.currentPage)<i.partnerPage.totalPages))},directives:[D.RN,D.m2,E.Sq,ce.$z,w.UI,E.bT,_e.An,z.yw],pipes:[G.D9],styles:[".partner-list-display[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px}  .add-partner-button{width:100%!important;border:1px solid #7a9de3;border-radius:20px!important;font-weight:500;text-align:left}  .add-partner-button span.mat-button-wrapper{display:flex;white-space:normal;justify-content:space-between;padding:7px}.add-partner-icon[_ngcontent-%COMP%]{display:flex;align-items:center;transform:scale(1.2);color:#000;float:right;margin-right:10px;font-weight:700;flex:none!important}.button-partner[_ngcontent-%COMP%]{width:100%;border-color:var(--border-color);border-radius:var(--border-radius)}  .mat-card.card-partner{box-shadow:none!important}[_nghost-%COMP%]     .mat-card .mat-card-content{padding:0!important}"]}),n})();var ft=g(4472),ye=g(88481);const Jn=["filter"];function zn(n,s){if(1&n&&(e.j41(0,"div",12),e.EFF(1," | "),e.j41(2,"small"),e.EFF(3),e.nI1(4,"translate"),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(3),e.Lme("",e.bMT(4,2,"buddy.store"),": ",t.storeName,"")}}function Wn(n,s){if(1&n&&(e.j41(0,"mat-option",11)(1,"div",12),e.EFF(2),e.k0s(),e.DNE(3,zn,5,4,"div",13),e.k0s()),2&n){const t=s.$implicit,i=e.XpG();e.Y8G("value",t),e.R7$(2),e.Lme("",t.firstName," ",t.lastName,""),e.R7$(1),e.Y8G("ngIf",i.isDisplayStore)}}function Qn(n,s){if(1&n&&(e.j41(0,"div")(1,"small"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(2),e.Lme("",e.bMT(3,2,"buddy.store"),": ",t.storeName,"")}}function Kn(n,s){1&n&&(e.j41(0,"mat-icon",20),e.EFF(1," add "),e.k0s())}function Zn(n,s){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",14)(2,"button",15),e.bIt("click",function(){const o=e.eBV(t).$implicit;return e.XpG().onClickAddBuddy(o)}),e.j41(3,"div",16)(4,"div")(5,"b"),e.EFF(6),e.k0s()(),e.DNE(7,Qn,4,4,"div",17),e.k0s(),e.DNE(8,Kn,2,0,"mat-icon",18),e.k0s(),e.j41(9,"button",19),e.bIt("click",function(){const o=e.eBV(t).$implicit;return e.XpG().onClickRemoveBuddy(o)}),e.EFF(10," X "),e.k0s()(),e.bVm()}if(2&n){const t=s.$implicit,i=e.XpG();e.R7$(2),e.Y8G("disabled",i.isDisable),e.R7$(4),e.Lme("",t.firstName," ",t.lastName,""),e.R7$(1),e.Y8G("ngIf",i.isDisplayStore),e.R7$(1),e.Y8G("ngIf",!i.isDisable)}}function qn(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",21),e.bIt("click",function(){return e.eBV(t),e.XpG().loadMoreBuddies.emit()}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"form.loadMore")," "))}let ei=(()=>{class n{constructor(){this.buddyListAddOrRemove=[],this.searchBuddies=new e.bkB,this.selectBuddy=new e.bkB,this.addBuddy=new e.bkB,this.removeBuddy=new e.bkB,this.addPlayer=new e.bkB,this.loadMoreBuddies=new e.bkB}ngOnInit(){for(let t=0;t<this.buddiesPage.length;t++)this.buddyStatus={buddyId:this.buddiesPage[t].buddyId,acct:this.buddiesPage[t].acct,golferId:this.buddiesPage[t].golferId,isAdd:!1},this.buddyListAddOrRemove.push(this.buddyStatus)}onSelectSearchBuddy(t){this.selectBuddy.emit(t.option.value),this.filter.nativeElement.value=null}displayFn(t){return t?t.firstName+" "+t.lastName:void 0}trackByFn(t,i){return i.buddyId}updateBuddyStatus(t){if(this.buddyListAddOrRemove.length>0)if(this.buddyListAddOrRemove.find(i=>i.buddyId===t.buddyId&&i.isAdd)){const i=this.buddyListAddOrRemove.findIndex(a=>a.buddyId===t.buddyId);this.buddyListAddOrRemove[i].isAdd=!1}else if(this.buddyListAddOrRemove.find(i=>i.buddyId===t.buddyId&&!i.isAdd)){const i=this.buddyListAddOrRemove.findIndex(a=>a.buddyId===t.buddyId);this.buddyListAddOrRemove[i].isAdd=!0}else this.buddyStatus={buddyId:t.buddyId,acct:t.acct,golferId:t.golferId,isAdd:!0},this.buddyListAddOrRemove.push(this.buddyStatus);else this.buddyStatus={buddyId:t.buddyId,acct:t.acct,golferId:t.golferId,isAdd:!0},this.buddyListAddOrRemove.push(this.buddyStatus)}onClickAddBuddy(t){this.updateBuddyStatus(t),this.addBuddy.emit(t),this.addPlayer.emit(t)}onClickRemoveBuddy(t){this.updateBuddyStatus(t),this.removeBuddy.emit(t),this.addPlayer.emit(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.VBU({type:n,selectors:[["app-card-buddy-reservation"]],viewQuery:function(t,i){if(1&t&&e.GBs(Jn,5),2&t){let a;e.mGM(a=e.lsd())&&(i.filter=a.first)}},inputs:{isDisplayStore:"isDisplayStore",isDisable:"isDisable",isShowBuddiesLoadMore:"isShowBuddiesLoadMore",buddiesPage:"buddiesPage",filteredBuddies:"filteredBuddies"},outputs:{searchBuddies:"searchBuddies",selectBuddy:"selectBuddy",addBuddy:"addBuddy",removeBuddy:"removeBuddy",addPlayer:"addPlayer",loadMoreBuddies:"loadMoreBuddies"},decls:14,vars:11,consts:[[1,"card-buddy"],["appearance","fill"],["inline","true","matPrefix","",1,"icon-display"],["type","text","matInput","",3,"placeholder","matAutocomplete","disabled","keyup"],["filter",""],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[1,"buddy-list-display"],[4,"ngFor","ngForOf","ngForTrackBy"],["mat-stroked-button","","class","button-buddies",3,"click",4,"ngIf"],[3,"value"],["mat-line",""],["mat-line","",4,"ngIf"],["fxFlex","auto",2,"display","flex","align-items","center","width","100%"],["mat-stroked-button","",1,"add-buddy-button",3,"disabled","click"],["fxFlex","auto"],[4,"ngIf"],["fxFlex","10","matSuffix","","inline","true","class","add-buddy-icon",4,"ngIf"],["color","warn",1,"s-btn","removebtn",3,"click"],["fxFlex","10","matSuffix","","inline","true",1,"add-buddy-icon"],["mat-stroked-button","",1,"button-buddies",3,"click"]],template:function(t,i){if(1&t){const a=e.RV6();e.j41(0,"mat-card",0)(1,"mat-card-content")(2,"mat-form-field",1)(3,"mat-icon",2),e.EFF(4,"search"),e.k0s(),e.j41(5,"input",3,4),e.bIt("keyup",function(){e.eBV(a);const r=e.sdS(6);return i.searchBuddies.emit(r.value)}),e.nI1(7,"translate"),e.k0s(),e.j41(8,"mat-autocomplete",5,6),e.bIt("optionSelected",function(r){return i.onSelectSearchBuddy(r)}),e.DNE(10,Wn,4,4,"mat-option",7),e.k0s()(),e.j41(11,"div",8),e.DNE(12,Zn,11,5,"ng-container",9),e.DNE(13,qn,3,3,"button",10),e.k0s()()()}if(2&t){const a=e.sdS(9);e.R7$(5),e.Mz_("placeholder","",e.bMT(7,9,"buddy.searchBuddyNames"),"..."),e.Y8G("matAutocomplete",a)("disabled",i.isDisable),e.R7$(3),e.Y8G("displayWith",i.displayFn),e.R7$(2),e.Y8G("ngForOf",i.filteredBuddies)("ngForTrackBy",i.trackByFn),e.R7$(2),e.Y8G("ngForOf",i.buddiesPage)("ngForTrackBy",i.trackByFn),e.R7$(1),e.Y8G("ngIf",i.isShowBuddiesLoadMore)}},directives:[D.RN,D.m2,z.rl,_e.An,z.JW,be.fg,ft.pN,ft.$3,E.Sq,ye.wT,ye.vu,E.bT,w.UI,ce.$z,z.yw],pipes:[G.D9],styles:[".buddy-list-display[_ngcontent-%COMP%]{margin-top:15px;flex-direction:column;align-items:center;gap:10px}  .add-buddy-button{width:100%!important;border:1px solid #7a9de3;border-radius:20px!important;font-weight:500;text-align:left;background-color:#fff}  .add-buddy-button span.mat-button-wrapper{display:flex;justify-content:space-between;padding:7px;white-space:normal}.add-buddy-icon[_ngcontent-%COMP%]{display:flex;align-items:center;transform:scale(1.2);color:#000;float:right;margin-right:10px;font-weight:700;flex:none!important}[_nghost-%COMP%]     .mat-form-field-flex{padding-left:10px;align-items:center!important;background-color:#fff;border-radius:10px}.search-buddy[_ngcontent-%COMP%]{border-radius:10px}.icon-display[_ngcontent-%COMP%]{padding-right:5px;transform:scale(1.5);color:#000;font-weight:700}  .mat-option{line-height:1rem!important}  .mat-card.card-buddy{box-shadow:none!important}[_nghost-%COMP%]     .mat-card .mat-card-content{padding:0!important}.button-buddies[_ngcontent-%COMP%]{width:100%;border-color:var(--border-color);border-radius:var(--border-radius)}.s-btn[_ngcontent-%COMP%]{line-height:25px}.removebtn[_ngcontent-%COMP%]{margin-left:5px;height:35px;width:35px;background-color:#fff;color:red;border:1px solid currentColor;border-radius:2px;cursor:pointer}"]}),n})();var yt=g(95216);function ti(n,s){1&n&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(1),e.JRh(e.bMT(2,1,"form.required")))}function ni(n,s){1&n&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(1),e.JRh(e.bMT(2,1,"form.required")))}function ii(n,s){1&n&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(1),e.JRh(e.bMT(2,1,"form.invalidFormat")))}const ai=function(){return{standalone:!0}};function si(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",12)(1,"mat-checkbox",13),e.bIt("ngModelChange",function(a){return e.eBV(t),e.XpG().isRemove=a})("click",function(){return e.eBV(t),e.XpG().onClickRemovePlayer()}),e.EFF(2),e.nI1(3,"translate"),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngModel",t.isRemove)("ngModelOptions",e.lJ4(5,ai)),e.R7$(1),e.SpI(" ",e.bMT(3,3,"player.removePlayerReservation")," ")}}function oi(n,s){if(1&n&&(e.j41(0,"div")(1,"h4",14),e.EFF(2),e.nI1(3,"translate"),e.k0s(),e.nrm(4,"mat-divider",15),e.j41(5,"mat-checkbox",16),e.EFF(6),e.nI1(7,"translate"),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.JRh(e.bMT(3,3,"reservation.addons")),e.R7$(3),e.Y8G("disabled",!t.isCanEditRider),e.R7$(1),e.SpI(" ",e.bMT(7,5,"reservation.cart")," ")}}function ri(n,s){if(1&n){const t=e.RV6();e.j41(0,"app-card-partner-reservation",20),e.bIt("loadMorePartners",function(){return e.eBV(t),e.XpG(3).loadMorePartners()})("addPartnerPlayer",function(a){return e.eBV(t),e.XpG(3).toggleAddPlayer(a)}),e.nI1(1,"async"),e.k0s()}if(2&n){const t=e.XpG(3);e.Y8G("partnerPage",e.bMT(1,3,t.partnerPage$))("isDisable",t.isRemove)("isDisplayStore",null==t.data.reservationOptions?null:t.data.reservationOptions.displayBuddyStoreAssignedCourse)}}function li(n,s){if(1&n&&(e.j41(0,"mat-expansion-panel")(1,"mat-expansion-panel-header",17)(2,"mat-panel-title",18),e.EFF(3),e.nI1(4,"translate"),e.k0s()(),e.DNE(5,ri,2,5,"app-card-partner-reservation",19),e.k0s()),2&n){const t=e.XpG(2);e.R7$(3),e.SpI(" ",e.bMT(4,2,"booking.addSomeoneFromPreviousBooking")," "),e.R7$(2),e.Y8G("ngIf",null==t.data.reservationOptions?null:t.data.reservationOptions.enableLastTenPlayersBooking)}}function ci(n,s){if(1&n){const t=e.RV6();e.j41(0,"app-card-buddy-reservation",23),e.bIt("addBuddy",function(a){return e.eBV(t),e.XpG(3).toggleAddPlayer(a)})("removeBuddy",function(a){return e.eBV(t),e.XpG(3).toggleRemovePlayer(a)})("searchBuddies",function(a){return e.eBV(t),e.XpG(3).searchBuddies(a)})("selectBuddy",function(a){return e.eBV(t),e.XpG(3).selectBuddy(a)})("loadMoreBuddies",function(){return e.eBV(t),e.XpG(3).loadMoreBuddies()}),e.nI1(1,"async"),e.nI1(2,"async"),e.nI1(3,"async"),e.k0s()}if(2&n){const t=e.XpG(3);e.Y8G("buddiesPage",e.bMT(1,5,t.buddiesPage$))("isShowBuddiesLoadMore",e.bMT(2,7,t.isShowBuddiesLoadMore$))("isDisable",t.isRemove)("filteredBuddies",e.bMT(3,9,t.filteredBuddies$))("isDisplayStore",null==t.data.reservationOptions?null:t.data.reservationOptions.displayBuddyStoreAssignedCourse)}}function di(n,s){if(1&n&&(e.j41(0,"mat-expansion-panel")(1,"mat-expansion-panel-header",17)(2,"mat-panel-title",18),e.EFF(3),e.nI1(4,"translate"),e.k0s()(),e.j41(5,"div",21),e.DNE(6,ci,4,11,"app-card-buddy-reservation",22),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(3),e.SpI(" ",e.bMT(4,2,"buddy.searchBuddyList")," "),e.R7$(3),e.Y8G("ngIf",null==t.data.reservationOptions?null:t.data.reservationOptions.enableBuddyList)}}function pi(n,s){if(1&n&&(e.j41(0,"div")(1,"h4",14),e.EFF(2,"Swap Player"),e.k0s(),e.nrm(3,"mat-divider",15),e.DNE(4,li,6,4,"mat-expansion-panel",4),e.DNE(5,di,7,4,"mat-expansion-panel",4),e.nrm(6,"br"),e.k0s()),2&n){const t=e.XpG();e.R7$(4),e.Y8G("ngIf",null==t.data.reservationOptions?null:t.data.reservationOptions.enableLastTenPlayersBooking),e.R7$(1),e.Y8G("ngIf",null==t.data.reservationOptions?null:t.data.reservationOptions.enableBuddyList)}}let Le=(()=>{class n{constructor(t,i,a,o,r,c,h){this.fb=t,this.store=i,this.dialogRef=a,this.dialog=o,this.translate=r,this.actions$=c,this.data=h,this.isMobile=!1,this.isRemove=!1,this.isHideRider=!1,this.isCanEditRider=!0,this.isCartRestrict=!1,this.partnerPage$=this.store.pipe((0,p.Lt)(An.uJI)),this.buddiesPage$=this.store.pipe((0,p.Lt)(F.WT)),this.isShowBuddiesLoadMore$=this.store.pipe((0,p.Lt)(F.Dh)),this.filteredBuddies$=this.store.pipe((0,p.Lt)(F.Sx)),this.checkBookingLimit$=this.store.pipe((0,p.Lt)(pt)),this.actions$.pipe((0,_.gp)(d.QO.AddWriteInPlayerSuccess),(0,fe.s)(1)).subscribe(()=>{const b=this.getWriteInPlayerInformation();this.dialogRef.close(b)})}ngOnInit(){this.initForm(),this.mapDataToForm()}initForm(){this.formEdit=this.fb.group({firstName:new m.MJ("",m.k0.required),lastName:new m.MJ("",m.k0.required),email:new m.MJ("",[m.k0.email,m.k0.pattern(gt.R.Email)]),username:new m.MJ(""),isSelectCart:new m.MJ("")})}mapDataToForm(){if(this.data&&this.data.player){const t=this.data.player;this.isCartRestrict=this.data.isCartRestrict,this.tempPlayer=Object.assign(Object.assign({},t.value),{acct:this.data.reservationDetail.acct||"",golferId:this.data.reservationDetail.golferId||0,classCode:this.data.reservationDetail.memberClassCode,isIncludeRider:!this.isCartRestrict&&t.get("isAddCart").value}),this.formEdit.patchValue({firstName:t.get("firstName").value,lastName:t.get("lastName").value,email:t.get("email").value,isSelectCart:!this.isCartRestrict&&t.get("isAddCart").value}),this.isHideRider=this.data.isHideRider,this.isCanEditRider=!(this.isCartRestrict||!this.data.isCanEditRider&&t.get("isAddCart").value)}}onClickSubmit(){if(this.isRemove)this.removePlayer();else if(this.formEdit.valid){let t=null;this.formEdit.dirty||this.dialogRef.close(t),this.formEdit.get("isSelectCart").dirty&&this.store.dispatch(new d.ph({reservationId:this.data.reservationId,teesheetId:this.data.teesheetId,participantNo:this.data.participantNo,cartType:null,courseId:this.data.courseId,isAddCart:this.formEdit.get("isSelectCart").value}));const i=this.data.reservationDetail;(null==i?void 0:i.firstName)!==this.formEdit.get("firstName").value||(null==i?void 0:i.lastName)!==this.formEdit.get("lastName").value||(null==i?void 0:i.email)!==this.formEdit.get("email").value?this.store.dispatch(new d.L$({reservationId:this.data.reservationId,teesheetId:this.data.teesheetId,participantNo:this.data.participantNo,tempPlayer:this.tempPlayer,player:{firstName:this.formEdit.get("firstName").value,lastName:this.formEdit.get("lastName").value,email:this.formEdit.get("email").value,username:this.formEdit.get("username").value,acct:"",classCode:"",golferId:0,playerId:0,dependentId:0,storeId:1,participantNo:1,isIncludeRider:!1,isAdded:!0,fullName:this.formEdit.get("firstName").value+" "+this.formEdit.get("lastName").value,isGuestOf:!1}})):(t=this.getWriteInPlayerInformation(),this.dialogRef.close(t))}}getWriteInPlayerInformation(){return{isWriteIn:!0,isAddCart:this.formEdit.get("isSelectCart").value,firstName:this.formEdit.get("firstName").value,lastName:this.formEdit.get("lastName").value,email:this.formEdit.get("email").value,username:this.formEdit.get("username").value}}removePlayer(){this.store.dispatch(new d.qm({reservationId:this.data.reservationId,teesheetId:this.data.teesheetId,participantNo:this.data.participantNo})),this.dialogRef.close({isRemovePlayer:!0,reservationId:this.data.reservationId,teesheetId:this.data.teesheetId,participantNo:this.data.participantNo})}onClickDiscardChange(){!this.formEdit.valid||this.formEdit.dirty?this.dialog.open(se.B,{data:{header:this.translate.instant("form.confirmation"),body:`${this.translate.instant("dialog.requestDiscardChanges")}?`,result:!0},hasBackdrop:!0}).afterClosed().subscribe(i=>{console.log(`${this.translate.instant("dialog.dialogResult")}: ${i}`),i&&this.dialogRef.close()}):this.dialogRef.close()}onClickRemovePlayer(){let t="enable";this.isRemove||(t="disable"),this.formEdit.get("firstName")[t](),this.formEdit.get("lastName")[t](),this.formEdit.get("email")[t](),!this.data.isCanEditRider&&"disable"===t&&this.formEdit.get("isSelectCart")[t]()}loadMorePartners(){this.store.dispatch(new Ln.y9)}toggleAddPlayer(t){this.store.dispatch(new d.Lm({acct:t.acct,golferId:t.golferId,teesheetId:this.data.teesheetId,classCode:t.classCode,isBuddy:t.buddyId>0})),this.checkBookingLimit$.pipe((0,ht.i)(1),(0,ne.p)(i=>i&&i&&(null==i.error||""==i.error)),(0,fe.s)(1)).subscribe(()=>{this.dialogRef.close(Object.assign(Object.assign({},t),{isSelectBuddy:!0}))})}toggleRemovePlayer(t){this.store.dispatch(new he.UW(t.buddyId))}searchBuddies(t){this.store.dispatch(new he.nW({query:t}))}selectBuddy(t){this.store.dispatch(new he.qQ(t)),this.toggleAddPlayer(t)}loadMoreBuddies(){this.store.dispatch(new he.eX)}}return n.\u0275fac=function(t){return new(t||n)(e.rXU(m.ok),e.rXU(p.il),e.rXU(U.CP),e.rXU(U.bZ),e.rXU(G.c$),e.rXU(_.En),e.rXU(U.Vh,8))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-edit-player-dialog"]],decls:33,vars:28,consts:[["mat-dialog-title",""],[1,"mat-typography"],[1,"player-form",3,"formGroup"],["matInput","","formControlName","firstName","name","firstName","required","",3,"placeholder"],[4,"ngIf"],["matInput","","formControlName","lastName","name","lastName","required","",3,"placeholder"],["matInput","","type","email","formControlName","email","name","email",3,"placeholder"],["class","remove-player-checkbox",4,"ngIf"],["mat-flat-button","","color","warn",1,"edit-button",3,"click"],["mat-raised-button","","cdkFocusInitial","",1,"edit-button",3,"click"],["bdOpacity","0.9","bdColor","rgba(51,51,51,0.4)","size","default","color","#fff","type","ball-scale-pulse","fullScreen","false"],[2,"font-size","15px","color","white"],[1,"remove-player-checkbox"],[3,"ngModel","ngModelOptions","ngModelChange","click"],[2,"text-align","center","font-weight","bold","margin","0 auto"],[2,"margin-bottom","10px"],["formControlName","isSelectCart",3,"disabled"],[2,"margin","0"],[1,"header-title"],[3,"partnerPage","isDisable","isDisplayStore","loadMorePartners","addPartnerPlayer",4,"ngIf"],[3,"partnerPage","isDisable","isDisplayStore","loadMorePartners","addPartnerPlayer"],[1,"buddy-content"],[3,"buddiesPage","isShowBuddiesLoadMore","isDisable","filteredBuddies","isDisplayStore","addBuddy","removeBuddy","searchBuddies","selectBuddy","loadMoreBuddies",4,"ngIf"],[3,"buddiesPage","isShowBuddiesLoadMore","isDisable","filteredBuddies","isDisplayStore","addBuddy","removeBuddy","searchBuddies","selectBuddy","loadMoreBuddies"]],template:function(t,i){1&t&&(e.j41(0,"h2",0),e.EFF(1),e.nI1(2,"translate"),e.k0s(),e.j41(3,"mat-dialog-content",1)(4,"form",2)(5,"mat-form-field"),e.nrm(6,"input",3),e.nI1(7,"translate"),e.DNE(8,ti,3,3,"mat-error",4),e.k0s(),e.j41(9,"mat-form-field"),e.nrm(10,"input",5),e.nI1(11,"translate"),e.DNE(12,ni,3,3,"mat-error",4),e.k0s(),e.j41(13,"mat-form-field"),e.nrm(14,"input",6),e.nI1(15,"translate"),e.DNE(16,ii,3,3,"mat-error",4),e.k0s(),e.DNE(17,si,4,6,"div",7),e.nrm(18,"br"),e.DNE(19,oi,8,7,"div",4),e.DNE(20,pi,7,2,"div",4),e.k0s()(),e.j41(21,"mat-dialog-actions")(22,"button",8),e.bIt("click",function(){return i.onClickDiscardChange()}),e.EFF(23),e.nI1(24,"translate"),e.k0s(),e.j41(25,"button",9),e.bIt("click",function(){return i.onClickSubmit()}),e.EFF(26),e.nI1(27,"translate"),e.k0s()(),e.j41(28,"div")(29,"ngx-spinner",10)(30,"p",11),e.EFF(31),e.nI1(32,"translate"),e.k0s()()()),2&t&&(e.R7$(1),e.JRh(e.bMT(2,14,"player.editPlayer")),e.R7$(3),e.Y8G("formGroup",i.formEdit),e.R7$(2),e.FS9("placeholder",e.bMT(7,16,"name.firstName")),e.R7$(2),e.Y8G("ngIf",i.formEdit.get("firstName").hasError("required")),e.R7$(2),e.FS9("placeholder",e.bMT(11,18,"name.lastName")),e.R7$(2),e.Y8G("ngIf",i.formEdit.get("lastName").hasError("required")),e.R7$(2),e.FS9("placeholder",e.bMT(15,20,"email.email")),e.R7$(2),e.Y8G("ngIf",i.formEdit.get("email").hasError("email")||i.formEdit.get("email").hasError("pattern")),e.R7$(1),e.Y8G("ngIf",null==i.data?null:i.data.allowedRemovePlayer),e.R7$(2),e.Y8G("ngIf",!i.isCartRestrict&&!i.isHideRider),e.R7$(1),e.Y8G("ngIf",(null==i.data.reservationOptions?null:i.data.reservationOptions.enableLastTenPlayersBooking)||(null==i.data.reservationOptions?null:i.data.reservationOptions.enableBuddyList)),e.R7$(3),e.SpI(" ",e.bMT(24,22,"form.cancel")," "),e.R7$(3),e.SpI(" ",e.bMT(27,24,"form.submit")," "),e.R7$(5),e.SpI(" ",e.bMT(32,26,"loading.loading"),"... "))},directives:[U.BI,U.Yi,m.qT,m.cb,m.j4,z.rl,be.fg,m.me,m.BC,m.JD,m.YS,E.bT,z.TL,_t.So,m.vS,vt.q,A.GK,A.Z2,A.WN,Hn,ei,U.E7,ce.$z,yt.et],pipes:[G.D9,E.Jj],styles:["mat-spinner[_ngcontent-%COMP%]{margin:auto 0}.remove-player-checkbox[_ngcontent-%COMP%]     .mat-checkbox-checked.mat-accent .mat-checkbox-background, .remove-player-checkbox[_ngcontent-%COMP%]   .mat-checkbox-indeterminate.mat-accent[_ngcontent-%COMP%]   .mat-checkbox-background[_ngcontent-%COMP%], .remove-player-checkbox[_ngcontent-%COMP%]   .mat-accent[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked[_ngcontent-%COMP%], .remove-player-checkbox[_ngcontent-%COMP%]   .mat-accent[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate[_ngcontent-%COMP%], .remove-player-checkbox[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked[_ngcontent-%COMP%], .remove-player-checkbox[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate[_ngcontent-%COMP%]{background-color:red!important}.mat-input-element[_ngcontent-%COMP%]{font-size:15px!important}.edit-button[_ngcontent-%COMP%]{background-color:green;color:#fff;width:46%;margin:5px;height:45px}.mat-dialog-actions[_ngcontent-%COMP%]{padding:25px 0 10px}  .mat-form-field-appearance-legacy .mat-form-field-underline{height:1px!important;bottom:1.25em!important;width:100%!important}"]}),n})();var mi=g(38169),Me=g(96536),It=g(36392),Ye=g(27422),Z=g(80388),Ue=g(87192),bt=g(47448);function ui(n,s){1&n&&(e.j41(0,"mat-list-item")(1,"small"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&n&&(e.R7$(2),e.JRh(e.bMT(3,1,"reservation.noReservations")))}function gi(n,s){1&n&&(e.j41(0,"mat-list-item")(1,"small"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&n&&(e.R7$(2),e.SpI("",e.bMT(3,1,"loading.loading"),"..."))}function hi(n,s){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().ngIf;e.R7$(1),e.SpI(" / ",t.crossoverCourseName," ")}}function _i(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",38),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2).$implicit;return e.XpG(2).onClickEditReservation(a)}),e.EFF(1),e.nI1(2,"translate"),e.j41(3,"mat-icon"),e.EFF(4,"edit"),e.k0s()()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"form.edit")," "))}function vi(n,s){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().ngIf;e.R7$(1),e.SpI(" / ",t.crossoverCourseName," ")}}function fi(n,s){if(1&n&&(e.qex(0),e.j41(1,"tr")(2,"td",44),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"td",45),e.EFF(6),e.k0s()(),e.j41(7,"tr")(8,"td",44),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.j41(11,"td",45),e.EFF(12),e.k0s()(),e.bVm()),2&n){const t=s.$implicit;e.R7$(3),e.SpI("",e.bMT(4,4,"name.name"),":"),e.R7$(3),e.SpI(" ",t.fullName," "),e.R7$(3),e.SpI("",e.bMT(10,6,"email.email"),":"),e.R7$(3),e.SpI(" ",t.email," ")}}function yi(n,s){if(1&n&&(e.j41(0,"div")(1,"table",39)(2,"tr",40)(3,"td",41),e.EFF(4),e.nI1(5,"translate"),e.k0s()(),e.j41(6,"tr",40),e.nrm(7,"td",42),e.k0s(),e.DNE(8,fi,13,8,"ng-container",43),e.k0s()()),2&n){const t=e.XpG().ngIf;e.R7$(4),e.JRh(e.bMT(5,2,"player.playerDetails")),e.R7$(4),e.Y8G("ngForOf",t.reservationDetail)}}function Ii(n,s){if(1&n){const t=e.RV6();e.j41(0,"mat-icon",51),e.bIt("click",function(){e.eBV(t);const a=e.XpG(),o=a.$implicit,r=a.index,c=e.XpG(2).ngIf,h=e.XpG().$implicit;return e.XpG(2).onClickEditPlayerMobile(h,o,c,r)}),e.EFF(1," edit "),e.k0s()}}function bi(n,s){if(1&n){const t=e.RV6();e.j41(0,"mat-icon",52),e.bIt("click",function(){e.eBV(t);const a=e.XpG().index,o=e.XpG(3).$implicit;return e.XpG(2).onClickAddPlayer(o,a)}),e.EFF(1," add_circle "),e.k0s()}}function Ri(n,s){if(1&n&&(e.qex(0),e.j41(1,"tr")(2,"td",44),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"td",47),e.EFF(6),e.k0s(),e.j41(7,"td",48),e.DNE(8,Ii,2,0,"mat-icon",49),e.k0s(),e.j41(9,"td",48),e.DNE(10,bi,2,0,"mat-icon",50),e.k0s()(),e.j41(11,"tr")(12,"td",44),e.EFF(13),e.nI1(14,"translate"),e.k0s(),e.j41(15,"td",47),e.EFF(16),e.k0s()(),e.bVm()),2&n){const t=s.$implicit;e.R7$(3),e.SpI("",e.bMT(4,6,"name.name"),":"),e.R7$(3),e.SpI(" ",t.controls.fullName.value," "),e.R7$(2),e.Y8G("ngIf",t.controls.isCanEdit.value),e.R7$(2),e.Y8G("ngIf",t.controls.isShowAddPlayer.value),e.R7$(3),e.SpI("",e.bMT(14,8,"email.email"),":"),e.R7$(3),e.SpI(" ",t.controls.email.value," ")}}function Ci(n,s){if(1&n&&(e.j41(0,"div")(1,"table",46)(2,"tr",40)(3,"td",41),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"td",21),e.EFF(7),e.nI1(8,"translate"),e.k0s()(),e.j41(9,"tr",40),e.nrm(10,"td",42),e.k0s(),e.DNE(11,Ri,17,10,"ng-container",43),e.k0s()()),2&n){const t=e.XpG(2).$implicit;e.R7$(4),e.JRh(e.bMT(5,3,"player.playerNames")),e.R7$(3),e.JRh(e.bMT(8,5,"reservation.manage")),e.R7$(4),e.Y8G("ngForOf",t.get("reservationDetails").controls)}}function Pi(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",53),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2).$implicit;return e.XpG(2).onClickEditReservation(a)}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"booking.editBooking")," "))}function ki(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",54),e.bIt("click",function(){e.eBV(t);const a=e.XpG().ngIf;return e.XpG(3).onClickCancelBooking(a)}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"booking.cancelBooking")," "))}function xi(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",55),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2).$implicit;return e.XpG(2).onClickDiscardChannges(a)}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"form.discardChanges")," "))}function Mi(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",53),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2).$implicit;return e.XpG(2).onSaveChange(a)}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"form.saveChanges")," "))}function Fi(n,s){1&n&&(e.j41(0,"div",56)(1,"mat-icon",57),e.EFF(2,"info"),e.k0s(),e.j41(3,"p",58),e.EFF(4),e.nI1(5,"translate"),e.k0s()()),2&n&&(e.R7$(4),e.SpI(" ",e.bMT(5,1,"reservation.onlyReservationAdjustReservation"),". "))}function Ti(n,s){1&n&&(e.j41(0,"div",56)(1,"mat-icon",57),e.EFF(2,"info"),e.k0s(),e.j41(3,"p",58),e.EFF(4),e.nI1(5,"translate"),e.nI1(6,"translate"),e.nI1(7,"translate"),e.k0s()()),2&n&&(e.R7$(4),e.E5c(" ",e.bMT(5,3,"reservation.cannotEditedCanceled"),". ",e.bMT(6,5,"reservation.contactCourseInformation"),". ",e.bMT(7,7,"booking.thankYou"),". "))}function Oi(n,s){if(1&n&&(e.j41(0,"mat-expansion-panel",9)(1,"mat-expansion-panel-header",10)(2,"mat-panel-title")(3,"table",11)(4,"tr")(5,"td",12),e.EFF(6),e.nI1(7,"formatDateLocale"),e.k0s()(),e.j41(8,"tr")(9,"td",13),e.EFF(10),e.nI1(11,"date"),e.k0s()(),e.j41(12,"tr",14)(13,"td",12)(14,"small"),e.EFF(15),e.DNE(16,hi,2,1,"span",2),e.k0s()()(),e.j41(17,"tr",15)(18,"td",12),e.nrm(19,"hr"),e.k0s()(),e.j41(20,"tr",16)(21,"td",17)(22,"small"),e.EFF(23),e.nI1(24,"translate"),e.k0s()(),e.j41(25,"td")(26,"small"),e.EFF(27),e.nI1(28,"translate"),e.k0s()()(),e.j41(29,"tr",18)(30,"td",17),e.EFF(31),e.k0s(),e.j41(32,"td"),e.EFF(33),e.k0s()()()()(),e.j41(34,"table",19)(35,"tr")(36,"td",20),e.EFF(37),e.nI1(38,"translate"),e.k0s(),e.j41(39,"td",21),e.DNE(40,_i,5,3,"button",22),e.k0s()(),e.j41(41,"tr"),e.nrm(42,"td",23),e.k0s(),e.j41(43,"tr")(44,"td",24),e.EFF(45),e.nI1(46,"translate"),e.k0s(),e.j41(47,"td",25),e.EFF(48),e.nI1(49,"formatDateLocale"),e.k0s()(),e.j41(50,"tr")(51,"td",24),e.EFF(52),e.nI1(53,"translate"),e.k0s(),e.j41(54,"td",25),e.EFF(55),e.nI1(56,"date"),e.k0s()(),e.j41(57,"tr",26),e.nrm(58,"td",23),e.k0s(),e.j41(59,"tr",27)(60,"td",24),e.EFF(61),e.nI1(62,"translate"),e.k0s(),e.j41(63,"td",25),e.EFF(64),e.DNE(65,vi,2,1,"span",2),e.k0s()(),e.j41(66,"tr",28)(67,"td",24),e.EFF(68),e.nI1(69,"translate"),e.k0s(),e.j41(70,"td",25),e.EFF(71),e.k0s()(),e.j41(72,"tr",29),e.nrm(73,"td",23),e.k0s(),e.j41(74,"tr",30)(75,"td",24),e.EFF(76),e.nI1(77,"translate"),e.k0s(),e.j41(78,"td",25),e.EFF(79),e.k0s()(),e.j41(80,"tr")(81,"td",24),e.EFF(82),e.nI1(83,"translate"),e.k0s(),e.j41(84,"td",25),e.EFF(85),e.k0s()()(),e.nrm(86,"br"),e.DNE(87,yi,9,4,"div",31),e.DNE(88,Ci,12,7,"ng-template",null,32,e.C5r),e.j41(90,"div",33),e.DNE(91,Pi,3,3,"button",34),e.DNE(92,ki,3,3,"button",35),e.DNE(93,xi,3,3,"button",36),e.DNE(94,Mi,3,3,"button",34),e.k0s(),e.DNE(95,Fi,6,3,"div",37),e.DNE(96,Ti,8,9,"div",37),e.k0s()),2&n){const t=s.ngIf,i=e.sdS(89),a=e.XpG(),o=a.index,r=a.$implicit,c=e.XpG(2);e.Y8G("formGroupName",o),e.R7$(1),e.Y8G("collapsedHeight",c.customCollapsedHeight)("expandedHeight",c.customExpandedHeight),e.R7$(5),e.SpI(" ",e.brH(7,34,t.startTime,c.reservationOptions.dateFormat,"full-short")," "),e.R7$(4),e.SpI(" ",e.i5U(11,38,t.startTime,c.reservationOptions.timeDisplay===c.TimeDisplayType.Hours12?"shortTime":"HH:mm")," "),e.R7$(5),e.SpI(" ",t.onlineCourseName||t.courseName," "),e.R7$(1),e.Y8G("ngIf",t.crossoverCourseName),e.R7$(7),e.JRh(e.bMT(24,41,"player.players")),e.R7$(4),e.JRh(e.bMT(28,43,"teetime.holes")),e.R7$(4),e.SpI(" ",t.numberOfPlayer," "),e.R7$(2),e.SpI(" ",t.holes," "),e.R7$(4),e.JRh(e.bMT(38,45,"reservation.details")),e.R7$(3),e.Y8G("ngIf",!r.controls.isEditReservation.value&&c.visibleEditBookingButton(t)),e.R7$(5),e.SpI("",e.bMT(46,47,"date.date"),":"),e.R7$(3),e.SpI(" ",e.brH(49,49,t.startTime,c.reservationOptions.dateFormat,"full-short")," "),e.R7$(4),e.SpI("",e.bMT(53,53,"date.time"),":"),e.R7$(3),e.SpI(" ",e.i5U(56,55,t.startTime,c.reservationOptions.timeDisplay===c.TimeDisplayType.Hours12?"shortTime":"HH:mm")," "),e.R7$(6),e.SpI("",e.bMT(62,58,"course.course"),":"),e.R7$(3),e.SpI(" ",t.onlineCourseName||t.courseName," "),e.R7$(1),e.Y8G("ngIf",t.crossoverCourseName),e.R7$(3),e.SpI("",e.bMT(69,60,"teetime.holes"),":"),e.R7$(3),e.SpI(" ",t.holes," "),e.R7$(5),e.SpI("",e.bMT(77,62,"player.players"),":"),e.R7$(3),e.SpI(" ",t.numberOfPlayer," "),e.R7$(3),e.SpI("",e.bMT(83,64,"reservation.confirmKey"),":"),e.R7$(3),e.SpI(" ",t.reservationConfirmKey," "),e.R7$(2),e.Y8G("ngIf",!r.get("isEditReservation")||!r.get("isEditReservation").value)("ngIfElse",i),e.R7$(4),e.Y8G("ngIf",!r.controls.isEditReservation.value&&c.visibleEditBookingButton(t)),e.R7$(1),e.Y8G("ngIf",!r.controls.isEditReservation.value&&c.visibleCancelationBookingButton(t)),e.R7$(1),e.Y8G("ngIf",r.controls.isEditReservation.value),e.R7$(1),e.Y8G("ngIf",r.controls.isEditReservation.value),e.R7$(1),e.Y8G("ngIf",c.blockNonOwnerEdit(t)),e.R7$(1),e.Y8G("ngIf",c.blockNoRefundDeposit(t))}}function Ei(n,s){if(1&n&&(e.j41(0,"mat-accordion"),e.DNE(1,Oi,97,66,"mat-expansion-panel",8),e.k0s()),2&n){const t=s.$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("ngIf",i.getReservation(t))}}function Ni(n,s){if(1&n&&(e.j41(0,"div",6),e.DNE(1,Ei,2,1,"mat-accordion",7),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.form.get("upcomingReservations").controls)("ngForTrackBy",t.trackByUpcomingReservation)}}function $i(n,s){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",59)(2,"button",60),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return a.onClickShowMoreReservations(a.upcomingReservationsCurrentPage)}),e.EFF(3,"Show More Reservations"),e.k0s()(),e.bVm()}}function Si(n,s){if(1&n&&(e.j41(0,"mat-option",67),e.EFF(1),e.k0s()),2&n){const t=s.$implicit,i=e.XpG(2);e.Y8G("value",t.oldText),e.R7$(1),e.SpI(" ",i.getTranslationText(t.key,t.value)," ")}}function Di(n,s){1&n&&(e.j41(0,"mat-list-item")(1,"small",1),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&n&&(e.R7$(2),e.JRh(e.bMT(3,1,"reservation.noPreviousBookings")))}function wi(n,s){1&n&&(e.j41(0,"mat-list-item")(1,"small",1),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&n&&(e.R7$(2),e.SpI("",e.bMT(3,1,"loading.loading"),"..."))}function ji(n,s){if(1&n&&(e.j41(0,"mat-list"),e.DNE(1,Di,4,3,"mat-list-item",2),e.DNE(2,wi,4,3,"mat-list-item",31),e.k0s()),2&n){e.XpG();const t=e.sdS(16),i=e.XpG();e.R7$(1),e.Y8G("ngIf",!i.isLoadingPastReservations&&0===i.pastReservations.length),e.R7$(1),e.Y8G("ngIf",i.isLoadingPastReservations)("ngIfElse",t)}}function Gi(n,s){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.SpI(" / ",t.crossoverCourseName," ")}}function Bi(n,s){if(1&n&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.SpI(" / ",t.crossoverCourseName," ")}}function Ai(n,s){if(1&n&&(e.qex(0),e.j41(1,"tr")(2,"td",44),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"td",45),e.EFF(6),e.k0s()(),e.j41(7,"tr")(8,"td",44),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.j41(11,"td",45),e.EFF(12),e.k0s()(),e.bVm()),2&n){const t=s.$implicit;e.R7$(3),e.SpI("",e.bMT(4,4,"name.name"),":"),e.R7$(3),e.SpI(" ",t.fullName," "),e.R7$(3),e.SpI("",e.bMT(10,6,"email.email"),":"),e.R7$(3),e.SpI(" ",t.email?t.email:"-"," ")}}function Li(n,s){if(1&n&&(e.j41(0,"mat-accordion")(1,"mat-expansion-panel")(2,"mat-expansion-panel-header",10)(3,"mat-panel-title")(4,"table",11)(5,"tr")(6,"td",68),e.EFF(7),e.nI1(8,"formatDateLocale"),e.k0s()(),e.j41(9,"tr")(10,"td",13),e.EFF(11),e.nI1(12,"date"),e.k0s(),e.nrm(13,"td",69),e.k0s(),e.j41(14,"tr",14)(15,"td",12)(16,"small"),e.EFF(17),e.DNE(18,Gi,2,1,"span",2),e.k0s()()(),e.j41(19,"tr",15)(20,"td",12),e.nrm(21,"hr"),e.k0s()(),e.j41(22,"tr",16)(23,"td",17)(24,"small"),e.EFF(25),e.nI1(26,"translate"),e.k0s()(),e.j41(27,"td")(28,"small"),e.EFF(29),e.nI1(30,"translate"),e.k0s()()(),e.j41(31,"tr",18)(32,"td",17),e.EFF(33),e.k0s(),e.j41(34,"td"),e.EFF(35),e.k0s()()()()(),e.j41(36,"table",19)(37,"tr")(38,"td",20),e.EFF(39),e.nI1(40,"translate"),e.k0s(),e.nrm(41,"td",21),e.k0s(),e.j41(42,"tr"),e.nrm(43,"td",23),e.k0s(),e.j41(44,"tr")(45,"td",24),e.EFF(46),e.nI1(47,"translate"),e.k0s(),e.j41(48,"td",25),e.EFF(49),e.nI1(50,"formatDateLocale"),e.k0s()(),e.j41(51,"tr")(52,"td",24),e.EFF(53),e.nI1(54,"translate"),e.k0s(),e.j41(55,"td",25),e.EFF(56),e.nI1(57,"date"),e.k0s()(),e.j41(58,"tr",26),e.nrm(59,"td",23),e.k0s(),e.j41(60,"tr",27)(61,"td",24),e.EFF(62),e.nI1(63,"translate"),e.k0s(),e.j41(64,"td",25),e.EFF(65),e.DNE(66,Bi,2,1,"span",2),e.k0s()(),e.j41(67,"tr",28)(68,"td",24),e.EFF(69),e.nI1(70,"translate"),e.k0s(),e.j41(71,"td",25),e.EFF(72),e.k0s()(),e.j41(73,"tr",29),e.nrm(74,"td",23),e.k0s(),e.j41(75,"tr",30)(76,"td",24),e.EFF(77),e.nI1(78,"translate"),e.k0s(),e.j41(79,"td",25),e.EFF(80),e.k0s()(),e.j41(81,"tr")(82,"td",24),e.EFF(83),e.nI1(84,"translate"),e.k0s(),e.j41(85,"td",25),e.EFF(86),e.k0s()()(),e.nrm(87,"br"),e.j41(88,"table",39)(89,"tr",40)(90,"td",41),e.EFF(91),e.nI1(92,"translate"),e.k0s(),e.nrm(93,"td",21),e.k0s(),e.j41(94,"tr",40),e.nrm(95,"td",42),e.k0s(),e.DNE(96,Ai,13,8,"ng-container",43),e.k0s()()()),2&n){const t=s.$implicit,i=e.XpG(3);e.R7$(2),e.Y8G("collapsedHeight",i.customCollapsedHeight)("expandedHeight",i.customExpandedHeight),e.R7$(5),e.SpI(" ",e.brH(8,26,t.startTime,i.reservationOptions.dateFormat,"full-short")," "),e.R7$(4),e.SpI(" ",e.i5U(12,30,t.startTime,i.reservationOptions.timeDisplay===i.TimeDisplayType.Hours12?"shortTime":"HH:mm")," "),e.R7$(6),e.SpI(" ",t.onlineCourseName||t.courseName," "),e.R7$(1),e.Y8G("ngIf",t.crossoverCourseName),e.R7$(7),e.JRh(e.bMT(26,33,"player.players")),e.R7$(4),e.JRh(e.bMT(30,35,"teetime.holes")),e.R7$(4),e.SpI(" ",t.numberOfPlayer," "),e.R7$(2),e.SpI(" ",t.holes," "),e.R7$(4),e.JRh(e.bMT(40,37,"reservation.details")),e.R7$(7),e.SpI("",e.bMT(47,39,"date.date"),":"),e.R7$(3),e.SpI(" ",e.brH(50,41,t.startTime,i.reservationOptions.dateFormat,"full-short")," "),e.R7$(4),e.SpI("",e.bMT(54,45,"date.time"),":"),e.R7$(3),e.SpI(" ",e.i5U(57,47,t.startTime,i.reservationOptions.timeDisplay===i.TimeDisplayType.Hours12?"shortTime":"HH:mm")," "),e.R7$(6),e.SpI("",e.bMT(63,50,"course.course"),":"),e.R7$(3),e.SpI(" ",t.onlineCourseName||t.courseName," "),e.R7$(1),e.Y8G("ngIf",t.crossoverCourseName),e.R7$(3),e.SpI("",e.bMT(70,52,"teetime.holes"),":"),e.R7$(3),e.SpI(" ",t.holes," "),e.R7$(5),e.SpI("",e.bMT(78,54,"player.players"),":"),e.R7$(3),e.SpI(" ",t.numberOfPlayer," "),e.R7$(3),e.SpI("",e.bMT(84,56,"reservation.confirmKey"),":"),e.R7$(3),e.SpI(" ",t.reservationConfirmKey," "),e.R7$(5),e.JRh(e.bMT(92,58,"player.playerDetails")),e.R7$(5),e.Y8G("ngForOf",t.reservationDetail)}}function Yi(n,s){if(1&n&&e.DNE(0,Li,97,60,"mat-accordion",43),2&n){const t=e.XpG(2);e.Y8G("ngForOf",t.pastReservations)}}function Ui(n,s){if(1&n){const t=e.RV6();e.j41(0,"mat-card",61)(1,"mat-card-header")(2,"mat-card-title"),e.EFF(3),e.nI1(4,"translate"),e.k0s()(),e.j41(5,"mat-card-content")(6,"div",62)(7,"div",63)(8,"mat-form-field")(9,"mat-label"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"mat-select",64),e.bIt("ngModelChange",function(a){return e.eBV(t),e.XpG().filter=a})("selectionChange",function(){e.eBV(t);const a=e.XpG();return a.onChangePastReservationFilter(a.filter)}),e.DNE(13,Si,2,2,"mat-option",65),e.k0s()()()(),e.DNE(14,ji,3,3,"mat-list",2),e.DNE(15,Yi,1,1,"ng-template",null,66,e.C5r),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(3),e.SpI(" ",e.bMT(4,5,"reservation.pastReservations")," "),e.R7$(7),e.JRh(e.bMT(11,7,"date.dateRange")),e.R7$(2),e.Y8G("ngModel",t.filter),e.R7$(1),e.Y8G("ngForOf",t.years),e.R7$(1),e.Y8G("ngIf",t.isShowPastReservations)}}let Vi=(()=>{class n{constructor(t,i,a,o,r){this.store=t,this.dialog=i,this.snackBar=a,this.cdr=o,this.translate=r,this.unsubscribe=new Ae.B,this.isUniquePlayers=!1,this.changeYear=new e.bkB,this.cancelBooking=new e.bkB,this.years=[{key:"date.pastDays",value:{day:30},oldText:"Past 30 Days"},{key:"date.pastMonths",value:{month:6},oldText:"Past 6 Months"},{key:"date.pastMonths",value:{month:12},oldText:"Past 12 Months"}],this.panelOpenState=!1,this.customCollapsedHeight="80px",this.customExpandedHeight="80px",this.currentPlayer$=this.store.pipe((0,p.Lt)(Se)),this.TimeDisplayType=Me.S,this.isShowPastReservations=!1}get upcomingReservations(){return this._upcomingReservations}set upcomingReservations(t){this._upcomingReservations=t,t&&t.length>0&&this.patchObjectToForm()}get availablePastReservationYears(){return this._availablePastReservationYears}set availablePastReservationYears(t){this._availablePastReservationYears=t}get isLoadingUpcomingReservations(){return this._isLoadingUpcomingReservations}set isLoadingUpcomingReservations(t){this._isLoadingUpcomingReservations=t,t||this.patchObjectToForm()}ngOnInit(){this.initForm(),(0,It.z)([this.store.pipe((0,p.Lt)(at)),this.store.pipe((0,p.Lt)(st))]).pipe((0,V.Q)(this.unsubscribe),(0,I.T)(([t,i])=>{this.upcomingReservationsCurrentPage=t,this.upcomingReservationsTotalPages=i})).subscribe(),this.store.pipe((0,V.Q)(this.unsubscribe),(0,p.Lt)(rt)).subscribe(t=>this.isUniquePlayers=t),this.store.pipe((0,p.Lt)(F.wz),(0,ne.p)(t=>null!==t),(0,H.M)(t=>{this.store.dispatch(new he.fJ(t.golferId,t.sub,t.dependent_id)),this.store.dispatch(new d.RZ(t.golferId))})).subscribe(),this.store.pipe((0,V.Q)(this.unsubscribe),(0,p.Lt)(De),(0,ge.c)(50)).subscribe(t=>{if(t.isSuccess&&t.reservationId>0&&t.teesheetId>0){this.store.dispatch(new d.Dx({reservationId:t.reservationId,teesheetId:t.teesheetId}));const i=this.form.get("upcomingReservations");if(i&&i.length>0){const a=i.controls.findIndex(o=>o.value.reservationId===t.reservationId&&o.value.teesheetId===t.teesheetId);a>-1&&(this.rePatchBookingsToForm(i.at(a),t.reservationId,t.teesheetId),this._markFormPristine(i.at(a)),this.cdr.detectChanges())}this.snackBar.open(`${this.translate.instant("form.updateSuccessful")}!`,"",{duration:3e3})}}),this.store.pipe((0,V.Q)(this.unsubscribe),(0,p.Lt)(we)).subscribe(t=>{t.isSuccess&&t.reservationId>0&&t.teesheetId>0&&(this.store.dispatch(new d.Dx({reservationId:t.reservationId,teesheetId:t.teesheetId})),this.snackBar.open(`${this.translate.instant("form.cancelSuccessful")}!`,"",{duration:3e3}))}),this.store.pipe((0,V.Q)(this.unsubscribe),(0,p.Lt)($e),(0,ge.c)(50)).subscribe(t=>{if(t){const i=this.form.get("upcomingReservations");if(i&&i.length>0){const a=i.controls.findIndex(o=>o.value.reservationId===t.reservationId&&o.value.teesheetId===t.teesheetId);if(a>-1){const o=i.at(a),r=o.get("reservationDetails"),c=r.controls.findIndex(h=>h.value.participantNo===t.participantNo);c>-1&&(r.at(c).patchValue({firstName:t.firstName,lastName:t.lastName,fullName:`${t.firstName} ${t.lastName}`,email:t.email}),o.patchValue({editedPlayerIndex:-1,editedParticipantNo:-1,isEditedPlayerDirty:!1}),o.markAsDirty(),this.onClosePlayerComponent({reservationId:t.reservationId,teesheetId:t.teesheetId}))}}}})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}initForm(){this.form=new m.gE({upcomingReservations:new m.Yp([])})}patchObjectToForm(){!this.form||(this.frmArrayUpcomingReservation=this.form.get("upcomingReservations"),this.frmArrayUpcomingReservation&&this.frmArrayUpcomingReservation.reset(),this.upcomingReservations&&this.upcomingReservations.forEach(t=>{t&&this.frmArrayUpcomingReservation.push(this.createUpcomingReservation(t))}))}createUpcomingReservation(t){const i=new m.gE({reservationId:new m.MJ(""),teesheetId:new m.MJ(""),numberOfPlayer:new m.MJ(""),maxNumberOfPlayer:new m.MJ(""),isEditReservation:new m.MJ(""),editedPlayerIndex:new m.MJ(""),editedParticipantNo:new m.MJ(""),isEditedPlayerDirty:new m.MJ(""),reservationDetails:new m.Yp([])});i.patchValue({reservationId:t.reservationId,teesheetId:t.teeSheetId,numberOfPlayer:t.numberOfPlayer,maxNumberOfPlayer:Math.min(t.maxNumberOfPlayer,this.reservationOptions.maxPlayerPerTeeTime),isEditReservation:!1,editedPlayerIndex:-1,editedParticipantNo:-1,isEditedPlayerDirty:!1});const a=this.myGolferId===t.reservationDetail[0].golferId,o=this.myGolferId===t.ownerGolferId;let r=0;return t.reservationDetail.forEach(c=>{const h=this.myGolferId===c.golferId;this.frmArrayReservationDetails=i.get("reservationDetails"),this.frmArrayReservationDetails.push(this.createReservationDetail(c,Math.min(t.maxNumberOfPlayer,this.reservationOptions.maxPlayerPerTeeTime),t.numberOfPlayer,a,h,o,r,t)),r++}),i}createReservationDetail(t,i,a,o,r,c,h,b){var C;const R=new m.gE({isAddCart:new m.MJ(""),firstName:new m.MJ(""),lastName:new m.MJ(""),fullName:new m.MJ(""),email:new m.MJ("",[m.k0.email]),participantNo:new m.MJ(""),isShowAddPlayer:new m.MJ(""),isCanEdit:new m.MJ("")});return R.patchValue({isAddCart:t.cartType!==K.T.None,firstName:t.firstName,lastName:t.lastName,fullName:t.fullName,email:t.email,participantNo:t.participantNo,isShowAddPlayer:this.isShowAddPlayer(i,a,h),isCanEdit:this.isCanEdit(r,c,h,null!==(C=b.groupNo)&&void 0!==C?C:0)}),R}getReservationDate(t){return(0,mi.Ay)(t,"ddd, mmm dd, yyyy")}getReservation(t){const i=t.get("reservationId")?t.get("reservationId").value:0,a=t.get("teesheetId")?t.get("teesheetId").value:0;return this.upcomingReservations.filter(o=>o.reservationId===i&&o.teeSheetId===a)?this.upcomingReservations.filter(o=>o.reservationId===i&&o.teeSheetId===a)[0]:this.upcomingReservations[0]}isShowAddPlayer(t,i,a){return i===a+1&&i<t}isCanEdit(t,i,a,o){return 0===a&&i?o>1:i||t}visibleCancelationBookingButton(t){var i;if(t.totalCheckInCells>0||!this.reservationOptions.enableOnlineTeeTimeCancel||!t.ownerGolferId||0===t.reservationDetail.length)return!1;const a=null!==(i=t.groupNo)&&void 0!==i?i:0,o=t.ownerGolferId===this.myGolferId,r=t.reservationDetail[0].golferId===this.myGolferId;if(this.reservationOptions.notAllowBuddyEditReservation&&!o||a<=1&&(!o||!r)||a>1&&!o&&r||!this.reservationOptions.allowRefundDepositToCreditCard&&t.depositId>0&&!this.reservationOptions.enableOnlineTeeTimeCancel)return!1;if(this.reservationOptions.doNotAllowTeeTimeCancel){const c=new Date,h=new Date(t.startTime.toString());return h.setHours(h.getHours()-this.reservationOptions.doNotAllowTeeTimeCancelHours),c<h}return!0}visibleEditBookingButton(t){if(t.totalCheckInCells>0||!this.reservationOptions.allowChangeReservation||this.blockNoRefundDeposit(t)||this.blockNonOwnerEdit(t))return!1;if(this.reservationOptions.allowChangeReservationBefore){const i=new Date,a=new Date(t.startTime.toString());return a.setHours(a.getHours()-this.reservationOptions.hourForChangeReservationBefore),i<a}return!0}blockNoRefundDeposit(t){return!this.reservationOptions.allowRefundDepositToCreditCard&&t.depositId>0&&!this.reservationOptions.allowChangeReservation}blockNonOwnerEdit(t){return!(!(this.reservationOptions.allowRefundDepositToCreditCard&&t.depositId>0)||t.ownerGolferId&&t.ownerGolferId===this.myGolferId)||!(!this.reservationOptions.notAllowBuddyEditReservation||t.ownerGolferId&&t.ownerGolferId===this.myGolferId)}onChangePastReservationFilter(t){if(isNaN(+t)){this.isShowPastReservations=!0;const i=new Date;t.includes("30 Days")?i.setDate(i.getDate()-30):t.includes("6 Months")?i.setMonth(i.getMonth()-6):i.setMonth(i.getMonth()-12),this.changeYear.emit({date:i})}else this.changeYear.emit({year:+t})}onClickEditReservation(t){const i=t.get("reservationId").value,a=t.get("teesheetId").value;t.patchValue({isEditReservation:!0}),this.store.dispatch(new d.n3(this.upcomingReservations.filter(o=>o.reservationId===i&&o.teeSheetId===a)[0]))}onSaveChange(t){if(t.valid)if(t.dirty){const i=t.get("reservationId").value,a=t.get("teesheetId").value,o=t.get("numberOfPlayer").value;if(i>0){const r=this.upcomingReservations.filter(c=>c.reservationId===i&&c.teeSheetId===a)[0];if(this.reservationOptions.forceUniquePlayer&&!this.isUniquePlayers)return void this.store.dispatch(new je.w9({header:this.translate.instant("player.invalidPlayerSelection"),details:`${this.translate.instant("player.allPlayersNeedToBeUnique")}.\n\n${this.translate.instant("player.requestSelectUniquePlayers")}.`}));r.isNotAllowSingleBooking&&1===o?this.openWarningDialog(`${this.translate.instant("reservation.singleNotAllowedToBook")}.`):r.isNotAllowTwosomeBooking&&2===o?this.openWarningDialog(`${this.translate.instant("reservation.twosomesNotAllowedToBook")}.`):r.auctionId>0&&r.auctionType!==re.Y.DynamicPrice&&r.groupNo>0?this.openWarningDialog(`${this.translate.instant("reservation.teetimeOnlyAllowsCertainNumberPlayers")}.`):r.auctionId>0&&(r.auctionType===re.Y.Discount||r.auctionType===re.Y.SpecialPrice)&&0===r.groupNo&&o<r.auctionMinGolfer?this.openWarningDialog(`${this.translate.instant("reservation.teetimeMinimumPlayer",{minGolfer:r.auctionMinGolfer})}. ${this.translate.instant("reservation.reviewYourChanges")}.`):this.store.dispatch(o===r.numberOfPlayer?new d.Rp({reservationId:i,teesheetId:a,isForfeitDeposit:!1}):new d.SJ({reservationId:i,teesheetId:a}))}}else this.onClickDiscardChannges(t)}onClickCancelBooking(t){this.cancelBooking.emit(t)}onClickDiscardChannges(t){!t.valid||t.dirty?this.dialog.open(se.B,{data:{header:this.translate.instant("form.confirmation"),body:`${this.translate.instant("dialog.requestDiscardChanges")}?`,result:!0},hasBackdrop:!0}).afterClosed().subscribe(a=>{console.log(`${this.translate.instant("dialog.dialogResult")}: ${a}`),a&&(this.discardReservationChanges(t),this.cdr.detectChanges())}):this.discardReservationChanges(t)}discardReservationChanges(t){const i=t.get("reservationId").value,a=t.get("teesheetId").value;this.store.dispatch(new d.Dx({reservationId:i,teesheetId:a})),this.rePatchBookingsToForm(t,i,a)}rePatchBookingsToForm(t,i,a){const o=t.get("reservationDetails");this.clearFormArray(o);let r=0;const c=this.upcomingReservations.filter(C=>C.reservationId===i&&C.teeSheetId===a)[0],h=this.myGolferId===c.reservationDetail[0].golferId,b=this.myGolferId===c.ownerGolferId;null!==c&&(c.reservationDetail.forEach(C=>{const R=this.myGolferId===C.golferId;o.push(this.createReservationDetail(C,Math.min(c.maxNumberOfPlayer,this.reservationOptions.maxPlayerPerTeeTime),c.numberOfPlayer,h,R,b,r,c)),r++}),t.patchValue({numberOfPlayer:c.numberOfPlayer,editedPlayerIndex:-1,editedParticipantNo:-1,isEditReservation:!1,isEditedPlayerDirty:!1}),this._markFormPristine(t))}onClickAddPlayer(t,i){const a=t.get("reservationId").value,o=t.get("teesheetId").value;this.frmArrayReservationDetails=t.get("reservationDetails"),this.store.dispatch(new d.vz({reservationId:a,teesheetId:o})),this.store.pipe((0,p.Lt)(ke),(0,fe.s)(1)).subscribe(r=>{if(r){const c=r.reservationDetail[r.reservationDetail.length-1],h=r.numberOfPlayer,b=this.myGolferId===r.reservationDetail[0].golferId,C=this.myGolferId===r.ownerGolferId;t.patchValue({numberOfPlayer:h}),this.frmArrayReservationDetails.push(this.createReservationDetail(c,t.get("maxNumberOfPlayer").value,h,b,C,!1,i+1,r)),this.frmArrayReservationDetails.at(i).patchValue({isShowAddPlayer:!1}),t.markAsDirty()}})}onClosePlayerComponent(t){this.cdr.detectChanges(),this.store.dispatch(new d.c1({reservationId:t.reservationId,teesheetId:t.teesheetId}))}isCanEditRider(t){if(!this.courseOptions||0===this.courseOptions.length)return!1;const i=this.courseOptions.find(a=>a.courseId===t);return!!i&&i.fullCartSelectionType===J.M.AllowCartSelection}isHideRider(t){if(!this.courseOptions||0===this.courseOptions.length)return!0;const i=this.courseOptions.find(a=>a.courseId===t);return!i||i.fullCartSelectionType===J.M.DoNotOfferCarts}onClickEditPlayerMobile(t,i,a,o){const r=t.get("reservationId").value,c=t.get("teesheetId").value,h=i.get("participantNo").value;this.dialog.open(Le,{data:{reservationId:r,teesheetId:c,participantNo:h,player:i,courseId:a.courseId,isHideRider:this.isHideRider(a.courseId),isCartRestrict:a.isCartRestrict,isCanEditRider:this.isCanEditRider(a.courseId),allowedRemovePlayer:t.get("reservationDetails").value.length>a.minNumberOfPlayer,reservationOptions:this.reservationOptions,reservationDetail:a.reservationDetail[o]},hasBackdrop:!0}).afterClosed().subscribe(C=>{var R;const M=C;if(!M)return;M.isSelectBuddy&&this.store.dispatch(new d.rF({reservationId:r,teesheetId:c,participantNo:h,buddy:C}));const l=this.form.get("upcomingReservations");if(l&&l.length>0){const u=l.controls.findIndex(v=>v.value.reservationId===r&&v.value.teesheetId===c);if(u>-1){const v=l.at(u),f=v.get("reservationDetails"),y=f.controls.findIndex(O=>O.value.participantNo===h),P=this.myGolferId===a.ownerGolferId,k=v.get("numberOfPlayer").value-1;y>-1&&(M.isRemovePlayer?(f.removeAt(y),f.at(k-1).patchValue({isShowAddPlayer:!0}),v.patchValue({numberOfPlayer:k,editedPlayerIndex:-1,editedParticipantNo:-1,isEditedPlayerDirty:!1})):(M.isSelectBuddy||M.isWriteIn)&&i.patchValue({firstName:M.firstName,lastName:M.lastName,fullName:`${M.firstName} ${M.lastName}`,email:M.email,isAddCart:M.isAddCart,participantNo:h,isShowAddPlayer:this.isShowAddPlayer(a.maxNumberOfPlayer,l.length,y),isCanEdit:this.isCanEdit(!0,P,y,null!==(R=a.groupNo)&&void 0!==R?R:0)}),v.markAsDirty(),this.cdr.detectChanges())}}})}openWarningDialog(t){return this.dialog.open(ue.z,{data:{header:this.translate.instant("dialog.information"),details:t},hasBackdrop:!0}).afterClosed()}clearFormArray(t){for(;0!==t.length;)t.removeAt(0)}_markFormPristine(t){Object.keys(t.controls).forEach(i=>{t.controls[i].markAsPristine()})}getTranslationText(t,i){return this.translate.instant(t,i)}onClickShowMoreReservations(t){this.store.dispatch(new d.H({currentPage:t+1}))}trackByUpcomingReservation(t,i){return`${i.value.reservationId}${i.value.teesheetId}`}}return n.\u0275fac=function(t){return new(t||n)(e.rXU(p.il),e.rXU(U.bZ),e.rXU(Ye.UG),e.rXU(e.gRc),e.rXU(G.c$))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-reservation-mobile-v2"]],inputs:{upcomingReservations:"upcomingReservations",pastReservations:"pastReservations",courseOptions:"courseOptions",availablePastReservationYears:"availablePastReservationYears",isLoadingUpcomingReservations:"isLoadingUpcomingReservations",isLoadingPastReservations:"isLoadingPastReservations",reservationOptions:"reservationOptions",myGolferId:"myGolferId"},outputs:{changeYear:"changeYear",cancelBooking:"cancelBooking"},decls:13,vars:9,consts:[[1,"registerbox"],[1,"no-reservation"],[4,"ngIf"],[3,"formGroup"],["formArrayName","upcomingReservations",4,"ngIf"],["class","registerbox past",4,"ngIf"],["formArrayName","upcomingReservations"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"formGroupName",4,"ngIf"],[3,"formGroupName"],[3,"collapsedHeight","expandedHeight"],["cellspacing","0","cellpadding","0"],["colspan","2"],[1,"title-time"],[1,"course-name"],[1,"course-info-divider"],[1,"tr-text","player-and-hole-titles"],[1,"td-line"],[1,"title-info"],[1,"tblcheckout"],[1,"td-headerleft"],[1,"td-headerright"],["class","link-button","mat-stroked-button","",3,"click",4,"ngIf"],["colspan","2",1,"tblhr"],[1,"lefttext"],[1,"righttext"],[1,"course-details-divider"],[1,"course-details"],[1,"hole-details"],[1,"hole-details-divider"],[1,"player-details"],[4,"ngIf","ngIfElse"],["edit",""],[2,"width","100%","text-align","center","margin-top","10px"],["mat-raised-button","","class","edit-button",3,"click",4,"ngIf"],["mat-flat-button","","class","cancel-button","color","white",3,"click",4,"ngIf"],["mat-flat-button","","class","edit-button","color","white",3,"click",4,"ngIf"],["class","div-info",4,"ngIf"],["mat-stroked-button","",1,"link-button",3,"click"],["cellspacing","0","cellpadding","0",1,"player-section"],[1,"player-header"],["colspan","2",1,"td-headerleft"],["colspan","3",1,"tblhr"],[4,"ngFor","ngForOf"],[1,"tdleft-text"],["colspan","2",1,"tdright-text"],["cellspacing","0","cellpadding","0","formArrayName","reservationDetails",1,"player-section"],[1,"tdright-text"],["rowspan","2",1,"td-button-action"],["class","edit-player-button button-style","style","\n                            background: steelblue;\n                            color: white;\n                            font-size: 30px;\n                          ",3,"click",4,"ngIf"],["class","edit-player-button button-style","style","color: green; font-size: 35px",3,"click",4,"ngIf"],[1,"edit-player-button","button-style",2,"background","steelblue","color","white","font-size","30px",3,"click"],[1,"edit-player-button","button-style",2,"color","green","font-size","35px",3,"click"],["mat-raised-button","",1,"edit-button",3,"click"],["mat-flat-button","","color","white",1,"cancel-button",3,"click"],["mat-flat-button","","color","white",1,"edit-button",3,"click"],[1,"div-info"],[1,"icon"],[1,"text"],[2,"display","flex","justify-content","center","padding","1rem"],["mat-button","","color","primary",3,"click"],[1,"registerbox","past"],["fxLayout","row","fxLayoutWrap","","fxLayoutAlign","center",1,"reservation-container"],["fxFlex","80%","fxFlexAlign","center"],["color","accent",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["pastReservation",""],[3,"value"],["colspan","3"],[1,"title-right"]],template:function(t,i){1&t&&(e.j41(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),e.EFF(3),e.nI1(4,"translate"),e.k0s()(),e.j41(5,"mat-card-content")(6,"mat-list",1),e.DNE(7,ui,4,3,"mat-list-item",2),e.DNE(8,gi,4,3,"mat-list-item",2),e.k0s(),e.j41(9,"form",3),e.DNE(10,Ni,2,2,"div",4),e.k0s(),e.DNE(11,$i,4,0,"ng-container",2),e.k0s()(),e.DNE(12,Ui,17,9,"mat-card",5)),2&t&&(e.R7$(3),e.JRh(e.bMT(4,7,"reservation.upcomingReservations")),e.R7$(4),e.Y8G("ngIf",!(i.isLoadingUpcomingReservations||i.upcomingReservations&&0!==i.upcomingReservations.length)),e.R7$(1),e.Y8G("ngIf",i.isLoadingUpcomingReservations&&(!i.upcomingReservations||0===i.upcomingReservations.length)),e.R7$(1),e.Y8G("formGroup",i.form),e.R7$(1),e.Y8G("ngIf",i.form.get("upcomingReservations")),e.R7$(1),e.Y8G("ngIf",i.upcomingReservationsCurrentPage<i.upcomingReservationsTotalPages),e.R7$(1),e.Y8G("ngIf",i.availablePastReservationYears&&i.availablePastReservationYears.length>0))},directives:[D.RN,D.MM,D.dh,D.m2,Z.jt,E.bT,Z.YE,m.qT,m.cb,m.j4,m.v8,E.Sq,A.BS,A.GK,m.$R,A.Z2,A.WN,ce.$z,_e.An,w.DJ,w.sA,w.UI,w.R$,z.rl,z.nJ,Ue.VO,m.BC,m.vS,ye.wT],pipes:[G.D9,bt.m,E.vh],styles:[".registerbox[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px;margin-top:20px!important;margin-left:15px!important;margin-right:15px!important;border:1px solid #e8eaec;border-radius:5px}.past[_ngcontent-%COMP%]{margin-bottom:20px!important}.mat-card-header[_ngcontent-%COMP%]{padding-top:10px;padding-left:10px}.mat-card-header[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]{font-size:medium;font-weight:700}.mat-expansion-panel[_ngcontent-%COMP%]{margin-left:10px!important;margin-right:10px!important;margin-bottom:10px!important;border:.5px solid #e8eaec;border-radius:10px;background-color:#fff!important}.mat-expansion-panel-header[_ngcontent-%COMP%]{height:160px!important;padding-bottom:5px;border-bottom:.5px solid #e8eaec;border-radius:10px}[_nghost-%COMP%]     .mat-expansion-panel-body{margin-top:15px!important;padding:0 5px 6px;font-size:small}[_nghost-%COMP%]     .mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:none}.no-reservation[_ngcontent-%COMP%]{padding-left:10px}.title-time[_ngcontent-%COMP%]{font-size:large;font-weight:700;color:#2961d5}.title-right[_ngcontent-%COMP%]{font-size:small;font-weight:500;color:#2961d5;text-align:end}.title-info[_ngcontent-%COMP%]{text-align:center;color:#000;font-size:small;font-weight:700}.reservation-container[_ngcontent-%COMP%]{width:100%;padding-top:10px}.reservation-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-block-start:.25em;margin-block-end:.25em}.mat-list[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]{height:72px}table[_ngcontent-%COMP%]{width:100%}.tblhr[_ngcontent-%COMP%]{border-bottom:1px solid lightgray}.lefttext[_ngcontent-%COMP%]{text-align:left;width:40%}.righttext[_ngcontent-%COMP%]{text-align:right;font-weight:600}.td-headerleft[_ngcontent-%COMP%]{text-align:left;font-weight:600;max-width:120px}.td-headerright[_ngcontent-%COMP%]{text-align:right;font-weight:600}.tdleft-text[_ngcontent-%COMP%]{width:20%;padding-top:3px;padding-bottom:3px;text-align:left;font-size:small;font-weight:600}.tdright-text[_ngcontent-%COMP%]{padding-top:3px;padding-bottom:3px;text-align:left;font-size:small;color:#959595}.td-button-action[_ngcontent-%COMP%]{text-align:-webkit-right}.player-section[_ngcontent-%COMP%]{border:none!important}.player-section[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(4n+1), .player-section[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(4n+2){background-color:#f4f4f4}.player-header[_ngcontent-%COMP%]{background-color:#fff!important}.tr-text[_ngcontent-%COMP%]{text-align:center}.td-line[_ngcontent-%COMP%]{width:50%;border-right:.5px solid #ececf0}.link-button[_ngcontent-%COMP%]{padding:0;border:none;text-align:initial;color:#2961d5}.link-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:medium}.mat-expanded[_ngcontent-%COMP%]{background-color:#dcdcdc}.cancel-button[_ngcontent-%COMP%]{font-weight:600;border:1px solid #92afe9;background-color:#fff!important;color:#2961d5;width:90%;margin:5px;height:45px}.player-section[_ngcontent-%COMP%]{table-layout:fixed}.player-section[_ngcontent-%COMP%]   .td-headerleft[_ngcontent-%COMP%]{width:76%}.player-section[_ngcontent-%COMP%]   .tdright-text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.edit-button[_ngcontent-%COMP%]{font-weight:600;border:1px solid #d9d9d9;background-color:#fff;color:#4b4a4a;text-align:center;width:90%;margin:5px;padding:0;height:45px}.edit-player-button[_ngcontent-%COMP%]{font-size:27px;display:inline-table;margin:2px}.div-info[_ngcontent-%COMP%]{border:solid gray 1px;border-radius:11px;width:100%;margin-top:15px}.div-info[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:gray}.div-info[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:gray;font-style:italic;font-weight:lighter;text-align:center;padding:15px 30px;margin:-30px 0 0}.text[_ngcontent-%COMP%]{cursor:text}.button-style[_ngcontent-%COMP%]{cursor:pointer;display:table-cell;border-radius:4pt}"]}),n})();var Rt=g(14234),Xi=g(35367);const Hi=["first"];function Ji(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",12),e.bIt("click",function(){return e.eBV(t),e.XpG().openManagePartyListDialog()}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"buddy.addBuddy")," "))}function zi(n,s){1&n&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"form.required")," "))}function Wi(n,s){1&n&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"form.required")," "))}let Qi=(()=>{class n{constructor(t,i,a,o,r){this.dialog=t,this.fb=i,this.store=a,this.baseConfigurationService=o,this.translate=r,this.closePlayerComponent=new e.bkB,this.checkBookingLimit$=this.store.pipe((0,p.Lt)(pt)),this.isMobile=!1,this.isFirstImplement=!0,this.isSelectBuddy=!1,this.isAlive=!0}set playerIndex(t){t>0&&!this.isFirstImplement&&this.mapDataToForm()}ngOnInit(){this.isMobile=this.baseConfigurationService.serverSettings.isMobile,this.initForm(),this.mapDataToForm(),this.subscribePlayer=this.store.pipe((0,ve.v)(()=>this.isAlive),(0,p.Lt)(Ne),(0,ge.c)(50)).subscribe(t=>{if(t&&this.currentPlayer){const i=this.reservation.get("editedPlayerIndex").value,a=this.reservation.get("reservationDetails");if(i>=0&&a){const o=a.at(i);o.patchValue({firstName:this.currentPlayer.firstName,lastName:this.currentPlayer.lastName,fullName:`${this.currentPlayer.firstName} ${this.currentPlayer.lastName}`}),o.patchValue({email:this.currentPlayer.email}),this.resetPlayerNameComponent(),this.closePlayerComponent.emit({reservationId:this.reservationId,teesheetId:this.teesheetId})}}})}ngOnDestroy(){this.isAlive=!1}initForm(){this.form=this.fb.group({firstName:[null,m.k0.required],lastName:[null,m.k0.required]}),this.isFirstImplement=!1}mapDataToForm(){this.reservationId=this.reservation.get("reservationId").value,this.teesheetId=this.reservation.get("teesheetId").value,this.participantNo=this.reservation.get("editedParticipantNo").value;const t=this.reservation.get("editedPlayerIndex").value,i=this.reservation.get("reservationDetails");if((t>0||this.groupNo>1)&&i){const a=i.at(t);this.form.patchValue({firstName:a.get("firstName").value,lastName:a.get("lastName").value})}this.elementRef.nativeElement.focus(),this.resetBuddy()}onClickSubmit(){if(this.form.valid){if(this.form.dirty){const t=this.reservation.get("editedPlayerIndex").value,i=this.reservation.get("reservationDetails");if(t>=0&&i){const a=i.at(t);this.isSelectBuddy&&this.selectedBuddy?(this.store.dispatch(new d.rF({reservationId:this.reservationId,teesheetId:this.teesheetId,participantNo:this.participantNo,buddy:this.selectedBuddy})),a.patchValue({firstName:this.selectedBuddy.firstName,lastName:this.selectedBuddy.lastName,fullName:`${this.selectedBuddy.firstName} ${this.selectedBuddy.lastName}`,email:this.selectedBuddy.email})):(this.store.dispatch(new d.L$({reservationId:this.reservationId,teesheetId:this.teesheetId,participantNo:this.participantNo,player:{firstName:this.form.controls.firstName.value,lastName:this.form.controls.lastName.value,acct:"",classCode:"",golferId:0,playerId:0,dependentId:0,email:"",username:"",storeId:1,participantNo:1,isIncludeRider:!1,fullName:`${this.form.controls.firstName.value} ${this.form.controls.lastName.value}`,isAdded:!0,isGuestOf:!1}})),a.patchValue({firstName:this.form.controls.firstName.value,lastName:this.form.controls.lastName.value,fullName:`${this.form.controls.firstName.value} ${this.form.controls.lastName.value}`,email:""}))}}this.resetPlayerNameComponent()}}onClickCancel(){this.form.dirty?this.dialog.open(se.B,{data:{header:this.translate.instant("form.confirmation"),body:`${this.translate.instant("dialog.requestDiscardPlayerChanges")}?`,result:!0},hasBackdrop:!0}).afterClosed().subscribe(i=>{i&&this.resetPlayerNameComponent()}):this.resetPlayerNameComponent()}resetPlayerNameComponent(){this.store.dispatch(new d.oz({reservationId:this.reservationId,teesheetId:this.teesheetId})),this.reservation.patchValue({editedPlayerIndex:-1,editedParticipantNo:-1,isEditedPlayerDirty:!1}),this.resetBuddy()}openManagePartyListDialog(){this.dialog.open(Xi.P,Object.assign(Object.assign({},this.baseConfigurationService.serverSettings.isMobile?pe.B.MOBILE_MODAL_CONFIG:{width:pe.B.MODAL_WIDTH_LARGE}),{data:{isEditReservation:!0,isDisplayStore:this.isDisplayStore},hasBackdrop:!0})).afterClosed().subscribe(a=>{a?(this.store.dispatch(new d.Lm({acct:a.acct,golferId:a.golferId,teesheetId:this.teesheetId,classCode:a.classCode,isBuddy:!0})),this.checkBookingLimit$.pipe((0,ht.i)(1),(0,ne.p)(o=>o&&o&&(null==o.error||""==o.error)),(0,fe.s)(1)).subscribe(o=>{this.isSelectBuddy=!0,this.selectedBuddy=a,this.form.patchValue({firstName:a.firstName,lastName:a.lastName}),this.form.markAsDirty(),this.reservation.markAsDirty(),this.reservation.patchValue({isEditedPlayerDirty:!0})})):this.resetBuddy()})}resetBuddy(){this.isSelectBuddy=!1,this.selectedBuddy=null}onNameChanged(){this.resetBuddy(),this.reservation.markAsDirty(),this.reservation.patchValue({isEditedPlayerDirty:!0})}openDialog(t,i,a){return this.dialog.open(ue.z,{data:{header:t,details:i?"":a,styledDetails:i},hasBackdrop:!0}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.rXU(U.bZ),e.rXU(m.ok),e.rXU(p.il),e.rXU(Pe.t),e.rXU(G.c$))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-player-name"]],viewQuery:function(t,i){if(1&t&&e.GBs(Hi,5),2&t){let a;e.mGM(a=e.lsd())&&(i.elementRef=a.first)}},inputs:{reservation:"reservation",isAllowNewCustomer:"isAllowNewCustomer",doNotAllowWriteInNames:"doNotAllowWriteInNames",isShowBuddy:"isShowBuddy",playerIndex:"playerIndex",currentPlayer:"currentPlayer",groupNo:"groupNo",isDisplayStore:"isDisplayStore"},outputs:{closePlayerComponent:"closePlayerComponent"},decls:30,vars:20,consts:[[3,"formGroup"],[2,"width","auto"],[2,"width","100px"],[2,"width","50px"],["matInput","","formControlName","firstName","autocomplete","off",1,"player-input",3,"placeholder","readonly","change"],["first",""],["matInput","","formControlName","lastName","autocomplete","off",1,"player-input",3,"placeholder","readonly","change"],["mat-stroked-button","","class","s-btn","style","background-color:steelblue; color: white;",3,"click",4,"ngIf"],[1,"player-button",2,"color","red",3,"click"],[1,"player-button",2,"color","green",3,"click"],[4,"ngIf"],["colspan","3"],["mat-stroked-button","",1,"s-btn",2,"background-color","steelblue","color","white",3,"click"]],template:function(t,i){1&t&&(e.j41(0,"form",0)(1,"table")(2,"colgroup"),e.nrm(3,"col",1)(4,"col",1)(5,"col",2)(6,"col",3)(7,"col",3),e.k0s(),e.j41(8,"tr")(9,"td")(10,"input",4,5),e.bIt("change",function(){return i.onNameChanged()}),e.nI1(12,"translate"),e.k0s()(),e.j41(13,"td")(14,"input",6),e.bIt("change",function(){return i.onNameChanged()}),e.nI1(15,"translate"),e.k0s()(),e.j41(16,"td"),e.DNE(17,Ji,3,3,"button",7),e.k0s(),e.j41(18,"td")(19,"mat-icon",8),e.bIt("click",function(){return i.onClickCancel()}),e.EFF(20," cancel "),e.k0s()(),e.j41(21,"td")(22,"mat-icon",9),e.bIt("click",function(){return i.onClickSubmit()}),e.EFF(23," check_circle "),e.k0s()()(),e.j41(24,"tr")(25,"td"),e.DNE(26,zi,3,3,"mat-error",10),e.k0s(),e.j41(27,"td"),e.DNE(28,Wi,3,3,"mat-error",10),e.k0s(),e.nrm(29,"td",11),e.k0s()()()),2&t&&(e.Y8G("formGroup",i.form),e.R7$(10),e.AVh("text",i.isAllowNewCustomer&&!i.doNotAllowWriteInNames)("default",!i.isAllowNewCustomer||i.isAllowNewCustomer&&i.doNotAllowWriteInNames),e.FS9("placeholder",e.bMT(12,16,"name.firstName")),e.Y8G("readonly",!i.isAllowNewCustomer||i.isAllowNewCustomer&&i.doNotAllowWriteInNames),e.R7$(4),e.AVh("text",i.isAllowNewCustomer&&!i.doNotAllowWriteInNames)("default",!i.isAllowNewCustomer||i.isAllowNewCustomer&&i.doNotAllowWriteInNames),e.FS9("placeholder",e.bMT(15,18,"name.lastName")),e.Y8G("readonly",!i.isAllowNewCustomer||i.isAllowNewCustomer&&i.doNotAllowWriteInNames),e.R7$(3),e.Y8G("ngIf",i.isShowBuddy),e.R7$(9),e.Y8G("ngIf",i.form.get("firstName").hasError("required")),e.R7$(2),e.Y8G("ngIf",i.form.get("lastName").hasError("required")))},directives:[m.qT,m.cb,m.j4,be.fg,m.me,m.BC,m.JD,E.bT,ce.$z,_e.An,z.TL],pipes:[G.D9],styles:["form[_ngcontent-%COMP%]{margin-top:10px}table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}table[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:none}td[_ngcontent-%COMP%]:not(:nth-child(1n+3)){padding-right:2em}td[_ngcontent-%COMP%]:nth-child(1n+3){padding-right:4px;text-align:center}.player-input[_ngcontent-%COMP%]{background-color:#fff;height:35px;padding:10px;width:100%;text-align:left;border-radius:4pt;border:1px solid #969696;box-shadow:0 5px 20px #0000000d;-webkit-box-shadow:0px 5px 20px rgba(0,0,0,.05)}.player-button[_ngcontent-%COMP%]{cursor:pointer;display:table;font-size:33px;width:100%}.default[_ngcontent-%COMP%]{cursor:default;background-color:#ebebeb}.text[_ngcontent-%COMP%]{cursor:text}"]}),n})();function Ki(n,s){1&n&&(e.j41(0,"mat-list-item")(1,"small"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&n&&(e.R7$(2),e.JRh(e.bMT(3,1,"reservation.noReservations")))}function Zi(n,s){1&n&&(e.j41(0,"mat-list-item")(1,"small"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&n&&(e.R7$(2),e.SpI("",e.bMT(3,1,"loading.loading"),"..."))}function qi(n,s){1&n&&(e.j41(0,"th"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"booking.groupBooking")," "))}function ea(n,s){if(1&n&&(e.j41(0,"td")(1,"span"),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.j41(4,"span",33),e.EFF(5),e.nI1(6,"translate"),e.k0s()()),2&n){const t=e.XpG(3).ngIf,i=e.XpG(3);e.R7$(2),e.JRh(e.i5U(3,3,t.startTime,i.getTimeFormat())),e.R7$(3),e.Lme("",e.bMT(6,6,"reservation.group")," ",t.groupNo,"")}}const Ct=function(n){return{"alt-row":n}};function ta(n,s){if(1&n&&(e.j41(0,"tr",32)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.DNE(5,ea,7,8,"td",1),e.k0s()),2&n){const t=s.$implicit,i=s.odd,a=e.XpG(2).ngIf;e.Y8G("ngClass",e.eq3(4,Ct,i)),e.R7$(2),e.JRh(t.fullName),e.R7$(2),e.JRh(t.email),e.R7$(1),e.Y8G("ngIf",a.groupNo>0)}}function na(n,s){if(1&n&&(e.j41(0,"div")(1,"table")(2,"tr")(3,"th"),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.j41(6,"th"),e.EFF(7),e.nI1(8,"translate"),e.k0s(),e.DNE(9,qi,3,3,"th",1),e.k0s(),e.j41(10,"tr"),e.nrm(11,"td",30),e.k0s(),e.DNE(12,ta,6,6,"tr",31),e.k0s()()),2&n){const t=e.XpG().ngIf;e.R7$(4),e.JRh(e.bMT(5,4,"player.players")),e.R7$(3),e.JRh(e.bMT(8,6,"email.email")),e.R7$(2),e.Y8G("ngIf",t.groupNo>0),e.R7$(3),e.Y8G("ngForOf",t.reservationDetail)}}function ia(n,s){1&n&&(e.qex(0),e.nrm(1,"col",42),e.bVm())}function aa(n,s){1&n&&(e.j41(0,"th",39),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(1),e.JRh(e.bMT(2,1,"reservation.remove")))}function sa(n,s){1&n&&(e.j41(0,"th",39),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"reservation.addon")," "))}function oa(n,s){1&n&&(e.j41(0,"mat-error"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"email.emailInvalidFormat")," "))}function ra(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",54)(1,"mat-icon",55),e.bIt("click",function(){e.eBV(t);const a=e.XpG().index,o=e.XpG(3).$implicit;return e.XpG(2).onClickAddPlayer(o,a)}),e.EFF(2," add_circle_outline "),e.k0s()()}}function la(n,s){if(1&n){const t=e.RV6();e.j41(0,"mat-icon",56),e.bIt("click",function(){e.eBV(t);const a=e.XpG(),o=a.$implicit,r=a.index,c=e.XpG(3).$implicit;return e.XpG(2).onClickEditPlayer(c,o,o.controls.isCanEdit.value,r)}),e.EFF(1," edit "),e.k0s()}}function ca(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",54)(1,"mat-icon",56),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2),o=a.$implicit,r=a.index,c=e.XpG(3).$implicit;return e.XpG(2).onClickRemovePlayer(c,o,r)}),e.EFF(2," delete_forever "),e.k0s()()}}function da(n,s){if(1&n&&(e.j41(0,"td",50),e.DNE(1,ca,3,0,"div",49),e.k0s()),2&n){const t=e.XpG(),i=t.$implicit,a=t.index,o=e.XpG(3).$implicit,r=e.XpG(2);e.R7$(1),e.Y8G("ngIf",r.isShowRemoveIcon(o,i,a))}}const pa=function(n){return{"text-align":n}};function ma(n,s){if(1&n){const t=e.RV6();e.j41(0,"td",38)(1,"mat-checkbox",57),e.bIt("change",function(a){e.eBV(t);const o=e.XpG().$implicit,r=e.XpG(3).$implicit;return e.XpG(2).onCheckChangedCart(r,o,a.checked)}),e.EFF(2),e.nI1(3,"translate"),e.k0s()()}if(2&n){const t=e.XpG().$implicit,i=e.XpG(3).$implicit,a=e.XpG(2);e.Y8G("ngStyle",e.eq3(5,pa,a.isHideAllRemovePlayer(i)?"center":"initial")),e.R7$(1),e.Y8G("disabled",!t.controls.isCanEditRider.value),e.R7$(1),e.JRh(e.bMT(3,3,"reservation.cart"))}}function ua(n,s){if(1&n){const t=e.RV6();e.j41(0,"tr",43)(1,"td")(2,"div",44)(3,"div",45)(4,"input",46),e.bIt("click",function(){const a=e.eBV(t),o=a.$implicit,r=a.index,c=e.XpG(3).$implicit;return e.XpG(2).onClickEditPlayer(c,o,o.controls.isCanEdit.value,r)}),e.nI1(5,"translate"),e.k0s()()()(),e.j41(6,"td")(7,"div",44)(8,"div",47)(9,"input",48),e.bIt("focusout",function(){const o=e.eBV(t).$implicit,r=e.XpG(3).$implicit;return e.XpG(2).onFocusOutEmail(r,o)}),e.nI1(10,"translate"),e.k0s(),e.DNE(11,oa,3,3,"mat-error",1),e.k0s(),e.DNE(12,ra,3,0,"div",49),e.k0s()(),e.j41(13,"td",50),e.DNE(14,la,2,0,"mat-icon",51),e.k0s(),e.DNE(15,da,2,1,"td",52),e.DNE(16,ma,4,7,"td",53),e.k0s()}if(2&n){const t=s.$implicit,i=s.index,a=e.XpG(2).ngIf,o=e.XpG().$implicit,r=e.XpG(2);e.Y8G("formGroupName",i),e.R7$(4),e.AVh("pointer",t.controls.isCanEdit.value)("default",!t.controls.isCanEdit.value)("highlight",r.getEditedIndex(o)===i),e.FS9("placeholder",e.bMT(5,19,"name.fullName")),e.R7$(5),e.AVh("default",!t.controls.isCanEdit.value||o.controls.editedParticipantNo.value>-1)("text",t.controls.isCanEdit.value),e.FS9("placeholder",e.bMT(10,21,"email.email")),e.Y8G("readonly",!t.controls.isCanEdit.value||o.controls.editedParticipantNo.value>-1),e.R7$(2),e.Y8G("ngIf",t.get("email").hasError("email")||t.get("email").hasError("pattern")),e.R7$(1),e.Y8G("ngIf",o.controls.editedParticipantNo.value<=-1&&t.controls.isShowAddPlayer.value),e.R7$(2),e.Y8G("ngIf",t.controls.isCanEdit.value),e.R7$(1),e.Y8G("ngIf",!r.isHideAllRemovePlayer(o)),e.R7$(1),e.Y8G("ngIf",!a.isNotAllowCartSelection)}}function ga(n,s){if(1&n){const t=e.RV6();e.j41(0,"tr")(1,"td",58)(2,"app-player-name",59),e.bIt("closePlayerComponent",function(a){return e.eBV(t),e.XpG(5).onClosePlayerComponent(a)}),e.nI1(3,"async"),e.k0s()()()}if(2&n){const t=e.XpG(2).ngIf,i=e.XpG().$implicit,a=e.XpG(2);e.R7$(2),e.Y8G("reservation",i)("isAllowNewCustomer",a.reservationOptions.allowNewCustomerRegistration)("isShowBuddy",a.reservationOptions.enableBuddyList)("playerIndex",i.controls.editedPlayerIndex.value)("currentPlayer",e.bMT(3,8,a.currentPlayer$))("doNotAllowWriteInNames",a.reservationOptions.doNotAllowWriteInNames)("groupNo",t.groupNo)("isDisplayStore",a.reservationOptions.displayBuddyStoreAssignedCourse)}}const ha=function(n){return{width:n}};function _a(n,s){if(1&n&&(e.j41(0,"table",34)(1,"colgroup"),e.nrm(2,"col",35)(3,"col",36)(4,"col",37),e.DNE(5,ia,2,0,"ng-container",1),e.nrm(6,"col",38),e.k0s(),e.j41(7,"tr")(8,"th"),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.j41(11,"th"),e.EFF(12),e.nI1(13,"translate"),e.k0s(),e.j41(14,"th",39),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.DNE(17,aa,3,3,"th",40),e.DNE(18,sa,3,3,"th",40),e.k0s(),e.j41(19,"tr"),e.nrm(20,"td",30),e.k0s(),e.DNE(21,ua,17,23,"tr",41),e.DNE(22,ga,4,10,"tr",1),e.k0s()),2&n){const t=e.XpG().ngIf,i=e.XpG().$implicit,a=e.XpG(2);e.R7$(5),e.Y8G("ngIf",!a.isHideAllRemovePlayer(i)),e.R7$(1),e.Y8G("ngStyle",e.eq3(15,ha,a.isHideAllRemovePlayer(i)?"30%":"20%")),e.R7$(3),e.JRh(e.bMT(10,9,"player.player")),e.R7$(3),e.JRh(e.bMT(13,11,"email.email")),e.R7$(3),e.JRh(e.bMT(16,13,"reservation.edit")),e.R7$(2),e.Y8G("ngIf",!a.isHideAllRemovePlayer(i)),e.R7$(1),e.Y8G("ngIf",!t.isNotAllowCartSelection),e.R7$(3),e.Y8G("ngForOf",i.get("reservationDetails").controls),e.R7$(1),e.Y8G("ngIf",i.controls.editedParticipantNo.value>-1)}}function va(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",64),e.bIt("click",function(){e.eBV(t);const a=e.XpG(3).$implicit;return e.XpG(2).onClickEditReservation(a)}),e.j41(1,"mat-icon"),e.EFF(2,"edit"),e.k0s(),e.EFF(3),e.nI1(4,"translate"),e.k0s()}2&n&&(e.R7$(3),e.SpI(" ",e.bMT(4,1,"booking.editBooking")," "))}function fa(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",65),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2).ngIf;return e.XpG(3).onClickCancelBooking(a)}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"booking.cancelBooking")," "))}function ya(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",68),e.bIt("click",function(){e.eBV(t);const a=e.XpG(4).$implicit;return e.XpG(2).onClickDiscardChannges(a)}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"form.discardChanges")," "))}function Ia(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",69),e.bIt("click",function(){e.eBV(t);const a=e.XpG(4).$implicit;return e.XpG(2).onSaveChange(a)}),e.EFF(1),e.nI1(2,"translate"),e.k0s()}2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"form.saveChanges")," "))}function ba(n,s){if(1&n&&(e.DNE(0,ya,3,3,"button",66),e.DNE(1,Ia,3,3,"button",67)),2&n){const t=e.XpG(3).$implicit;e.Y8G("ngIf",t.controls.isEditReservation.value),e.R7$(1),e.Y8G("ngIf",t.controls.isEditReservation.value)}}function Ra(n,s){if(1&n&&(e.j41(0,"div",60),e.DNE(1,va,5,3,"button",61),e.DNE(2,fa,3,3,"button",62),e.DNE(3,ba,2,2,"ng-template",null,63,e.C5r),e.k0s()),2&n){const t=e.sdS(4),i=e.XpG().ngIf,a=e.XpG().$implicit,o=e.XpG(2);e.R7$(1),e.Y8G("ngIf",!a.controls.isEditReservation.value&&o.visibleEditBookingButton(i))("ngIfElse",t),e.R7$(1),e.Y8G("ngIf",!a.controls.isEditReservation.value&&o.visibleCancelationBookingButton(i))}}function Ca(n,s){1&n&&(e.j41(0,"div",70)(1,"mat-icon",54),e.EFF(2,"info"),e.k0s(),e.j41(3,"p",71),e.EFF(4),e.nI1(5,"translate"),e.k0s()()),2&n&&(e.R7$(4),e.SpI(" ",e.bMT(5,1,"reservation.onlyReservationAdjustReservation"),". "))}function Pa(n,s){1&n&&(e.j41(0,"div",70)(1,"mat-icon",54),e.EFF(2,"info"),e.k0s(),e.j41(3,"p",71),e.EFF(4),e.nI1(5,"translate"),e.nI1(6,"translate"),e.nI1(7,"translate"),e.k0s()()),2&n&&(e.R7$(4),e.E5c(" ",e.bMT(5,3,"reservation.cannotEditedCanceled"),". ",e.bMT(6,5,"reservation.contactCourseInformation"),". ",e.bMT(7,7,"booking.thankYou"),". "))}function ka(n,s){if(1&n&&(e.j41(0,"mat-expansion-panel",7)(1,"mat-expansion-panel-header",8)(2,"mat-panel-title")(3,"div",9)(4,"div",10),e.EFF(5),e.nI1(6,"formatDateLocale"),e.k0s(),e.j41(7,"div",11)(8,"small"),e.EFF(9),e.nI1(10,"date"),e.k0s()()(),e.j41(11,"div",12)(12,"div",13),e.EFF(13),e.k0s(),e.j41(14,"div",14)(15,"small"),e.EFF(16),e.nI1(17,"translate"),e.k0s(),e.EFF(18," | "),e.j41(19,"small",15),e.EFF(20),e.nI1(21,"translate"),e.k0s()()(),e.j41(22,"div",16)(23,"mat-icon"),e.EFF(24,"expand_more"),e.k0s()()()(),e.j41(25,"div",17)(26,"div",18),e.EFF(27),e.nI1(28,"translate"),e.k0s(),e.j41(29,"div",19)(30,"div",20)(31,"label"),e.EFF(32),e.nI1(33,"translate"),e.k0s(),e.j41(34,"span"),e.EFF(35),e.nI1(36,"formatDateLocale"),e.k0s()(),e.j41(37,"div",21)(38,"label"),e.EFF(39),e.nI1(40,"translate"),e.k0s(),e.j41(41,"span"),e.EFF(42),e.k0s()(),e.j41(43,"div",22)(44,"label"),e.EFF(45),e.nI1(46,"translate"),e.k0s(),e.j41(47,"span"),e.EFF(48),e.k0s()(),e.j41(49,"div",20)(50,"label"),e.EFF(51),e.nI1(52,"translate"),e.k0s(),e.j41(53,"span"),e.EFF(54),e.nI1(55,"date"),e.k0s()(),e.j41(56,"div",23)(57,"label"),e.EFF(58),e.nI1(59,"translate"),e.k0s(),e.j41(60,"span"),e.EFF(61),e.k0s()(),e.j41(62,"div",24)(63,"label"),e.EFF(64),e.nI1(65,"translate"),e.k0s(),e.j41(66,"span"),e.EFF(67),e.k0s()()()(),e.j41(68,"div",25)(69,"div"),e.DNE(70,na,13,8,"div",26),e.DNE(71,_a,23,17,"ng-template",null,27,e.C5r),e.k0s(),e.DNE(73,Ra,5,3,"div",28),e.k0s(),e.DNE(74,Ca,6,3,"div",29),e.DNE(75,Pa,8,9,"div",29),e.k0s()),2&n){const t=s.ngIf,i=e.sdS(72),a=e.XpG(),o=a.index,r=a.$implicit,c=e.XpG(2);e.Y8G("formGroupName",o),e.R7$(1),e.Y8G("collapsedHeight",c.customCollapsedHeight)("expandedHeight",c.customExpandedHeight),e.R7$(4),e.SpI(" ",e.i5U(6,28,t.startTime,c.reservationOptions.dateFormat)," "),e.R7$(4),e.SpI(" ",e.i5U(10,31,t.startTime,c.getTimeFormat())," "),e.R7$(4),e.SpI(" ",t.courseNameIncludeCrossOver," "),e.R7$(3),e.Lme("",t.holes," ",e.bMT(17,34,"teetime.holes")," "),e.R7$(4),e.Lme(" ",t.numberOfPlayer," ",e.bMT(21,36,"player.players")," "),e.R7$(7),e.SpI(" ",e.bMT(28,38,"reservation.details")," "),e.R7$(5),e.SpI("",e.bMT(33,40,"date.date"),":"),e.R7$(3),e.JRh(e.i5U(36,42,t.startTime,c.reservationOptions.dateFormat)),e.R7$(4),e.SpI("",e.bMT(40,45,"course.course"),":"),e.R7$(3),e.SpI(" ",t.courseNameIncludeCrossOver,""),e.R7$(3),e.SpI("",e.bMT(46,47,"player.players"),":"),e.R7$(3),e.SpI(" ",t.numberOfPlayer,""),e.R7$(3),e.SpI("",e.bMT(52,49,"date.time"),":"),e.R7$(3),e.SpI(" ",e.i5U(55,51,t.startTime,c.getTimeFormat())," "),e.R7$(4),e.SpI("",e.bMT(59,54,"teetime.holes"),":"),e.R7$(3),e.SpI(" ",t.holes,""),e.R7$(3),e.SpI("",e.bMT(65,56,"reservation.confirmKey"),":"),e.R7$(3),e.SpI(" ",t.reservationConfirmKey,""),e.R7$(3),e.Y8G("ngIf",!r.get("isEditReservation")||!r.get("isEditReservation").value)("ngIfElse",i),e.R7$(3),e.Y8G("ngIf",-1===r.controls.editedParticipantNo.value),e.R7$(1),e.Y8G("ngIf",c.blockNonOwnerEdit(t)),e.R7$(1),e.Y8G("ngIf",c.blockNoRefundDeposit(t))}}function xa(n,s){if(1&n&&(e.j41(0,"mat-accordion"),e.DNE(1,ka,76,58,"mat-expansion-panel",6),e.k0s()),2&n){const t=s.$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("ngIf",i.getReservation(t))}}function Ma(n,s){if(1&n&&(e.j41(0,"div",4),e.DNE(1,xa,2,1,"mat-accordion",5),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.form.get("upcomingReservations").controls)("ngForTrackBy",t.trackByUpcomingReservation)}}function Fa(n,s){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"div",72)(2,"button",73),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return a.onClickShowMoreReservations(a.upcomingReservationsCurrentPage)}),e.EFF(3,"Show More Reservations"),e.k0s()(),e.bVm()}}function Ta(n,s){if(1&n&&(e.j41(0,"mat-option",81),e.EFF(1),e.k0s()),2&n){const t=s.$implicit,i=e.XpG(2);e.Y8G("value",t.oldText),e.R7$(1),e.SpI(" ",i.getTranslationText(t.key,t.value)," ")}}function Oa(n,s){1&n&&(e.j41(0,"mat-list-item")(1,"small"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&n&&(e.R7$(2),e.JRh(e.bMT(3,1,"reservation.noReservations")))}function Ea(n,s){1&n&&(e.j41(0,"mat-list-item")(1,"small"),e.EFF(2),e.nI1(3,"translate"),e.k0s()()),2&n&&(e.R7$(2),e.SpI("",e.bMT(3,1,"loading.loading"),"..."))}function Na(n,s){if(1&n&&(e.j41(0,"mat-list"),e.DNE(1,Oa,4,3,"mat-list-item",1),e.DNE(2,Ea,4,3,"mat-list-item",26),e.k0s()),2&n){e.XpG();const t=e.sdS(17),i=e.XpG();e.R7$(1),e.Y8G("ngIf",!i.isLoadingPastReservations&&0===i.pastReservations.length),e.R7$(1),e.Y8G("ngIf",i.isLoadingPastReservations)("ngIfElse",t)}}function $a(n,s){1&n&&(e.j41(0,"th"),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"booking.groupBooking")," "))}function Sa(n,s){if(1&n&&(e.j41(0,"td")(1,"span"),e.EFF(2),e.nI1(3,"date"),e.k0s(),e.j41(4,"span",33),e.EFF(5),e.nI1(6,"translate"),e.k0s()()),2&n){const t=e.XpG(2).$implicit,i=e.XpG(3);e.R7$(2),e.JRh(e.i5U(3,3,t.startTime,i.getTimeFormat())),e.R7$(3),e.Lme("",e.bMT(6,6,"reservation.group")," ",t.groupNo,"")}}function Da(n,s){if(1&n&&(e.j41(0,"tr",32)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.DNE(5,Sa,7,8,"td",1),e.k0s()),2&n){const t=s.$implicit,i=s.odd,a=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(4,Ct,i)),e.R7$(2),e.JRh(t.fullName),e.R7$(2),e.JRh(t.email),e.R7$(1),e.Y8G("ngIf",a.groupNo>0)}}function wa(n,s){if(1&n&&(e.j41(0,"mat-accordion")(1,"mat-expansion-panel",84)(2,"mat-expansion-panel-header",8)(3,"mat-panel-title")(4,"div",9)(5,"div",10),e.EFF(6),e.nI1(7,"formatDateLocale"),e.k0s(),e.j41(8,"div",11)(9,"small"),e.EFF(10),e.nI1(11,"date"),e.k0s()()(),e.j41(12,"div",12)(13,"div",13),e.EFF(14),e.k0s(),e.j41(15,"div",14)(16,"small"),e.EFF(17),e.nI1(18,"translate"),e.k0s(),e.EFF(19," | "),e.j41(20,"small",15),e.EFF(21),e.nI1(22,"translate"),e.k0s()()(),e.j41(23,"div",16)(24,"mat-icon"),e.EFF(25,"expand_more"),e.k0s()()()(),e.j41(26,"div",17)(27,"div",18),e.EFF(28),e.nI1(29,"translate"),e.k0s(),e.j41(30,"div",19)(31,"div",20)(32,"label"),e.EFF(33),e.nI1(34,"translate"),e.k0s(),e.j41(35,"span"),e.EFF(36),e.nI1(37,"formatDateLocale"),e.k0s()(),e.j41(38,"div",21)(39,"label"),e.EFF(40),e.nI1(41,"translate"),e.k0s(),e.j41(42,"span"),e.EFF(43),e.k0s()(),e.j41(44,"div",85)(45,"label"),e.EFF(46),e.nI1(47,"translate"),e.k0s(),e.j41(48,"span"),e.EFF(49),e.k0s()(),e.j41(50,"div",20)(51,"label"),e.EFF(52),e.nI1(53,"translate"),e.k0s(),e.j41(54,"span"),e.EFF(55),e.nI1(56,"date"),e.k0s()(),e.j41(57,"div",21)(58,"label"),e.EFF(59),e.nI1(60,"translate"),e.k0s(),e.j41(61,"span"),e.EFF(62),e.k0s()(),e.j41(63,"div",24)(64,"label"),e.EFF(65),e.nI1(66,"translate"),e.k0s(),e.j41(67,"span"),e.EFF(68),e.k0s()()()(),e.j41(69,"table")(70,"tr")(71,"th"),e.EFF(72),e.nI1(73,"translate"),e.k0s(),e.j41(74,"th"),e.EFF(75),e.nI1(76,"translate"),e.k0s(),e.DNE(77,$a,3,3,"th",1),e.k0s(),e.j41(78,"tr"),e.nrm(79,"td",30),e.k0s(),e.DNE(80,Da,6,6,"tr",31),e.k0s()()()),2&n){const t=s.$implicit,i=e.XpG(3);e.R7$(2),e.Y8G("collapsedHeight",i.customCollapsedHeight)("expandedHeight",i.customExpandedHeight),e.R7$(4),e.SpI(" ",e.i5U(7,26,t.startTime,i.reservationOptions.dateFormat)," "),e.R7$(4),e.SpI(" ",e.i5U(11,29,t.startTime,i.getTimeFormat())," "),e.R7$(4),e.SpI(" ",t.courseNameIncludeCrossOver," "),e.R7$(3),e.Lme("",t.holes," ",e.bMT(18,32,"teetime.holes")," "),e.R7$(4),e.Lme(" ",t.numberOfPlayer," ",e.bMT(22,34,"player.players")," "),e.R7$(7),e.SpI(" ",e.bMT(29,36,"reservation.details")," "),e.R7$(5),e.SpI("",e.bMT(34,38,"date.date"),":"),e.R7$(3),e.JRh(e.i5U(37,40,t.startTime,i.reservationOptions.dateFormat)),e.R7$(4),e.SpI("",e.bMT(41,43,"course.course"),":"),e.R7$(3),e.SpI(" ",t.courseNameIncludeCrossOver,""),e.R7$(3),e.SpI("",e.bMT(47,45,"player.players"),":"),e.R7$(3),e.SpI(" ",t.numberOfPlayer,""),e.R7$(3),e.SpI("",e.bMT(53,47,"date.time"),":"),e.R7$(3),e.SpI(" ",e.i5U(56,49,t.startTime,i.getTimeFormat())," "),e.R7$(4),e.SpI("",e.bMT(60,52,"teetime.holes"),":"),e.R7$(3),e.SpI(" ",t.holes,""),e.R7$(3),e.SpI("",e.bMT(66,54,"reservation.confirmKey"),":"),e.R7$(3),e.SpI(" ",t.reservationConfirmKey,""),e.R7$(4),e.JRh(e.bMT(73,56,"player.player")),e.R7$(3),e.JRh(e.bMT(76,58,"email.email")),e.R7$(2),e.Y8G("ngIf",t.groupNo>0),e.R7$(3),e.Y8G("ngForOf",t.reservationDetail)}}function ja(n,s){if(1&n&&(e.j41(0,"div",82),e.DNE(1,wa,81,60,"mat-accordion",83),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.pastReservations)}}function Ga(n,s){if(1&n){const t=e.RV6();e.qex(0),e.j41(1,"mat-card-header",74)(2,"div",75)(3,"div",76)(4,"mat-card-title"),e.EFF(5),e.nI1(6,"translate"),e.k0s()(),e.j41(7,"div",77)(8,"mat-form-field")(9,"mat-label"),e.EFF(10),e.nI1(11,"translate"),e.k0s(),e.j41(12,"mat-select",78),e.bIt("ngModelChange",function(a){return e.eBV(t),e.XpG().filter=a})("selectionChange",function(){e.eBV(t);const a=e.XpG();return a.onChangePastReservationFilter(a.filter)}),e.DNE(13,Ta,2,2,"mat-option",79),e.k0s()()()()(),e.j41(14,"mat-card-content"),e.DNE(15,Na,3,3,"mat-list",1),e.DNE(16,ja,2,1,"ng-template",null,80,e.C5r),e.k0s(),e.bVm()}if(2&n){const t=e.XpG();e.R7$(5),e.SpI(" ",e.bMT(6,5,"reservation.pastReservations")," "),e.R7$(5),e.JRh(e.bMT(11,7,"date.dateRange")),e.R7$(2),e.Y8G("ngModel",t.filter),e.R7$(1),e.Y8G("ngForOf",t.years),e.R7$(2),e.Y8G("ngIf",t.isShowPastReservations)}}let Pt=(()=>{class n{constructor(t,i,a,o,r){this.store=t,this.dialog=i,this.snackBar=a,this.cdr=o,this.translate=r,this.isUniquePlayers=!1,this.unsubscribe=new Ae.B,this.changeYear=new e.bkB,this.cancelBooking=new e.bkB,this.years=[{key:"date.pastDays",value:{day:30},oldText:"Past 30 Days"},{key:"date.pastMonths",value:{month:6},oldText:"Past 6 Months"},{key:"date.pastMonths",value:{month:12},oldText:"Past 12 Months"}],this.panelOpenState=!1,this.customCollapsedHeight="80px",this.customExpandedHeight="80px",this.currentPlayer$=this.store.pipe((0,p.Lt)(Se)),this.TimeDisplayType=Me.S,this.isShowPastReservations=!1}get upcomingReservations(){return this._upcomingReservations}set upcomingReservations(t){this._upcomingReservations=t,t&&t.length>0&&this.patchObjectToForm()}get availablePastReservationYears(){return this._availablePastReservationYears}set availablePastReservationYears(t){this._availablePastReservationYears=t}get isLoadingUpcomingReservations(){return this._isLoadingUpcomingReservations}set isLoadingUpcomingReservations(t){this._isLoadingUpcomingReservations=t,t||this.patchObjectToForm()}ngOnInit(){this.initForm(),(0,It.z)([this.store.pipe((0,p.Lt)(at)),this.store.pipe((0,p.Lt)(st))]).pipe((0,V.Q)(this.unsubscribe),(0,I.T)(([t,i])=>{this.upcomingReservationsCurrentPage=t,this.upcomingReservationsTotalPages=i})).subscribe(),this.store.pipe((0,V.Q)(this.unsubscribe),(0,p.Lt)(rt)).subscribe(t=>this.isUniquePlayers=t),this.store.pipe((0,V.Q)(this.unsubscribe),(0,p.Lt)(F.wz),(0,ne.p)(t=>null!==t),(0,H.M)(t=>{this.store.dispatch(new he.fJ(t.golferId,t.sub,t.dependent_id)),this.store.dispatch(new d.RZ(t.golferId))})).subscribe(),this.store.pipe((0,V.Q)(this.unsubscribe),(0,p.Lt)(De),(0,ge.c)(50)).subscribe(t=>{if(t.isSuccess&&t.reservationId>0&&t.teesheetId>0){this.store.dispatch(new d.Dx({reservationId:t.reservationId,teesheetId:t.teesheetId}));const i=this.form.get("upcomingReservations");if(i&&i.length>0){const a=i.controls.findIndex(o=>o.value.reservationId===t.reservationId&&o.value.teesheetId===t.teesheetId);a>-1&&(this.rePatchBookingsToForm(i.at(a),t.reservationId,t.teesheetId),this._markFormPristine(i.at(a)),this.cdr.detectChanges())}this.snackBar.open(`${this.translate.instant("form.updateSuccessful")}!`,"",{duration:3e3})}}),this.store.pipe((0,V.Q)(this.unsubscribe),(0,p.Lt)(we)).subscribe(t=>{t.isSuccess&&t.reservationId>0&&t.teesheetId>0&&(this.store.dispatch(new d.Dx({reservationId:t.reservationId,teesheetId:t.teesheetId})),this.snackBar.open(`${this.translate.instant("form.cancelSuccessful")}!`,"",{duration:3e3}))}),this.store.pipe((0,V.Q)(this.unsubscribe),(0,p.Lt)($e),(0,ge.c)(50)).subscribe(t=>{if(t){const i=this.form.get("upcomingReservations");if(i&&i.length>0){const a=i.controls.findIndex(o=>o.value.reservationId===t.reservationId&&o.value.teesheetId===t.teesheetId);if(a>-1){const o=i.at(a),r=o.get("reservationDetails"),c=r.controls.findIndex(h=>h.value.participantNo===t.participantNo);c>-1&&(r.at(c).patchValue({firstName:t.firstName,lastName:t.lastName,fullName:`${t.firstName} ${t.lastName}`,email:t.email}),o.patchValue({editedPlayerIndex:-1,editedParticipantNo:-1,isEditedPlayerDirty:!1}),o.markAsDirty(),this.onClosePlayerComponent({reservationId:t.reservationId,teesheetId:t.teesheetId}))}}}})}ngOnDestroy(){this.unsubscribe.next(),this.unsubscribe.complete()}initForm(){this.form=new m.gE({upcomingReservations:new m.Yp([])})}patchObjectToForm(){!this.form||(this.frmArrayUpcomingReservation=this.form.get("upcomingReservations"),this.frmArrayUpcomingReservation&&this.frmArrayUpcomingReservation.reset(),this.upcomingReservations&&this.upcomingReservations.forEach(t=>{t&&this.frmArrayUpcomingReservation.push(this.createUpcomingReservation(t))}))}createUpcomingReservation(t){const i=new m.gE({reservationId:new m.MJ(""),teesheetId:new m.MJ(""),numberOfPlayer:new m.MJ(""),maxNumberOfPlayer:new m.MJ(""),minNumberOfPlayer:new m.MJ(""),isEditReservation:new m.MJ(""),editedPlayerIndex:new m.MJ(""),editedParticipantNo:new m.MJ(""),isEditedPlayerDirty:new m.MJ(""),reservationDetails:new m.Yp([]),courseId:new m.MJ(null)});i.patchValue({reservationId:t.reservationId,teesheetId:t.teeSheetId,numberOfPlayer:t.numberOfPlayer,maxNumberOfPlayer:Math.min(t.maxNumberOfPlayer,this.reservationOptions.maxPlayerPerTeeTime),minNumberOfPlayer:t.minNumberOfPlayer,isEditReservation:!1,editedPlayerIndex:-1,editedParticipantNo:-1,isEditedPlayerDirty:!1,courseId:t.courseId});const a=this.myGolferId===t.reservationDetail[0].golferId,o=this.myGolferId===t.ownerGolferId;let r=0;return t.reservationDetail.forEach(c=>{const h=this.myGolferId===c.golferId;this.frmArrayReservationDetails=i.get("reservationDetails"),this.frmArrayReservationDetails.push(this.createReservationDetail(c,Math.min(t.maxNumberOfPlayer,this.reservationOptions.maxPlayerPerTeeTime),t.numberOfPlayer,a,h,o,r,t.courseId,t)),r++}),i}createReservationDetail(t,i,a,o,r,c,h,b,C){var R;const M=new m.gE({isAddCart:new m.MJ(""),firstName:new m.MJ(""),lastName:new m.MJ(""),fullName:new m.MJ(""),email:new m.MJ("",[m.k0.email,m.k0.pattern(gt.R.Email)]),participantNo:new m.MJ(""),isCanEdit:new m.MJ(""),isCanEditRider:new m.MJ(""),isShowRemovePlayer:new m.MJ(""),isShowAddPlayer:new m.MJ("")});return M.patchValue({isAddCart:t.cartType!==K.T.None,firstName:t.firstName,lastName:t.lastName,fullName:t.fullName,email:t.email,participantNo:t.participantNo,isCanEdit:this.isCanEdit(r,c,h,null!==(R=C.groupNo)&&void 0!==R?R:0),isCanEditRider:this.isCanEditRider(c,r,b,t.cartType),isShowRemovePlayer:this.isShowRemovePlayer(r,C,a,c),isShowAddPlayer:this.isShowAddPlayer(i,a,c,h)}),M}getEditedIndex(t){return t.get("editedPlayerIndex").value}getReservation(t){const i=t.get("reservationId")?t.get("reservationId").value:0,a=t.get("teesheetId")?t.get("teesheetId").value:0;return this.upcomingReservations.filter(o=>o.reservationId===i&&o.teeSheetId===a)?this.upcomingReservations.filter(o=>o.reservationId===i&&o.teeSheetId===a)[0]:this.upcomingReservations[0]}isCanEdit(t,i,a,o){return 0===a&&i?o>1:i||t}isCanEditRider(t,i,a,o=K.T.None){if(!this.courseOptions||0===this.courseOptions.length)return!1;let r=!1;const c=this.courseOptions.find(h=>h.courseId===a);return c&&(c.fullCartSelectionType===J.M.AllowCartSelection||c.fullCartSelectionType===J.M.ForceCartSelection&&o===K.T.None)&&(r=!0),r&&(t||i)}isShowRemovePlayer(t,i,a,o){let r=o||t;if(r){const c=[];i.isNotAllowThreesomeBooking&&c.push(3),i.isNotAllowTwosomeBooking&&c.push(2),i.isNotAllowSingleBooking&&c.push(1),r=!c.includes(a-1)}return r}isShowAddPlayer(t,i,a,o){return i===o+1&&i<t&&a}visibleCancelationBookingButton(t){var i;if(t.totalCheckInCells>0||!this.reservationOptions.enableOnlineTeeTimeCancel||!t.ownerGolferId||0===t.reservationDetail.length)return!1;const a=null!==(i=t.groupNo)&&void 0!==i?i:0,o=t.ownerGolferId===this.myGolferId,r=t.reservationDetail[0].golferId===this.myGolferId;if(this.reservationOptions.notAllowBuddyEditReservation&&!o||a<=1&&(!o||!r)||a>1&&!o&&r||!this.reservationOptions.allowRefundDepositToCreditCard&&t.depositId>0&&!this.reservationOptions.enableOnlineTeeTimeCancel)return!1;if(this.reservationOptions.doNotAllowTeeTimeCancel){const c=new Date,h=new Date(t.startTime.toString());return h.setHours(h.getHours()-this.reservationOptions.doNotAllowTeeTimeCancelHours),c<h}return!0}visibleEditBookingButton(t){if(t.totalCheckInCells>0||!this.reservationOptions.allowChangeReservation||this.blockNoRefundDeposit(t)||this.blockNonOwnerEdit(t))return!1;if(this.reservationOptions.allowChangeReservationBefore){const i=new Date,a=new Date(t.startTime.toString());return a.setHours(a.getHours()-this.reservationOptions.hourForChangeReservationBefore),i<a}return!0}blockNoRefundDeposit(t){return!this.reservationOptions.allowRefundDepositToCreditCard&&t.depositId>0&&!this.reservationOptions.allowChangeReservation}blockNonOwnerEdit(t){return!(!(this.reservationOptions.allowRefundDepositToCreditCard&&t.depositId>0)||t.ownerGolferId&&t.ownerGolferId===this.myGolferId)||!(!this.reservationOptions.notAllowBuddyEditReservation||t.ownerGolferId&&t.ownerGolferId===this.myGolferId)}onChangePastReservationFilter(t){if(isNaN(+t)){this.isShowPastReservations=!0;const i=new Date;t.includes("30 Days")?i.setDate(i.getDate()-30):t.includes("6 Months")?i.setMonth(i.getMonth()-6):i.setMonth(i.getMonth()-12),this.changeYear.emit({date:i})}else this.changeYear.emit({year:+t})}onClickEditReservation(t){const i=t.get("reservationId").value,a=t.get("teesheetId").value;t.patchValue({isEditReservation:!0}),this.store.dispatch(new d.n3(this.upcomingReservations.filter(o=>o.reservationId===i&&o.teeSheetId===a)[0]))}onSaveChange(t){if(t.valid)if(t.dirty){const i=t.get("reservationId").value,a=t.get("teesheetId").value,o=t.get("numberOfPlayer").value;if(i>0){const r=this.upcomingReservations.filter(c=>c.reservationId===i&&c.teeSheetId===a)[0];if(this.reservationOptions.forceUniquePlayer&&!this.isUniquePlayers)return void this.store.dispatch(new je.w9({header:this.translate.instant("player.invalidPlayerSelection"),details:`${this.translate.instant("player.allPlayersNeedToBeUnique")}.\n\n${this.translate.instant("player.requestSelectUniquePlayers")}.`}));r.isNotAllowSingleBooking&&1===o?this.openWarningDialog(`${this.translate.instant("reservation.singleNotAllowedToBook")}.`):r.isNotAllowTwosomeBooking&&2===o?this.openWarningDialog(`${this.translate.instant("reservation.twosomesNotAllowedToBook")}.`):r.auctionId>0&&r.auctionType!==re.Y.DynamicPrice&&r.groupNo>0?this.openWarningDialog(`${this.translate.instant("reservation.teetimeOnlyAllowsCertainNumberPlayers")}.`):r.auctionId>0&&(r.auctionType===re.Y.Discount||r.auctionType===re.Y.SpecialPrice)&&0===r.groupNo&&o<r.auctionMinGolfer?this.openWarningDialog(`${this.translate.instant("reservation.teetimeMinimumPlayer",{minGolfer:r.auctionMinGolfer})}. ${this.translate.instant("reservation.reviewYourChanges")}.`):this.store.dispatch(o===r.numberOfPlayer?new d.Rp({reservationId:i,teesheetId:a,isForfeitDeposit:!1}):new d.SJ({reservationId:i,teesheetId:a}))}}else this.onClickDiscardChannges(t)}onClickCancelBooking(t){this.cancelBooking.emit(t)}onClickDiscardChannges(t){!t.valid||t.dirty?this.dialog.open(se.B,{data:{header:this.translate.instant("form.confirmation"),body:`${this.translate.instant("dialog.requestDiscardChanges")}?`,result:!0},hasBackdrop:!0}).afterClosed().subscribe(a=>{console.log(`${this.translate.instant("dialog.dialogResult")}: ${a}`),a&&(this.discardReservationChanges(t),this.cdr.detectChanges())}):this.discardReservationChanges(t)}discardReservationChanges(t){const i=t.get("reservationId").value,a=t.get("teesheetId").value;this.store.dispatch(new d.Dx({reservationId:i,teesheetId:a})),this.rePatchBookingsToForm(t,i,a)}rePatchBookingsToForm(t,i,a){const o=t.get("reservationDetails");this.clearFormArray(o);let r=0;const c=this.upcomingReservations.filter(R=>R.reservationId===i&&R.teeSheetId===a);if(0===c.length)return;const h=c[0],b=this.myGolferId===h.reservationDetail[0].golferId,C=this.myGolferId===h.ownerGolferId;null!==h&&(h.reservationDetail.forEach(R=>{const M=this.myGolferId===R.golferId;o.push(this.createReservationDetail(R,Math.min(h.maxNumberOfPlayer,this.reservationOptions.maxPlayerPerTeeTime),h.numberOfPlayer,b,M,C,r,h.courseId,h)),r++}),t.patchValue({numberOfPlayer:h.numberOfPlayer,editedPlayerIndex:-1,editedParticipantNo:-1,isEditReservation:!1,isEditedPlayerDirty:!1,courseId:h.courseId}),this._markFormPristine(t))}onClickAddPlayer(t,i){const a=t.get("reservationId").value,o=t.get("teesheetId").value,r=this.upcomingReservations.filter(b=>b.reservationId===a&&b.teeSheetId===o)[0],c=this.myGolferId===r.reservationDetail[0].golferId,h=this.myGolferId===r.ownerGolferId;this.frmArrayReservationDetails=t.get("reservationDetails"),this.store.dispatch(new d.vz({reservationId:a,teesheetId:o})),this.store.pipe((0,p.Lt)(ke),(0,fe.s)(1)).subscribe(b=>{if(b){const C=b.reservationDetail[b.reservationDetail.length-1],R=b.numberOfPlayer;t.patchValue({numberOfPlayer:R}),this.frmArrayReservationDetails.push(this.createReservationDetail(C,t.get("maxNumberOfPlayer").value,R,c,h,!1,i+1,b.courseId,b)),this.frmArrayReservationDetails.at(i).patchValue({isShowAddPlayer:!1}),t.markAsDirty()}})}isHideRider(t){if(!this.courseOptions||0===this.courseOptions.length)return!0;const i=this.courseOptions.find(a=>a.courseId===t);return!i||i.fullCartSelectionType===J.M.DoNotOfferCarts}onClickEditPlayer(t,i,a,o){var r;if(!a)return;const c=t.get("reservationId").value,h=t.get("teesheetId").value,b=i.get("participantNo").value,C=this.upcomingReservations.filter(u=>u.reservationId===c&&u.teeSheetId===h);if(0===C.length)return;const R=C[0],M=this.myGolferId===R.ownerGolferId;this.dialog.open(Le,{data:{reservationId:c,teesheetId:h,participantNo:b,player:i,courseId:R.courseId,isHideRider:this.isHideRider(R.courseId),isCartRestrict:R.isCartRestrict,isCanEditRider:this.isCanEditRider(M,!0,R.courseId,null===(r=R.reservationDetail[o])||void 0===r?void 0:r.cartType),allowedRemovePlayer:t.get("reservationDetails").value.length>R.minNumberOfPlayer,reservationOptions:this.reservationOptions,reservationDetail:R.reservationDetail[o]},hasBackdrop:!0,width:"30vw",minWidth:"450px"}).afterClosed().subscribe(u=>{var v,f;const y=u;if(!y)return;y.isSelectBuddy&&this.store.dispatch(new d.rF({reservationId:c,teesheetId:h,participantNo:b,buddy:u}));const P=this.form.get("upcomingReservations");if(P&&P.length>0){const k=P.controls.findIndex(O=>O.value.reservationId===c&&O.value.teesheetId===h);if(k>-1){const O=P.at(k),S=O.get("reservationDetails"),N=S.controls.findIndex($=>$.value.participantNo===b),W=O.get("numberOfPlayer").value-1;N>-1&&(y.isRemovePlayer?(S.removeAt(N),S.at(W-1).patchValue({isShowAddPlayer:!0}),O.patchValue({numberOfPlayer:W,editedPlayerIndex:-1,editedParticipantNo:-1,isEditedPlayerDirty:!1})):(y.isSelectBuddy||y.isWriteIn)&&i.patchValue({firstName:y.firstName,lastName:y.lastName,fullName:`${y.firstName} ${y.lastName}`,email:y.email,participantNo:b,isCanEdit:this.isCanEdit(!0,M,N,null!==(v=R.groupNo)&&void 0!==v?v:0),isCanEditRider:this.isCanEditRider(M,!0,R.courseId,null===(f=R.reservationDetail[N])||void 0===f?void 0:f.cartType),isShowRemovePlayer:this.isShowRemovePlayer(!0,R,R.numberOfPlayer,M),isShowAddPlayer:this.isShowAddPlayer(R.maxNumberOfPlayer,P.length,M,N),isAddCart:y.isAddCart}),O.markAsDirty(),this.cdr.detectChanges())}}})}onClickRemovePlayer(t,i,a){!i.valid&&i.dirty?this.dialog.open(se.B,{data:{header:this.translate.instant("form.confirmation"),body:`${this.translate.instant("dialog.requestDiscardChanges")}?`,result:!0},hasBackdrop:!0}).afterClosed().subscribe(r=>{console.log(`${this.translate.instant("dialog.dialogResult")}: ${r}`),r&&(this.removePlayerTemp(t,i,a),this.cdr.detectChanges())}):this.removePlayerTemp(t,i,a)}removePlayerTemp(t,i,a){const o=t.get("reservationId").value,r=t.get("teesheetId").value,c=i.get("participantNo").value,h=this.upcomingReservations.filter(C=>C.reservationId===o&&C.teeSheetId===r)[0],b=this.myGolferId===h.reservationDetail[0].golferId;if(this.frmArrayReservationDetails=t.get("reservationDetails"),this.frmArrayReservationDetails){this.store.dispatch(new d.qm({reservationId:o,teesheetId:r,participantNo:c})),this.frmArrayReservationDetails.removeAt(a);const C=t.get("numberOfPlayer").value-1;this.frmArrayReservationDetails.at(C-1).patchValue({isShowAddPlayer:b}),t.patchValue({numberOfPlayer:C,editedPlayerIndex:-1,editedParticipantNo:-1,isEditedPlayerDirty:!1}),t.markAsDirty()}}onClickEditPlayerName(t,i,a,o){t.get("isEditedPlayerDirty").value?this.dialog.open(se.B,{data:{header:this.translate.instant("form.confirmation"),body:`${this.translate.instant("dialog.requestDiscardPlayerChanges")}?`,result:!0},hasBackdrop:!0}).afterClosed().subscribe(h=>{console.log(`${this.translate.instant("dialog.dialogResult")}: ${h}`),h&&this.patchPlayerNameToForm(t,i,a,o)}):this.patchPlayerNameToForm(t,i,a,o)}patchPlayerNameToForm(t,i,a,o){if(a){const r=i.get("participantNo").value;t.patchValue({editedPlayerIndex:o,editedParticipantNo:r,isEditedPlayerDirty:!1})}}onCheckChangedCart(t,i,a){const o=t.get("reservationId").value,r=t.get("teesheetId").value,c=i.get("participantNo").value,h=t.get("courseId").value;this.store.dispatch(new d.ph({reservationId:o,teesheetId:r,participantNo:c,cartType:null,courseId:h,isAddCart:a}))}onClosePlayerComponent(t){this.cdr.detectChanges(),this.store.dispatch(new d.c1({reservationId:t.reservationId,teesheetId:t.teesheetId}))}onFocusOutEmail(t,i){const a=t.get("reservationId").value,o=t.get("teesheetId").value,r=i.get("participantNo").value,c=i.get("email").value;a>0&&r>0&&this.store.dispatch(new d.pZ({reservationId:a,teesheetId:o,participantNo:r,email:c}))}openWarningDialog(t){return this.dialog.open(ue.z,{data:{header:this.translate.instant("dialog.information"),details:t},hasBackdrop:!0}).afterClosed()}clearFormArray(t){for(;0!==t.length;)t.removeAt(0)}_markFormPristine(t){Object.keys(t.controls).forEach(i=>{t.controls[i].markAsPristine()})}getTimeFormat(){return this.reservationOptions.timeDisplay===Me.S.Hours12?"shortTime":"HH:mm"}getTranslationText(t,i){return this.translate.instant(t,i)}onClickShowMoreReservations(t){this.store.dispatch(new d.H({currentPage:t+1}))}trackByUpcomingReservation(t,i){return`${i.value.reservationId}${i.value.teesheetId}`}isHideAllRemovePlayer(t){var i;const a=null==t?void 0:t.get("reservationDetails");return null===(i=null==a?void 0:a.controls)||void 0===i?void 0:i.every(o=>!o.get("isShowRemovePlayer").value)}isShowRemoveIcon(t,i,a){var o,r,c;const h=t.get("reservationId").value,b=t.get("teesheetId").value,C=this.upcomingReservations.filter(M=>M.reservationId===h&&M.teeSheetId===b);if(0===C.length)return!1;const R=C[0];return(null==t?void 0:t.controls.editedParticipantNo.value)<=-1&&(null==i?void 0:i.controls.isShowRemovePlayer.value)&&(null===(o=null==t?void 0:t.get("reservationDetails").value)||void 0===o?void 0:o.length)>(null===(r=null==t?void 0:t.controls.minNumberOfPlayer)||void 0===r?void 0:r.value)&&0===(null!==(c=null==R?void 0:R.groupNo)&&void 0!==c?c:0)&&a>0}}return n.\u0275fac=function(t){return new(t||n)(e.rXU(p.il),e.rXU(U.bZ),e.rXU(Ye.UG),e.rXU(e.gRc),e.rXU(G.c$))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-reservation"]],inputs:{upcomingReservations:"upcomingReservations",pastReservations:"pastReservations",courseOptions:"courseOptions",availablePastReservationYears:"availablePastReservationYears",isLoadingUpcomingReservations:"isLoadingUpcomingReservations",isLoadingPastReservations:"isLoadingPastReservations",reservationOptions:"reservationOptions",myGolferId:"myGolferId"},outputs:{changeYear:"changeYear",cancelBooking:"cancelBooking"},decls:13,vars:9,consts:[[1,"container"],[4,"ngIf"],[3,"formGroup"],["class","section","formArrayName","upcomingReservations",4,"ngIf"],["formArrayName","upcomingReservations",1,"section"],[4,"ngFor","ngForOf","ngForTrackBy"],["hideToggle","",3,"formGroupName",4,"ngIf"],["hideToggle","",3,"formGroupName"],[3,"collapsedHeight","expandedHeight"],["fxFlex","1 1 40%","fxLayout","column","fxLayoutWrap","","fxLayoutAlign","center"],["fxFlex","auto",1,"heading-small"],["fxFlex","auto"],["fxFlex","1 1 auto","fxLayout","column","fxLayoutWrap","","fxLayoutAlign","center"],["fxFlex","1 0 auto",1,"heading-small","blue","course-name"],["fxFlex","1 0 auto",1,"player-and-hole-info"],[1,"ml-1"],["fxFlex","30px",1,"expand-icon"],[1,"checkout-table"],[1,"checkout-header"],[1,"checkout-content"],[1,"item","border-right"],[1,"item","border-right","course-details"],[1,"item","player-details"],[1,"item","border-right","hole-details"],[1,"item"],["fxLayout","column"],[4,"ngIf","ngIfElse"],["edit",""],["fxLayout","row","fxLayoutGap","20px",4,"ngIf"],["class","div-info",4,"ngIf"],["colspan","3",1,"tblhr"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"group-no"],["formArrayName","reservationDetails"],[2,"width","50%"],[2,"width","35%"],[2,"width","5%"],[3,"ngStyle"],[2,"text-align","center"],["style","text-align: center;",4,"ngIf"],[3,"formGroupName",4,"ngFor","ngForOf"],[2,"width","10%"],[3,"formGroupName"],[1,"div-player-input"],[1,"player-name"],["matInput","","formControlName","fullName","readonly","",1,"input-text",3,"placeholder","click"],[1,"player-email"],["matInput","","formControlName","email","type","email",1,"input-text",3,"placeholder","readonly","focusout"],["class","icon",4,"ngIf"],[1,"modify-field"],["class","edit-player-button modify-player",3,"click",4,"ngIf"],["class","modify-field",4,"ngIf"],[3,"ngStyle",4,"ngIf"],[1,"icon"],[1,"edit-player-button","add-player",3,"click"],[1,"edit-player-button","modify-player",3,"click"],["formControlName","isAddCart",3,"disabled","change"],["colspan","2"],[3,"reservation","isAllowNewCustomer","isShowBuddy","playerIndex","currentPlayer","doNotAllowWriteInNames","groupNo","isDisplayStore","closePlayerComponent"],["fxLayout","row","fxLayoutGap","20px"],["mat-stroked-button","","class","edit-button",3,"click",4,"ngIf","ngIfElse"],["class","edit-button2","mat-stroked-button","","color","warn",3,"click",4,"ngIf"],["savechange",""],["mat-stroked-button","",1,"edit-button",3,"click"],["mat-stroked-button","","color","warn",1,"edit-button2",3,"click"],["class","edit-button","mat-stroked-button","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","class","edit-button3",3,"click",4,"ngIf"],["mat-stroked-button","","color","warn",1,"edit-button",3,"click"],["mat-raised-button","",1,"edit-button3",3,"click"],[1,"div-info"],[1,"text"],[2,"display","flex","justify-content","center","padding","1rem"],["mat-button","","color","primary",3,"click"],[1,"past-reservations"],["fxLayout","row","fxLayoutWrap","","fxLayoutAlign","center",1,"reservation-container"],["fxFlex","60%","fxFlexAlign","center"],["fxFlex","40%"],["color","accent",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["pastReservation",""],[3,"value"],[1,"section"],[4,"ngFor","ngForOf"],["hideToggle",""],[1,"item","course-details"]],template:function(t,i){1&t&&(e.j41(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),e.EFF(3),e.nI1(4,"translate"),e.k0s()(),e.j41(5,"mat-card-content")(6,"mat-list"),e.DNE(7,Ki,4,3,"mat-list-item",1),e.DNE(8,Zi,4,3,"mat-list-item",1),e.k0s(),e.j41(9,"form",2),e.DNE(10,Ma,2,2,"div",3),e.k0s(),e.DNE(11,Fa,4,0,"ng-container",1),e.k0s(),e.DNE(12,Ga,18,9,"ng-container",1),e.k0s()),2&t&&(e.R7$(3),e.JRh(e.bMT(4,7,"reservation.upcomingReservations")),e.R7$(4),e.Y8G("ngIf",!(i.isLoadingUpcomingReservations||i.upcomingReservations&&0!==i.upcomingReservations.length)),e.R7$(1),e.Y8G("ngIf",i.isLoadingUpcomingReservations&&(!i.upcomingReservations||0===i.upcomingReservations.length)),e.R7$(1),e.Y8G("formGroup",i.form),e.R7$(1),e.Y8G("ngIf",i.form.get("upcomingReservations")),e.R7$(1),e.Y8G("ngIf",i.upcomingReservationsCurrentPage<i.upcomingReservationsTotalPages),e.R7$(1),e.Y8G("ngIf",i.availablePastReservationYears&&i.availablePastReservationYears.length>0))},directives:[D.RN,D.MM,D.dh,D.m2,Z.jt,E.bT,Z.YE,m.qT,m.cb,m.j4,m.v8,E.Sq,A.BS,A.GK,m.$R,A.Z2,A.WN,w.UI,w.DJ,w.sA,_e.An,E.YU,Rt.PW,E.B3,Rt.eI,be.fg,m.me,m.BC,m.JD,z.TL,_t.So,Qi,w.BO,ce.$z,w.R$,z.rl,z.nJ,Ue.VO,m.vS,ye.wT],pipes:[G.D9,bt.m,E.vh,E.Jj],styles:["html[_ngcontent-%COMP%]{font-size:calc(60% + .8vmin)}.container[_ngcontent-%COMP%]{margin:20px auto;max-width:1170px;padding:20px}.reservation-container[_ngcontent-%COMP%]{width:100%}.reservation-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-block-start:.25em;margin-block-end:.25em}.reservation-container[_ngcontent-%COMP%]   .ml-1[_ngcontent-%COMP%]{margin-left:1rem}.mat-list[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]{height:72px}.past-reservations[_ngcontent-%COMP%]     mat-form-field .mat-form-field-wrapper{width:80%;float:right}table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%;margin-top:5px}table[_ngcontent-%COMP%], tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:none}th[_ngcontent-%COMP%]{text-align:left;padding-bottom:15px}td[_ngcontent-%COMP%]{padding:7px 7px 7px 0}td[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:10px}.group-no[_ngcontent-%COMP%]{color:var(--text-color2)}.tblhr[_ngcontent-%COMP%]{border-top:1px solid #e8e8e8;padding:5px 0}.mat-expanded[_ngcontent-%COMP%]{background-color:#dcdcdc}.edit-button[_ngcontent-%COMP%], .edit-button2[_ngcontent-%COMP%], .edit-button3[_ngcontent-%COMP%]{color:var(--primary-color);width:200px;padding:0;margin-top:10px;border-radius:6px}.edit-button2[_ngcontent-%COMP%]{font-style:italic}.edit-button3[_ngcontent-%COMP%]{background-color:var(--primary-color);color:#fff}.input-text[_ngcontent-%COMP%]{background-color:#fff;height:35px;padding:10px;border-radius:4pt;width:94%;border:1px solid #969696;box-shadow:0 5px 20px #0000000d;-webkit-box-shadow:0px 5px 20px rgba(0,0,0,.05)}.edit-player-button[_ngcontent-%COMP%]{font-size:1.688rem;display:inline-table}.modify-player[_ngcontent-%COMP%]{color:var(--secondary-color);cursor:pointer}.add-player[_ngcontent-%COMP%]{color:var(--primary-color);cursor:pointer}.div-player-input[_ngcontent-%COMP%]{display:flex;align-items:center}.div-player-input[_ngcontent-%COMP%]   .player-name[_ngcontent-%COMP%], .div-player-input[_ngcontent-%COMP%]   .player-email[_ngcontent-%COMP%]{flex:1 1 auto;-ms-flex:1 1 auto}.div-player-input[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{flex:0 0 20px;margin-left:10px}.div-info[_ngcontent-%COMP%]{border:1px solid gray;border-radius:11px;width:100%;margin-top:15px}.div-info[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:gray}.div-info[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:gray;font-style:italic;font-weight:lighter;text-align:center;padding:15px 30px;margin:-30px 0 0}.text[_ngcontent-%COMP%]{cursor:text}.checkout-table[_ngcontent-%COMP%]{margin:0}.checkout-header[_ngcontent-%COMP%]{padding:10px 0;font-weight:700;border-bottom:1px solid #e8e8e8}.checkout-content[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;margin-top:10px;column-gap:5px}.checkout-content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{flex:1 1 30%;display:flex;justify-content:space-between;padding:5px}.checkout-content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-right:10px;color:var(--text-color2)}.checkout-content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-right:10px;font-weight:700}.border-right[_ngcontent-%COMP%]{border-right:1px solid #e8e8e8}.section[_ngcontent-%COMP%]{display:flex;flex-direction:column}  .mat-expanded{background-color:#fff;margin-bottom:20px}.mat-expanded[_ngcontent-%COMP%]{background-color:#f3f5f8!important}.mat-expanded[_ngcontent-%COMP%]   .expand-icon[_ngcontent-%COMP%]{background-color:#fff}.mat-expansion-panel[_ngcontent-%COMP%]{margin-bottom:20px}.mat-accordion[_ngcontent-%COMP%]:last-child   .mat-expansion-panel[_ngcontent-%COMP%]{margin-bottom:0}.mat-expansion-panel-header-description[_ngcontent-%COMP%], .mat-expansion-panel-header-title[_ngcontent-%COMP%]{margin-right:0}.mat-expanded[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{transform:rotate(180deg)}.mat-expansion-panel-header-title[_ngcontent-%COMP%]   .open[_ngcontent-%COMP%], .mat-expanded[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{display:inline-block}.mat-expanded[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%]   .open[_ngcontent-%COMP%], .mat-expansion-panel-header-title[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{display:none}.expand-icon[_ngcontent-%COMP%]{display:flex;width:30px;height:30px;border-radius:50%;background-color:#e9ebed;justify-content:center;align-content:center}.expand-icon[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{justify-self:center;align-self:center}.mat-card[_ngcontent-%COMP%]   .mat-card-header[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]{margin-bottom:0;font-style:normal;font-weight:700;font-size:1.75rem}.modify-field[_ngcontent-%COMP%]{text-align:center;padding-right:0}@media screen and (max-width: 768px){.container[_ngcontent-%COMP%]{margin:0!important;padding:0!important}.mat-card[_ngcontent-%COMP%]   .mat-card-content[_ngcontent-%COMP%]{padding:0 10px!important}.mat-card[_ngcontent-%COMP%]   .mat-card-header[_ngcontent-%COMP%]{padding:10px!important}}"],changeDetection:0}),n})();function Ba(n,s){if(1&n){const t=e.RV6();e.j41(0,"app-reservation-mobile-v2",2),e.bIt("changeYear",function(a){return e.eBV(t),e.XpG().onChangeYear(a)})("cancelBooking",function(a){return e.eBV(t),e.XpG().onCancelBooking(a)}),e.nI1(1,"async"),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.nI1(5,"async"),e.nI1(6,"async"),e.nI1(7,"async"),e.nI1(8,"async"),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("isLoadingPastReservations",e.bMT(1,8,t.isLoadingPastReservations$))("myGolferId",e.bMT(2,10,t.golferId$))("isLoadingUpcomingReservations",e.bMT(3,12,t.isLoadingUpcomingReservations$))("upcomingReservations",e.bMT(4,14,t.upcomingReservations$))("pastReservations",e.bMT(5,16,t.pastReservations$))("availablePastReservationYears",e.bMT(6,18,t.availablePastReservationYears$))("courseOptions",e.bMT(7,20,t.courseOptions$))("reservationOptions",e.bMT(8,22,t.reservationOptions$))}}function Aa(n,s){if(1&n){const t=e.RV6();e.j41(0,"app-reservation",2),e.bIt("changeYear",function(a){return e.eBV(t),e.XpG().onChangeYear(a)})("cancelBooking",function(a){return e.eBV(t),e.XpG().onCancelBooking(a)}),e.nI1(1,"async"),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.nI1(5,"async"),e.nI1(6,"async"),e.nI1(7,"async"),e.nI1(8,"async"),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("isLoadingPastReservations",e.bMT(1,8,t.isLoadingPastReservations$))("myGolferId",e.bMT(2,10,t.golferId$))("isLoadingUpcomingReservations",e.bMT(3,12,t.isLoadingUpcomingReservations$))("upcomingReservations",e.bMT(4,14,t.upcomingReservations$))("pastReservations",e.bMT(5,16,t.pastReservations$))("availablePastReservationYears",e.bMT(6,18,t.availablePastReservationYears$))("courseOptions",e.bMT(7,20,t.courseOptions$))("reservationOptions",e.bMT(8,22,t.reservationOptions$))}}let kt=(()=>{class n{constructor(t,i,a){this.store=t,this.baseConfigurationService=i,this.titleService=a,this.isPageAlive=!0,this.upcomingReservations$=this.store.pipe((0,p.Lt)(it)),this.pastReservations$=this.store.pipe((0,p.Lt)(bn)),this.availablePastReservationYears$=this.store.pipe((0,p.Lt)(Rn)),this.isLoadingPastReservations$=this.store.pipe((0,p.Lt)(Pn)),this.isLoadingUpcomingReservations$=this.store.pipe((0,p.Lt)(Cn)),this.filter$=this.store.pipe((0,p.Lt)(kn)),this.golferId$=this.store.pipe((0,p.Lt)(F.ub)),this.reservationOptions$=this.store.pipe((0,p.Lt)(oe.N3)),this.courseOptions$=this.store.pipe((0,p.Lt)(oe.ei)),this.isMobile=!1,this.isMobile=this.baseConfigurationService.serverSettings.isMobile}ngOnInit(){this.reservationOptions$.pipe((0,ve.v)(()=>this.isPageAlive)).subscribe(t=>{t&&this.setPageTitle(t)}),this.store.dispatch(new d.xh),this.golferId$.pipe((0,ne.p)(t=>t>0),(0,H.M)(()=>{const t=new Date;t.setDate(t.getDate()-30),this.store.dispatch(new d.MB({date:t})),this.store.dispatch(new d.Ii),this.store.dispatch(new d.E2({currentPage:1}))})).subscribe()}onChangeYear(t){this.store.dispatch(new d.tN(t))}onCancelBooking(t){this.store.dispatch(new d._x(t))}setPageTitle(t){t.pageTitle&&this.titleService.setTitle(t.pageTitle)}}return n.\u0275fac=function(t){return new(t||n)(e.rXU(p.il),e.rXU(Pe.t),e.rXU(Bn.hE))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-my-reservation-page"]],decls:3,vars:2,consts:[[3,"isLoadingPastReservations","myGolferId","isLoadingUpcomingReservations","upcomingReservations","pastReservations","availablePastReservationYears","courseOptions","reservationOptions","changeYear","cancelBooking",4,"ngIf","ngIfElse"],["desktop",""],[3,"isLoadingPastReservations","myGolferId","isLoadingUpcomingReservations","upcomingReservations","pastReservations","availablePastReservationYears","courseOptions","reservationOptions","changeYear","cancelBooking"]],template:function(t,i){if(1&t&&(e.DNE(0,Ba,9,24,"app-reservation-mobile-v2",0),e.DNE(1,Aa,9,24,"ng-template",null,1,e.C5r)),2&t){const a=e.sdS(2);e.Y8G("ngIf",i.isMobile)("ngIfElse",a)}},directives:[E.bT,Vi,Pt],pipes:[E.Jj],encapsulation:2}),n})();var xt=g(12838),X=g(73987),La=g(85940),Ya=g(77233),Ua=g(37179),Va=g(51246),Xa=g(46501),Mt=g(34429),Ft=g(51773),Ha=g(17549),Ja=g(62049);function za(n,s){1&n&&(e.qex(0),e.EFF(1),e.nI1(2,"translate"),e.nrm(3,"br"),e.EFF(4),e.nI1(5,"translate"),e.bVm()),2&n&&(e.R7$(1),e.SpI(" ",e.bMT(2,2,"payment.teetimeQualifiesDepositCharge"),"."),e.R7$(3),e.SpI(" ",e.bMT(5,4,"payment.selectPaymentMethodSendCharge"),". "))}function Wa(n,s){1&n&&(e.EFF(0),e.nI1(1,"translate"),e.nrm(2,"br"),e.EFF(3),e.nI1(4,"translate")),2&n&&(e.SpI(" ",e.bMT(1,2,"payment.teetimeQualifiesDepositRefund"),"."),e.R7$(3),e.SpI(" ",e.bMT(4,4,"payment.selectPaymentMethodSendRefund"),". "))}function Qa(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",23)(1,"mat-icon",24),e.bIt("click",function(){return e.eBV(t),e.XpG(3).onClickRemovePaymentMethodAction()}),e.EFF(2,"delete"),e.k0s()()}}function Ka(n,s){if(1&n&&(e.j41(0,"div",21),e.DNE(1,Qa,3,0,"button",22),e.nI1(2,"async"),e.nI1(3,"async"),e.nI1(4,"async"),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf",e.bMT(2,1,t.creditCardInfo$)||e.bMT(3,3,t.cardOnFile$)||e.bMT(4,5,t.hostedToken$))}}function Za(n,s){if(1&n&&(e.j41(0,"mat-toolbar",16)(1,"mat-toolbar-row",17)(2,"div",18)(3,"span",19),e.EFF(4),e.nI1(5,"translate"),e.k0s()(),e.DNE(6,Ka,5,7,"div",20),e.nI1(7,"async"),e.k0s()()),2&n){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,2,"payment.paymentMethods")),e.R7$(2),e.Y8G("ngIf",!1===e.bMT(7,4,t.isDependentUser$))}}function qa(n,s){1&n&&(e.j41(0,"div",25)(1,"mat-icon",26),e.EFF(2,"info_outline"),e.k0s(),e.j41(3,"p",27),e.EFF(4),e.nI1(5,"translate"),e.k0s()()),2&n&&(e.R7$(4),e.SpI(" ",e.bMT(5,1,"payment.addPaymentOnFile"),". "))}function es(n,s){1&n&&(e.j41(0,"button",32)(1,"mat-icon",33),e.EFF(2,"clear"),e.k0s()())}function ts(n,s){1&n&&(e.j41(0,"button",23),e.qSk(),e.j41(1,"svg",34),e.nrm(2,"path",35)(3,"path",36),e.k0s()())}function ns(n,s){if(1&n){const t=e.RV6();e.j41(0,"mat-list-item",24),e.bIt("click",function(){const o=e.eBV(t).$implicit;return e.XpG(2).onClickSelectPaymentCardOnFile(o.ccToken,o.id)}),e.nrm(1,"img",29),e.nI1(2,"creditCardType"),e.j41(3,"h4",30),e.EFF(4),e.nI1(5,"last4digits"),e.k0s(),e.DNE(6,es,3,0,"button",31),e.DNE(7,ts,4,0,"button",22),e.nI1(8,"async"),e.nrm(9,"mat-divider"),e.k0s()}if(2&n){const t=s.$implicit,i=e.XpG(2);let a;e.R7$(1),e.Mz_("src","assets/images/",e.bMT(2,4,t),".png",e.B4B),e.R7$(3),e.SpI("**** ",e.bMT(5,6,t.ccMaskedNumber),""),e.R7$(2),e.Y8G("ngIf",i.toggleRemovePaymentMethod),e.R7$(1),e.Y8G("ngIf",t.ccToken===(null==(a=e.bMT(8,8,i.cardOnFile$))?null:a.ccToken)&&!i.toggleRemovePaymentMethod)}}function is(n,s){if(1&n&&(e.j41(0,"mat-list"),e.DNE(1,ns,10,10,"mat-list-item",28),e.k0s()),2&n){const t=s.ngIf;e.R7$(1),e.Y8G("ngForOf",t)}}function as(n,s){1&n&&(e.j41(0,"button",32)(1,"mat-icon",33),e.EFF(2,"clear"),e.k0s()())}function ss(n,s){1&n&&(e.j41(0,"button",23)(1,"i",37),e.EFF(2,"check_circle_outline"),e.k0s()())}function os(n,s){if(1&n){const t=e.RV6();e.j41(0,"mat-list-item",24),e.bIt("click",function(){const o=e.eBV(t).$implicit;return e.XpG(2).onClickSelectPayment(o)}),e.nrm(1,"img",29),e.nI1(2,"creditCardType"),e.j41(3,"h4",30),e.EFF(4),e.nI1(5,"last4digits"),e.k0s(),e.DNE(6,as,3,0,"button",31),e.DNE(7,ss,3,0,"button",22),e.nI1(8,"async"),e.nrm(9,"mat-divider"),e.k0s()}if(2&n){const t=s.$implicit,i=e.XpG(2);let a;e.R7$(1),e.Mz_("src","assets/images/",e.bMT(2,4,t),".png",e.B4B),e.R7$(3),e.SpI("**** ",e.bMT(5,6,t.cardNumber),""),e.R7$(2),e.Y8G("ngIf",i.toggleRemovePaymentMethod),e.R7$(1),e.Y8G("ngIf",t.cardNumber===(null==(a=e.bMT(8,8,i.creditCardInfo$))?null:a.cardNumber)&&!i.toggleRemovePaymentMethod)}}function rs(n,s){if(1&n&&(e.j41(0,"mat-list"),e.DNE(1,os,10,10,"mat-list-item",28),e.k0s()),2&n){const t=s.ngIf;e.R7$(1),e.Y8G("ngForOf",t)}}function ls(n,s){if(1&n){const t=e.RV6();e.j41(0,"mat-list")(1,"mat-list-item")(2,"mat-nav-list")(3,"button",38),e.bIt("click",function(){return e.eBV(t),e.XpG().onClickAddPaymentMethod()}),e.EFF(4),e.nI1(5,"translate"),e.k0s()()()()}2&n&&(e.R7$(4),e.SpI(" ",e.bMT(5,1,"payment.addNewPaymentMethod")," "))}let cs=(()=>{class n{constructor(t,i,a,o,r,c){this.baseConfigurationService=t,this.store=i,this.breakpointObserver=a,this.dialog=o,this.translate=r,this.data=c,this.cancelCreditCardProcess=new e.bkB,this.submitCreditCardProcess=new e.bkB,this.creditCardInfo$=this.store.pipe((0,p.Lt)(F.Mj)),this.newcreditCards$=this.store.pipe((0,p.Lt)(F.lw)),this.hostedToken$=this.store.pipe((0,p.Lt)(F.VM)),this.cardOnFile$=this.store.pipe((0,p.Lt)(F.vc)),this.cards$=this.store.pipe((0,p.Lt)(F.BV)),this.isDependentUser$=this.store.pipe((0,p.Lt)(F.vI)),this.isAlive=!0,this.toggleRemovePaymentMethod=!1,this.creditCardAmountLabel=`${this.translate.instant("payment.chargeAmount")}:`,this.breakpointObserver.observe([Mt.Rp.Handset]).subscribe(h=>{this.isMobile=h.matches})}ngOnInit(){this.creditCardAmount<0&&(this.creditCardAmountLabel=`${this.translate.instant("payment.refundAmount")}:`),this.store.dispatch(new X.IM),this.setDefaultCardOnFile(),this.store.pipe((0,p.Lt)(oe.N3)).pipe((0,ve.v)(()=>this.isAlive)).subscribe(t=>this.reservationOptions=t),this.moneyFormatter=new Intl.NumberFormat("en-US",{style:"currency",currency:this.reservationOptions?this.reservationOptions.currencyCode:"USD",minimumFractionDigits:2})}displayCreditCardAmount(t){return this.moneyFormatter.format(Math.abs(t))}setDefaultCardOnFile(){this.cards$.pipe((0,ve.v)(()=>this.isAlive)).subscribe(t=>{if(t&&t.length>0)if(1===t.length)this.store.dispatch(new X.C({cardToken:t[0].ccToken}));else{const i=t.find(a=>a.isDefault);i&&this.store.dispatch(new X.C({cardToken:i.ccToken}))}})}ngOnDestroy(){this.isAlive=!1}onClickSelectPaymentCardOnFile(t,i){this.toggleRemovePaymentMethod?this.store.dispatch(new X.aj({cardToken:t})):(this.store.dispatch(new X.C({cardToken:t})),this.store.dispatch(new X.gd({cardId:i})))}onClickSelectPayment(t){this.store.dispatch(this.toggleRemovePaymentMethod?new X.RI({card:t}):new X.FX({card:t}))}onClickChangePayment(){this.store.dispatch(new X.mV)}onClickAddPaymentMethod(){this.toggleRemovePaymentMethod=!1;const{isMobile:t}=this.baseConfigurationService.serverSettings,i=t?pe.B.MOBILE_MODAL_CONFIG:{width:pe.B.MODAL_WIDTH};this.reservationOptions.isUseHostedTokenizationPermanent?this.dialog.open(Ya.T,{maxWidth:"80vw",width:"80%",disableClose:!0}).afterClosed().subscribe(()=>{this.store.dispatch(new X.IM)}):this.reservationOptions.isUseHostedVault?this.dialog.open(Va.r,{maxWidth:"80vw",maxHeight:"80vh",height:"80%",width:"80%",disableClose:!0}).afterClosed().subscribe(()=>{this.store.dispatch(new X.IM)}):this.reservationOptions.isUseIBXTokenization?this.dialog.open(Ua.z,{maxWidth:"80vw",width:"80%",disableClose:!0}).afterClosed().subscribe(o=>{o&&this.store.dispatch(new X.IM)}):this.reservationOptions.useCCMv4?this.dialog.open(Xa.l,Object.assign(Object.assign({},this.isMobile?pe.B.MOBILE_MODAL_CONFIG:{height:"80%",width:"648px"}),{data:{isAllowTemporaryToken:!0},disableClose:!0})).afterClosed().subscribe(r=>{r&&this.store.dispatch(new X.IM)}):this.dialog.open(La.i,Object.assign(Object.assign({},i),{data:{isMobile:t}}))}onClickRemovePaymentMethodAction(){this.toggleRemovePaymentMethod=!this.toggleRemovePaymentMethod}onClickRemovePaymentMethod(t){this.store.dispatch(new X.aj({cardToken:t}))}onClickCancel(){this.cancelCreditCardProcess.emit()}onClickSubmit(){this.submitCreditCardProcess.emit()}}return n.\u0275fac=function(t){return new(t||n)(e.rXU(Pe.t),e.rXU(p.il),e.rXU(Mt.QP),e.rXU(U.bZ),e.rXU(G.c$),e.rXU(U.Vh,8))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-process-credit-card"]],inputs:{creditCardAmount:"creditCardAmount"},outputs:{cancelCreditCardProcess:"cancelCreditCardProcess",submitCreditCardProcess:"submitCreditCardProcess"},decls:40,vars:31,consts:[[1,"registerbox"],[4,"ngIf","ngIfElse"],["refundTitleTemplate",""],["fxLayout","row","fxLayoutAlign","end center"],["fxLayoutGap","5px",1,"cc-item"],[1,"cc-amount"],[1,"sub-title"],["id","checkoutstep"],["class","simpletoolbar",4,"ngIf"],["class","term-condition","fxLayout","row","fxLayoutAlign","center",4,"ngIf"],[4,"ngIf"],[1,"clearfix"],["fxLayout","row","fxLayoutGap","5px"],[1,"mainboxsection",2,"flex","1 1 auto"],["mat-raised-button","",2,"width","100%","padding","10px","font-size","16px",3,"click"],["mat-raised-button","","color","primary",2,"width","100%","padding","10px","font-size","16px",3,"disabled","click"],[1,"simpletoolbar"],[1,"flex-container"],[1,"flex-box"],[2,"color","#000"],["class","flex-box btn-trash",4,"ngIf"],[1,"flex-box","btn-trash"],["mat-icon-button","",4,"ngIf"],["mat-icon-button",""],[3,"click"],["fxLayout","row","fxLayoutAlign","center",1,"term-condition"],["fxFlex","10%","fxFlexAlign","center","mat-list-icon",""],["fxFlex","90%",2,"margin","6px 0"],[3,"click",4,"ngFor","ngForOf"],["matListAvatar","",1,"card-logo",3,"src"],["mat-line",""],["mat-icon-button","","color","accent",4,"ngIf"],["mat-icon-button","","color","accent"],["color","warn"],["xmlns","http://www.w3.org/2000/svg","height","24","viewBox","0 0 24 24","width","24",2,"width","24px","height","24px","fill","green"],["d","M0 0h24v24H0V0zm0 0h24v24H0V0z","fill","none"],["d","M16.59 7.58L10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"],[1,"material-icons","green"],["mat-stroked-button","","color","accent",3,"click"]],template:function(t,i){if(1&t&&(e.j41(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),e.DNE(3,za,6,6,"ng-container",1),e.DNE(4,Wa,5,6,"ng-template",null,2,e.C5r),e.k0s()(),e.j41(6,"mat-card-content")(7,"mat-list")(8,"mat-list-item",3)(9,"div",4)(10,"span"),e.EFF(11),e.k0s(),e.j41(12,"span",5),e.EFF(13),e.k0s()()()(),e.nrm(14,"mat-divider"),e.j41(15,"div",6),e.EFF(16),e.nI1(17,"translate"),e.k0s(),e.j41(18,"div",7),e.DNE(19,Za,8,6,"mat-toolbar",8),e.DNE(20,qa,6,3,"div",9),e.DNE(21,is,2,1,"mat-list",10),e.nI1(22,"async"),e.DNE(23,rs,2,1,"mat-list",10),e.nI1(24,"async"),e.DNE(25,ls,6,3,"mat-list",10),e.nI1(26,"async"),e.nrm(27,"div",11),e.j41(28,"div",12)(29,"div",13)(30,"button",14),e.bIt("click",function(){return i.onClickCancel()}),e.EFF(31),e.nI1(32,"translate"),e.k0s()(),e.j41(33,"div",13)(34,"button",15),e.bIt("click",function(){return i.onClickSubmit()}),e.nI1(35,"async"),e.nI1(36,"async"),e.nI1(37,"async"),e.EFF(38),e.nI1(39,"translate"),e.k0s()()()()()()),2&t){const a=e.sdS(5);e.R7$(3),e.Y8G("ngIf",i.creditCardAmount>=0)("ngIfElse",a),e.R7$(8),e.JRh(i.creditCardAmountLabel),e.R7$(2),e.JRh(i.displayCreditCardAmount(i.creditCardAmount)),e.R7$(3),e.SpI(" ",e.bMT(17,13,"payment.creditCardProcessing")," "),e.R7$(3),e.Y8G("ngIf",0!==i.creditCardAmount),e.R7$(1),e.Y8G("ngIf",0!==i.creditCardAmount),e.R7$(1),e.Y8G("ngIf",0!==i.creditCardAmount&&e.bMT(22,15,i.cards$)),e.R7$(2),e.Y8G("ngIf",0!==i.creditCardAmount&&e.bMT(24,17,i.newcreditCards$)),e.R7$(2),e.Y8G("ngIf",0!==i.creditCardAmount&&!1===e.bMT(26,19,i.isDependentUser$)),e.R7$(6),e.SpI(" ",e.bMT(32,21,"form.cancel")," "),e.R7$(3),e.Y8G("disabled",!1===e.bMT(35,23,i.creditCardInfo$)&&!1===e.bMT(36,25,i.cardOnFile$)&&!1===e.bMT(37,27,i.hostedToken$)),e.R7$(4),e.SpI(" ",e.bMT(39,29,"form.submit")," ")}},directives:[D.RN,D.MM,D.dh,E.bT,D.m2,Z.jt,Z.YE,w.DJ,w.sA,w.BO,vt.q,Ft.KQ,Ft.uu,ce.$z,_e.An,w.UI,w.R$,Z.M6,E.Sq,Z.sU,ye.vu,Z._L],pipes:[G.D9,E.Jj,Ha._,Ja.F],styles:[".registerbox[_ngcontent-%COMP%]{max-width:800px;margin:20px auto 0;padding:20px}.card-logo[_ngcontent-%COMP%]{object-fit:contain;border-radius:0%!important}mat-list[_ngcontent-%COMP%]{padding-top:0}mat-list-item[_ngcontent-%COMP%]{background:white}mat-icon[_ngcontent-%COMP%]{color:#666}.mainboxsection[_ngcontent-%COMP%]{margin:10px 0}.simpletoolbar[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 5px 20px #0000000d!important;-webkit-box-shadow:0px 5px 20px rgba(0,0,0,.05)!important;font-size:14px;color:#666;position:relative}.btn-trash[_ngcontent-%COMP%]{text-align:right}.flex-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.flex-box[_ngcontent-%COMP%]{flex:1 0 auto}.mat-expansion-panel-body[_ngcontent-%COMP%]{padding:0!important}.term-condition[_ngcontent-%COMP%]{padding:0 10px;background-color:#fff}.sub-title[_ngcontent-%COMP%]{margin:15px 5px 5px;font-size:17px;font-weight:400}@media screen and (min-width: 767px){.cc-item[_ngcontent-%COMP%]{margin:-15px!important}}.cc-amount[_ngcontent-%COMP%]{background-color:#ddd;padding:10px;overflow:auto;border-radius:5px;font-weight:700}mat-divider[_ngcontent-%COMP%]{margin-top:7px}.mat-card[_ngcontent-%COMP%]   .mat-card-header[_ngcontent-%COMP%]{padding:12px 12px 0}.mat-card[_ngcontent-%COMP%]   .mat-card-content[_ngcontent-%COMP%]{padding:2px 10px 10px!important}  .mat-list-item-content{justify-content:center!important}  .mat-nav-list{padding-bottom:8px}"]}),n})();const ps=[{path:"",component:kt,canActivate:[xt.q]},{path:"process-credit-card",component:(()=>{class n{constructor(t,i,a){this.store=t,this.dialog=i,this.translate=a,this.isPageAlive=!0,this.creditCardAmount$=this.store.pipe((0,p.Lt)(Nn)),this.modifyReservationMode$=this.store.pipe((0,p.Lt)(En)),this.modifyReservationMode=le.None}ngOnInit(){this.creditCardAmount$.pipe((0,ve.v)(()=>this.isPageAlive)).subscribe(t=>this.creditCardAmt=t),this.modifyReservationMode$.pipe((0,ve.v)(()=>this.isPageAlive)).subscribe(t=>this.modifyReservationMode=t)}ngOnDestroy(){this.isPageAlive=!1}showAttentionDialog(t){this.dialog.open(ue.z,{data:{header:this.translate.instant("dialog.attention"),details:t}})}onCancelCreditCardProcess(){this.store.dispatch(new Xt({navaigateUrl:"my-reservation"}))}onSubmitCreditCardProcess(){this.creditCardAmt&&0!==this.creditCardAmt?this.modifyReservationMode===le.Edit?this.store.dispatch(new d.wv(this.creditCardAmt)):this.modifyReservationMode===le.Cancel?this.store.dispatch(new d.bb(this.creditCardAmt)):this.showAttentionDialog(`${this.translate.instant("payment.unknownOperation")}!`):this.showAttentionDialog(`${this.translate.instant("payment.creditCardAmountInvalid")}!`)}}return n.\u0275fac=function(t){return new(t||n)(e.rXU(p.il),e.rXU(U.bZ),e.rXU(G.c$))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-process-credit-card-page"]],decls:2,vars:3,consts:[[3,"creditCardAmount","cancelCreditCardProcess","submitCreditCardProcess"]],template:function(t,i){1&t&&(e.j41(0,"app-process-credit-card",0),e.bIt("cancelCreditCardProcess",function(){return i.onCancelCreditCardProcess()})("submitCreditCardProcess",function(){return i.onSubmitCreditCardProcess()}),e.nI1(1,"async"),e.k0s()),2&t&&e.Y8G("creditCardAmount",e.bMT(1,1,i.creditCardAmount$))},directives:[cs],pipes:[E.Jj],encapsulation:2}),n})(),canActivate:[xt.q]}];let ms=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[[Be.iI.forChild(ps)],Be.iI]}),n})();var us=g(44268),gs=g(93151),Vs=g(1381);let Xs=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[[E.MD,ms,us.G,gs.YF,m.YN,m.X1,be.fS,yt.PO,p.md.forFeature("myReservation",In),_.Vm.forFeature([Gn]),Vs.T,G.h]]}),n})()}}]);