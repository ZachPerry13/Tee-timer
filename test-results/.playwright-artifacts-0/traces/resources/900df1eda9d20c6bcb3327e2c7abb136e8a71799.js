"use strict";(self.webpackChunkmaterial=self.webpackChunkmaterial||[]).push([[721],{69721:(ls,y,t)=>{t.r(y),t.d(y,{EmailModule:()=>os});var d=t(20811),E=t(72102),T=t(58344),F=t(74259),l=t(75403),a=(()=>{return(e=a||(a={})).FetchUnsubscribeInformation="[UnsubscribePage] FetchUnsubscribeInformation",e.FetchUnsubscribeInformationSuccess="[UnsubscribePage] FetchUnsubscribeInformationSuccess",e.FetchUnsubscribeInformationFailed="[UnsubscribePage] FetchUnsubscribeInformationFailed",e.Unsubscribe="[UnsubscribePage] Unsubscribe",e.UnsubscribeSuccess="[UnsubscribePage] UnsubscribeSuccess",e.UnsubscribeFailed="[UnsubscribePage] UnsubscribeFailed",e.ResetUnsubscribe="[UnsubscribePage] ResetUnsubscribe",a;var e})();class j{constructor(n){this.payload=n,this.type=a.FetchUnsubscribeInformation}}class x{constructor(n){this.payload=n,this.type=a.FetchUnsubscribeInformationSuccess}}class H{constructor(n){this.payload=n,this.type=a.FetchUnsubscribeInformationFailed}}class O{constructor(n){this.payload=n,this.type=a.Unsubscribe}}class z{constructor(n){this.payload=n,this.type=a.UnsubscribeSuccess}}class K{constructor(n){this.payload=n,this.type=a.UnsubscribeFailed}}class L{constructor(){this.type=a.ResetUnsubscribe}}const M={privacyPolicy:null,isReservationEmail:!1,isMarketingEmail:!1},D={unsubscribePage:function V(e=M,n){switch(n.type){case a.FetchUnsubscribeInformationSuccess:{const{privacyPolicy:i,isReservationEmail:r,isMarketingEmail:c}=n.payload;return Object.assign(Object.assign({},e),{privacyPolicy:i,isReservationEmail:r,isMarketingEmail:c})}case a.ResetUnsubscribe:return M;default:return e}}},N=(0,l.UX)("unsubscribe"),g=(0,l.Mz)(N,e=>e.unsubscribePage),w=(0,l.Mz)(g,e=>e.privacyPolicy),J=(0,l.Mz)(g,e=>e.isMarketingEmail),Q=(0,l.Mz)(g,e=>e.isReservationEmail);var f=t(62444),s=t(63815),W=t(18583),b=t(3126),B=t(37419),v=t(30519),X=t(29608),U=t(75764);let S=(()=>{class e{constructor(i,r){this.store=i,this.domSanitizer=r,this.isReservationEmail=!1,this.isMarketingEmail=!1,this.isComponentAlive=!0,this.store.pipe((0,l.Lt)(Q),(0,f.v)(()=>this.isComponentAlive)).subscribe(c=>{this.isReservationEmail=c}),this.store.pipe((0,l.Lt)(J),(0,f.v)(()=>this.isComponentAlive)).subscribe(c=>{this.isMarketingEmail=c}),this.store.pipe((0,l.Lt)(w),(0,f.v)(()=>this.isComponentAlive)).subscribe(c=>{this.privacyMessageSanitizedHtml=c?this.domSanitizer.bypassSecurityTrustHtml(c):""})}ngOnInit(){const i=decodeURIComponent(window.location.href);this.key=F.H.getQueryParamFromMalformedURL(i,T.u.Key);const r=F.H.decodeBase64(this.key);this.payload=JSON.parse(r),this.email=this.payload.email,this.key&&this.store.dispatch(new j({key:this.key}))}ngOnDestroy(){this.isComponentAlive=!1,this.store.dispatch(new L)}onClickUnsubscribe(){this.store.dispatch(new O({key:this.key,isReservationEmail:this.isReservationEmail,isMarketingEmail:this.isMarketingEmail}))}}return e.\u0275fac=function(i){return new(i||e)(s.rXU(l.il),s.rXU(W.up))},e.\u0275cmp=s.VBU({type:e,selectors:[["app-unsubscribe-page"]],decls:42,vars:33,consts:[[2,"padding","36px !important","max-width","800px","margin","0 auto"],[1,"text-center",2,"font-size","x-large","padding-bottom","16px"],[1,"text-center"],["href","mailto:wanasak@mycostech.com"],[2,"background-color","whitesmoke","border-radius","8px","padding","16px"],[1,"mat-checkbox",3,"ngModel","ngModelChange"],[2,"margin-left","24px"],["for","marketing-emails"],["mat-raised-button","","color","primary",3,"click"],[2,"display","flex","justify-content","center","flex-direction","column"],[3,"innerHTML"],[2,"color","red"]],template:function(i,r){1&i&&(s.j41(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1),s.EFF(3),s.nI1(4,"uppercase"),s.nI1(5,"translate"),s.k0s(),s.j41(6,"mat-card-subtitle",2),s.EFF(7),s.nI1(8,"translate"),s.j41(9,"a",3),s.EFF(10),s.k0s(),s.EFF(11),s.nI1(12,"translate"),s.k0s()(),s.j41(13,"mat-card-content")(14,"div",4)(15,"mat-checkbox",5),s.bIt("ngModelChange",function(p){return r.isReservationEmail=p}),s.j41(16,"div")(17,"p"),s.EFF(18),s.nI1(19,"translate"),s.k0s()()(),s.j41(20,"div",6),s.EFF(21),s.nI1(22,"translate"),s.k0s(),s.j41(23,"mat-checkbox",5),s.bIt("ngModelChange",function(p){return r.isMarketingEmail=p}),s.j41(24,"div"),s.nrm(25,"label",7),s.j41(26,"p"),s.EFF(27),s.nI1(28,"translate"),s.k0s()()(),s.j41(29,"div",6),s.EFF(30),s.nI1(31,"translate"),s.k0s()()(),s.j41(32,"mat-card-actions",2)(33,"button",8),s.bIt("click",function(){return r.onClickUnsubscribe()}),s.EFF(34),s.nI1(35,"translate"),s.k0s()(),s.j41(36,"mat-card-footer",2)(37,"div",9),s.nrm(38,"p",10),s.j41(39,"p",11),s.EFF(40),s.nI1(41,"translate"),s.k0s()()()()),2&i&&(s.R7$(3),s.SpI(" ",s.bMT(4,13,s.bMT(5,15,"email.emailPreferences"))," "),s.R7$(4),s.SpI(" ",s.bMT(8,17,"email.controlTypeMarketingEmail")," "),s.R7$(3),s.JRh(r.email),s.R7$(1),s.SpI(" - ",s.bMT(12,19,"email.simplyCategories"),". "),s.R7$(4),s.Y8G("ngModel",r.isReservationEmail),s.R7$(3),s.JRh(s.bMT(19,21,"email.operationalEmails")),s.R7$(3),s.SpI("",s.bMT(22,23,"email.operationalEmailsConfirmation"),"."),s.R7$(2),s.Y8G("ngModel",r.isMarketingEmail),s.R7$(4),s.SpI("",s.bMT(28,25,"email.marketingEmails")," "),s.R7$(3),s.SpI("",s.bMT(31,27,"email.marketingEmailsNewsletters"),"."),s.R7$(4),s.JRh(s.bMT(35,29,"form.confirm")),s.R7$(4),s.Y8G("innerHTML",r.privacyMessageSanitizedHtml,s.npT),s.R7$(2),s.SpI("",s.bMT(41,31,"email.onceUnsubscribed"),"."))},directives:[b.RN,b.MM,b.dh,b.Lc,b.m2,B.So,v.BC,v.vS,b.YY,X.$z,b.WQ],pipes:[d.Pc,U.D9],styles:[""]}),e})();const Z=[{path:"Unsubscribe",component:S}];let q=(()=>{class e{}return e.components=[S],e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=s.$C({type:e}),e.\u0275inj=s.G2t({providers:[d.vh],imports:[[E.iI.forChild(Z)],E.iI]}),e})();var o=t(65185),h=t(52870),I=t(64431),R=t(58794),C=t(83769),_=t(83841),P=t(23164),ss=t(91348),$=t(60509),k=t(46396),es=t(92348),ts=t(43754);let is=(()=>{class e{constructor(i,r){this.httpClient=i,this.baseConfigService=r,this.baseUrl=es.c.emailApi,this.baseConfigService.isReady?this.baseUrl=this.baseConfigService.serverSettings.emailApi:this.baseConfigService.settingsLoaded$.subscribe(c=>this.baseUrl=this.baseConfigService.serverSettings.emailApi)}unsubscribe(i){return this.httpClient.post(`${this.baseUrl}/unsubscription`,i).pipe((0,h.T)(r=>r))}getPrivacyPolicy(i){let r=(new k.Nl).set("key",i);return this.httpClient.get(`${this.baseUrl}/unsubscription/privacypolicy`,{params:r}).pipe((0,h.T)(c=>c))}}return e.\u0275fac=function(i){return new(i||e)(s.KVO(k.Qq),s.KVO(ts.t))},e.\u0275prov=s.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const ns=[a.FetchUnsubscribeInformation,a.Unsubscribe],as=[a.UnsubscribeSuccess,a.UnsubscribeFailed,a.FetchUnsubscribeInformationSuccess,a.FetchUnsubscribeInformationFailed];let rs=(()=>{class e{constructor(i,r,c,p){this.actions$=i,this.store=r,this.unsubscribeService=c,this.translate=p,this.showSpinner=(0,o.EH)(()=>this.actions$.pipe((0,o.gp)(...ns),(0,h.T)(()=>new P.f9))),this.hideSpinner=(0,o.EH)(()=>this.actions$.pipe((0,o.gp)(...as),(0,h.T)(()=>new P.wg))),this.fetchUnsubscribeInformation$=(0,o.EH)(()=>this.actions$.pipe((0,o.gp)(a.FetchUnsubscribeInformation),(0,h.T)(u=>u.payload),(0,I.Z)(u=>this.unsubscribeService.getPrivacyPolicy(u.key).pipe((0,R.n)(m=>[new x(m)]),(0,C.W)(m=>(0,$.of)(new H(m))))))),this.unsubscribe$=(0,o.EH)(()=>this.actions$.pipe((0,o.gp)(a.Unsubscribe),(0,h.T)(u=>u.payload),(0,I.Z)(u=>this.unsubscribeService.unsubscribe(u).pipe((0,R.n)(m=>[new z(m)]),(0,C.W)(m=>(0,$.of)(new K(m))))))),this.unsubscribeSuccess$=(0,o.EH)(()=>this.actions$.pipe((0,o.gp)(a.UnsubscribeSuccess),(0,_.M)(()=>{this.store.dispatch(new ss.w9({details:this.translate.instant("email.preferencesUpdated")}))})),{dispatch:!1})}}return e.\u0275fac=function(i){return new(i||e)(s.KVO(o.En),s.KVO(l.il),s.KVO(is),s.KVO(U.c$))},e.\u0275prov=s.jDH({token:e,factory:e.\u0275fac}),e})();var cs=t(44268);let os=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=s.$C({type:e}),e.\u0275inj=s.G2t({imports:[[cs.G,d.MD,q,v.YN,l.md.forFeature("unsubscribe",D),o.Vm.forFeature([rs]),U.h]]}),e})()}}]);